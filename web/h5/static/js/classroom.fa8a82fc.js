(window.webpackJsonp=window.webpackJsonp||[]).push([["classroom"],{4127:function(e,t,i){"use strict";var s=i("d233"),r=i("b313"),a=Object.prototype.hasOwnProperty,n={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},o=Array.isArray,c=Array.prototype.push,l=function(e,t){c.apply(e,o(t)?t:[t])},u=Date.prototype.toISOString,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:s.encode,encodeValuesOnly:!1,formatter:r.formatters[r.default],indices:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},p=function e(t,i,r,a,n,c,u,p,f,h,m,v,y){var g=t;if("function"==typeof u?g=u(i,g):g instanceof Date?g=h(g):"comma"===r&&o(g)&&(g=g.join(",")),null===g){if(a)return c&&!v?c(i,d.encoder,y):i;g=""}if("string"==typeof g||"number"==typeof g||"boolean"==typeof g||s.isBuffer(g))return c?[m(v?i:c(i,d.encoder,y))+"="+m(c(g,d.encoder,y))]:[m(i)+"="+m(String(g))];var b,_=[];if(void 0===g)return _;if(o(u))b=u;else{var w=Object.keys(g);b=p?w.sort(p):w}for(var C=0;C<b.length;++C){var k=b[C];n&&null===g[k]||(o(g)?l(_,e(g[k],"function"==typeof r?r(i,k):i,r,a,n,c,u,p,f,h,m,v,y)):l(_,e(g[k],i+(f?"."+k:"["+k+"]"),r,a,n,c,u,p,f,h,m,v,y)))}return _};e.exports=function(e,t){var i,s=e,c=function(e){if(!e)return d;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=r.default;if(void 0!==e.format){if(!a.call(r.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var s=r.formatters[i],n=d.filter;return("function"==typeof e.filter||o(e.filter))&&(n=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:void 0===e.allowDots?d.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,delimiter:void 0===e.delimiter?d.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:d.encode,encoder:"function"==typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:n,formatter:s,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}}(t);"function"==typeof c.filter?s=(0,c.filter)("",s):o(c.filter)&&(i=c.filter);var u,f=[];if("object"!=typeof s||null===s)return"";u=t&&t.arrayFormat in n?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var h=n[u];i||(i=Object.keys(s)),c.sort&&i.sort(c.sort);for(var m=0;m<i.length;++m){var v=i[m];c.skipNulls&&null===s[v]||l(f,p(s[v],v,h,c.strictNullHandling,c.skipNulls,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.formatter,c.encodeValuesOnly,c.charset))}var y=f.join(c.delimiter),g=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?g+="utf8=%26%2310003%3B&":g+="utf8=%E2%9C%93&"),y.length>0?g+y:""}},4328:function(e,t,i){"use strict";var s=i("4127"),r=i("9e6a"),a=i("b313");e.exports={formats:a,parse:r,stringify:s}},"504c":function(e,t,i){var s=i("9e1e"),r=i("0d58"),a=i("6821"),n=i("52a7").f;e.exports=function(e){return function(t){for(var i,o=a(t),c=r(o),l=c.length,u=0,d=[];l>u;)i=c[u++],s&&!n.call(o,i)||d.push(e?[i,o[i]]:o[i]);return d}}},8615:function(e,t,i){var s=i("5ca1"),r=i("504c")(!1);s(s.S,"Object",{values:function(e){return r(e)}})},8807:function(e,t,i){"use strict";i("a481"),i("ac6a"),i("456d"),i("7f7f"),i("c5f6");var s=i("db72"),r=i("2f62"),a={props:{type:{type:String,default:"price"},course:{type:Object,default:{}},order:{type:Object,default:{}}},data:function(){return{isFree:0==this.course.price}},computed:Object(s.a)({},Object(r.d)(["courseSettings"]),{rate:function(){return parseInt(this.course.publishedTaskNum)?parseInt(this.course.progress.percent):0},showStudent:function(){return!this.courseSettings||Number(this.courseSettings.show_student_num_enabled)}}),filters:{numFilter:function(e){return e?parseFloat(e).toFixed(2):""}},methods:{goToPay:function(){this.$router.push({path:"/pay",query:{id:this.order.id,source:"order",sn:this.order.sn,targetId:this.order.targetId,targetType:this.order.targetType}})}}},n=i("0c7c"),o={components:{switchBox:Object(n.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"e-course-switch-box"},["price"===e.type?i("div",{staticClass:"switch-box"},[i("span",{staticClass:"switch-box__price"},[e.isFree?i("p",{staticClass:"free"},[e._v("免费")]):e._e(),e.isFree?e._e():i("p",{staticClass:"price"},[e._v("¥ "+e._s(e.course.price))])]),i("span",{staticClass:"switch-box__state"},[e.showStudent?i("p",[e._v(e._s(e.course.studentNum)+"人在学")]):e._e()])]):e._e(),"order"===e.type?i("div",{staticClass:"switch-box"},[i("span",{staticClass:"switch-box__price"},[e.isFree?i("p",{staticClass:"free"},[e._v("免费")]):e._e(),e.isFree?e._e():i("p",{staticClass:"price"},[e._v("¥ "+e._s(e.order.pay_amount/100))])]),i("span",{staticClass:"switch-box__state"},["created"!==e.order.status&&"paying"!==e.order.status?i("p",{class:e.order.status},[e._v("\n        "+e._s(e._f("filterOrderStatus")(e.order.status))+"\n      ")]):e._e(),"created"===e.order.status||"paying"===e.order.status?i("span",{staticClass:"order-pay",on:{click:e.goToPay}},[e._v(e._s(e._f("filterOrderStatus")(e.order.status)))]):e._e()])]):e._e(),"confirmOrder"===e.type?i("div",{staticClass:"switch-box"},[i("span",{staticClass:"switch-box__price"},[i("p",{staticClass:"price"},[e._v("¥ "+e._s(e._f("numFilter")(e.order.totalPrice)))])])]):e._e(),"rank"===e.type?i("div",{staticClass:"rank-box"},[i("div",{staticClass:"progress round-conner"},[i("div",{staticClass:"curRate round-conner",style:{width:e.rate+"%"}})]),i("span",[e._v(e._s(this.rate)+"%")])]):e._e()])}),[],!1,null,null,null).exports},props:{course:{type:Object,default:function(){return{}}},order:{type:Object,default:function(){return{}}},type:{type:String,default:"price"},feedback:{type:Boolean,default:!0},typeList:{type:String,default:"course_list"},duration:{type:Number,default:0}},data:function(){return{pathName:this.$route.name}},computed:{imgSrc:function(){if("classroom_list"===this.typeList)return this.course.cover.middle;var e=this.course.courseSet,t=e?e.cover.middle:this.order.cover.middle;return t||""},title:function(){return"classroom_list"===this.typeList?this.course.title:this.course.courseSetTitle||(this.course.courseSet?this.course.courseSet.title:"")||this.order.title},teachPlan:function(){return!!this.course.title&&this.course.title},imgClass:function(){return"vip"===this.typeList?"e-vip__img":"e-course__img"},vipDuration:function(){return"month"===this.order.unitType?"".concat(this.duration,"个月"):"year"===this.order.unitType?"".concat(this.duration,"年"):"".concat(this.duration,"天")}},watch:{course:{handler:function(e){var t=e.courseSet;if("miniprogramSetting"===this.pathName&&t)for(var i=Object.keys(t.cover),s=0;s<i.length;s++)t.cover[i[s]]=t.cover[i[s]].replace(/^(\/\/)|(http:\/\/)/,"https://")},immediate:!0}},methods:{onClick:function(e){if(this.feedback&&"vip"!==this.typeList){var t="order"===this.type,i=this.course.id||this.order.targetId;"SPAN"!==e.target.tagName&&(t?location.href=this.order.targetUrl:"course"!==this.typeList&&("classroom_list"===this.typeList&&this.$router.push({path:"/classroom/".concat(i)}),"course_list"===this.typeList&&this.$router.push({path:"/course/".concat(i)})))}}}},c=Object(n.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"e-course"},[i("div",{staticClass:"clearfix",on:{click:e.onClick}},[i("div",{staticClass:"e-course__left pull-left"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imgSrc,expression:"imgSrc"}],class:e.imgClass})]),i("div",{staticClass:"e-course__right pull-left"},["confirmOrder"===e.type?i("div",{staticClass:"e-course__title course-confirm-title"},[e._v("\n        "+e._s(e.title)),"vip"===e.typeList?i("span",{staticClass:"grey-medium"},[e._v(" x "+e._s(e.vipDuration))]):e._e()]):i("div",[i("div",{staticClass:"e-course__title text-overflow"},[e._v(e._s(e.title))]),"classroom_list"===e.typeList?i("div",{staticClass:"e-course__count"},[e._v("\n          共 "+e._s(e.course.courseNum)+" 门课程\n        ")]):e._e(),"course_list"===e.typeList?i("div",{staticClass:"e-course__project text-overflow"},[e.teachPlan?i("span",[e._v(e._s(e.teachPlan))]):e._e()]):e._e()]),i("switchBox",{attrs:{type:e.type,course:e.course,order:e.order,"student-num":e.course.studentNum,"published-task-num":e.course.publishedTaskNum}})],1)])])}),[],!1,null,null,null);t.a=c.exports},"8ab6":function(e,t,i){"use strict";i.r(t),i("ac6a"),i("456d"),i("e7e5");var s=i("d399"),r=i("db72"),a=(i("e17f"),i("2241")),n={name:"Teacher",props:["teacherInfo","title","defaulValue"]},o=i("0c7c"),c=Object(o.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("e-panel",{attrs:{title:e.title,"defaul-value":e.defaulValue}},[e._l(e.teacherInfo,(function(t){return e.teacherInfo.length?[i("div",{staticClass:"teacher-content"},[i("img",{staticClass:"avatar-img",attrs:{src:t.avatar&&t.avatar.large}}),i("div",{staticClass:"teacher-cell"},[i("span",{staticClass:"dark font-family-PFM"},[e._v(e._s(t.nickname))]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.title,expression:"item.title"}],staticClass:"text-content"},[e._v(e._s(t.title))])])])]:e._e()}))],2)}),[],!1,null,null,null).exports,l=i("fd23"),u=i("bced"),d=i("3ce7"),p=i("4328"),f=i.n(p),h=i("2f62"),m={components:{countDown:l.a,tagLink:u.a},props:{cover:{type:String,default:""},price:{type:String,default:""},classroomId:{type:String,default:0},seckillActivities:{type:Object,default:null}},data:function(){return{counting:!0,isEmpty:!1,tagData:{earnings:0,isShow:!1,link:"",className:"course-tag",minDirectRewardRatio:0},bindAgencyRelation:{}}},computed:Object(r.a)({},Object(h.d)(["DrpSwitch"])),created:function(){this.showTagLink()},methods:{expire:function(){this.counting=!1},sellOut:function(){this.isEmpty=!0,this.$emit("goodsEmpty")},showTagLink:function(){this.DrpSwitch?(this.initTagData(),this.getAgencyBindRelation()):this.tagData.isShow=!1},getAgencyBindRelation:function(){var e=this;d.a.getAgencyBindRelation().then((function(t){t.agencyId?(e.bindAgencyRelation=t,e.tagData.isShow=!0):e.tagData.isShow=!1}))},initTagData:function(){var e=this;d.a.getDrpSetting().then((function(t){e.drpSetting=t,e.tagData.minDirectRewardRatio=t.minDirectRewardRatio;var i={type:"classroom",id:e.classroomId,merchant_id:e.drpSetting.merchantId};e.tagData.link=e.drpSetting.distributor_template_url+"?"+f.a.stringify(i);var s=e.drpSetting.minDirectRewardRatio/100*e.price;e.tagData.earnings=(Math.floor(100*s)/100).toFixed(2)}))}}},v=Object(o.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"course-detail__head pos-rl"},[i("div",{staticClass:"course-detail__head--img"},[i("img",{attrs:{src:e.cover,alt:""}})]),e.seckillActivities&&e.counting&&!e.isEmpty&&"ongoing"===e.seckillActivities.status?i("countDown",{attrs:{activity:e.seckillActivities},on:{timesUp:e.expire,sellOut:e.sellOut}}):e._e(),i("tagLink",{attrs:{"tag-data":e.tagData}})],1)}),[],!1,null,null,null).exports,y=i("d0b2"),g=i("8807"),b=i("86ee"),_={name:"CourseSetList",components:{course:g.a,moreMask:b.a},props:{courseSets:{default:null},title:{default:""},defaulValue:{default:""},disableMask:{type:Boolean,default:!1},feedback:{type:Boolean,default:!0}},data:function(){return{maxShowNum:5}},computed:{partCourseSets:function(){return this.courseSets.slice(0,5)}},methods:{loadMore:function(){this.$emit("update:disableMask",!0)}}},w=Object(o.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("e-panel",{attrs:{title:e.title,"need-flex":!1,"defaul-value":e.defaulValue}},[e.courseSets.length?[!e.disableMask&&e.courseSets.length>5?i("moreMask",{attrs:{"force-show":!0},on:{maskLoadMore:e.loadMore}},[e._l(e.partCourseSets,(function(t){return[i("course",{staticStyle:{"padding-left":"0","padding-right":"0"},attrs:{feedback:e.feedback,course:t}})]}))],2):[e._l(e.courseSets,(function(t){return[i("course",{staticStyle:{"padding-left":"0","padding-right":"0"},attrs:{feedback:e.feedback,course:t}})]}))]]:e._e()],2)}),[],!1,null,null,null).exports,C=(i("c5f6"),i("410d")),k=i("0d25"),S={components:{service:C.a},filters:{filterPrice:function(e){return 0===Number(e)?"免费":"¥".concat(e)}},props:{details:{default:{}},joinStatus:{default:!1}},watch:{learnExpiryHtml:{immediate:!0,handler:function(e){this.$emit("getLearnExpiry",{val:e})}}},computed:Object(r.a)({},Object(h.d)(["vipSwitch"]),{learnExpiryHtml:function(){var e=this.joinStatus,t=this.details.expiryValue,i=this.details.expiryMode;if(e)return"forever"==i?"永久有效":0!=e.deadline?e.deadline.slice(0,10)+"之前可学习":"永久有效";switch(i){case"forever":return"永久有效";case"date":var s=new Date(1e3*t);return Object(k.formatFullTime)(s).slice(0,10)+"之前可学习";case"days":return t+"天内可学习"}}})},x=Object(o.a)(S,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"classroom-plan"},[i("e-panel",{attrs:{title:e.details.title}},[i("div",{staticClass:"course-detail__plan-price"},[i("span",{class:{isFree:0===Number(e.details.price)}},[e._v(e._s(e._f("filterPrice")(e.details.price)))]),i("span",{staticClass:"plan-price__student-num"},[e._v(e._s(e.details.studentNum)+"人在学")])])]),i("div",{staticClass:"course-detail__validity"},[e.details.vipLevel&&e.vipSwitch?i("div",{staticClass:"mb15"},[i("span",{staticClass:"mr20"},[e._v("会员免费")]),i("img",{staticClass:"vipIcon",attrs:{src:e.details.vipLevel.icon}}),i("router-link",{staticClass:"color-primary",attrs:{to:{path:"/vip",query:{id:e.details.vipLevel.id}}}},[e._v(e._s(e.details.vipLevel.name)+"免费学")])],1):e._e(),e.details.service.length?i("service",{attrs:{services:e.details.service}}):e._e(),i("div",[i("span",[e._v("学习有效期：")]),i("span",{domProps:{innerHTML:e._s(e.learnExpiryHtml)}})])],1)],1)}),[],!1,null,null,null).exports,j=i("b127"),O={components:{directory:j.a,detailHead:v,detailPlan:x,teacher:c,courseSetList:w,reviewList:y.a,moreMask:b.a},props:["details","planDetails"],data:function(){return{headBottom:0,active:1,scrollFlag:!1,tabs:["班级介绍","班级课程","学员评价"],tabsClass:"",errorMsg:""}},mounted:function(){window.addEventListener("touchmove",this.handleScroll),this.showDialog()},destroyed:function(){window.removeEventListener("touchmove",this.handleScroll)},methods:{showDialog:function(){var e=this,t="",i="",r=function(){};if(this.details.member&&(this.details.member.access&&(t=this.details.member.access.code),t&&"success"!==t))if(this.errorMsg=this.getErrorMsg(t),"classroom.expired"===t||"member.expired"===t){i="班级已到期，无法继续学习，是否退出";var a={id:this.details.classId};r=function(){d.a.deleteClassroom({query:a}).then((function(e){e.success?window.location.reload():s.a.fail("退出班级失败，请稍后重试")}))},this.callConfirm(i,r)}else"vip.member_expired"===t?(i="会员已到期，请及时续费会员",r=function(){e.$router.push({path:"/vip"})},this.callConfirm(i,r)):s.a.fail(this.getErrorMsg(t))},handleScroll:function(){var e=this;if(!this.scrollFlag){this.scrollFlag=!0;var t=this.$refs;setTimeout((function(){e.headBottom=t.head.$el.getBoundingClientRect().bottom,e.scrollFlag=!1,e.tabsClass=e.headBottom<=0?"van-tabs--fixed":""}),400)}},getErrorMsg:function(e){switch(e){case"classroom.not_found":return"当前班级不存在";case"classroom.unpublished":return"当前班级未发布";case"classroom.expired":return"当前班级已过期";case"user.not_login":return"用户未登录";case"user.locked":return"用户被锁定";case"member.not_found":return"用户未加入班级";case"member.auditor":return"用户是旁听生";case"member.expired":return"班级已过期";case"vip.vip_closed":return"网校已关闭会员功能";case"vip.not_login":return"用户未登录";case"vip.not_member":return"当前用户并不是vip";case"vip.member_expired":return"用户会员服务已过期";case"vip.level_not_exist":return"用户会员等级或班级会员不存在";case"vip.level_low":return"用户会员等级过低";default:return"异常错误"}},callConfirm:function(e,t){a.a.confirm({message:e,title:""}).then((function(){t()})).catch((function(){}))}}},T=Object(o.a)(O,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"course-detail classroom-detail"},[i("div",{staticClass:"join-after"},[i("detail-head",{ref:"head",attrs:{cover:e.details.cover,price:e.planDetails.price,"classroom-id":e.details.classId}}),i("van-tabs",{class:e.tabsClass,model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,(function(e){return i("van-tab",{key:e,attrs:{title:e}})})),1),0==e.active?i("div",{staticStyle:{"margin-top":"44px"}},[i("detail-plan",{attrs:{details:e.planDetails,"join-status":e.details.joinStatus}}),i("div",{staticClass:"segmentation"}),i("e-panel",{ref:"about",staticClass:"about",attrs:{title:"班级介绍"}},[i("div",{domProps:{innerHTML:e._s(e.details.summary)}})]),i("div",{staticClass:"segmentation"}),i("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.teachers,title:"教师介绍"}}),i("div",{staticClass:"segmentation"}),i("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.headTeacher?[e.details.headTeacher]:[],title:"班主任","defaul-value":"尚未设置班主任"}})],1):e._e(),1==e.active?i("div",{staticStyle:{"margin-top":"44px"}},[i("course-set-list",{ref:"course",attrs:{feedback:!e.errorMsg,"course-sets":e.details.courses,"disable-mask":!0,title:"班级课程","defaul-value":"暂无课程"},nativeOn:{click:function(t){return e.showDialog(t)}}})],1):e._e(),2==e.active?i("div",{staticStyle:{"margin-top":"44px"}},[i("review-list",{ref:"review",attrs:{"target-id":e.details.classId,reviews:e.details.reviews,title:"学员评价","defaul-value":"暂无评价",type:"classroom"}})],1):e._e()],1)])}),[],!1,null,null,null).exports,D=i("49a2"),L=i("d863"),E=i("8b9d"),N=i("a262"),A={components:{directory:j.a,detailHead:v,detailPlan:x,teacher:c,courseSetList:w,reviewList:y.a,moreMask:b.a,onsale:D.a},mixins:[L.a,E.a,N.a],props:["details","planDetails"],data:function(){return{tops:{aboutTop:0,courseTop:0,reviewTop:0},active:0,scrollFlag:!1,tabs:["班级介绍","班级课程","学员评价"],tabsClass:"",loadMoreAbout:!1,disableMask:!1,learnExpiry:"永久有效",unreceivedCoupons:[],miniCoupons:[],marketingActivities:{seckill:{}},isEmpty:!0,scrollTime:null,isManualSwitch:!1}},computed:Object(r.a)({},Object(h.d)(["couponSwitch","user"]),{accessToJoin:function(){return"success"===this.details.access.code||"user.not_login"===this.details.access.code},vipAccessToJoin:function(){var e=!1;return!(!this.details.vipLevel||!this.user.vip)&&(this.details.vipLevel.seq<=this.user.vip.seq&&(e=!(new Date(this.user.vip.deadline).getTime()<(new Date).getTime())),e)},showOnsale:function(){return 0!==Number(this.planDetails.price)&&!!(this.unreceivedCoupons.length||Object.keys(this.marketingActivities).length&&!this.onlySeckill)},onlySeckill:function(){return 1===Object.keys(this.marketingActivities).length&&this.marketingActivities.seckill},seckillStatus:function(){var e=this.marketingActivities.seckill;return Object(k.dateTimeDown)(new Date(e.endTime).getTime())},showSeckill:function(){var e=this.marketingActivities.seckill;return 0!==Number(this.planDetails.price)&&e&&"ongoing"===e.status&&!this.isEmpty}}),mounted:function(){var e=this;this.couponSwitch&&d.a.searchCoupon({params:{targetId:this.details.classId,targetType:"classroom"}}).then((function(t){e.unreceivedCoupons=t.data,e.miniCoupons=e.unreceivedCoupons.length>3?e.unreceivedCoupons.slice(0,4):e.unreceivedCoupons})).catch((function(e){})),d.a.classroomsActivities({query:{id:this.details.classId}}).then((function(t){e.marketingActivities=t,e.isEmpty=!t.seckill||!+t.seckill.productRemaind})).catch((function(e){})),window.addEventListener("touchmove",this.handleScroll),window.addEventListener("scroll",this.handleScroll),setTimeout((function(){window.scrollTo(0,0)}),100)},destroyed:function(){window.removeEventListener("touchmove",this.handleScroll),window.removeEventListener("scroll",this.handleScroll)},methods:{onTabClick:function(e,t){var i=this;this.isManualSwitch=!0;var s=this.$refs[this.transIndex2Tab(e)];window.scrollTo(0,s.$el.offsetTop-44),setTimeout((function(){return i.isManualSwitch=!1}),500)},transIndex2Tab:function(e){return["about","course","review"][e]},handleScroll:function(){var e=this;if(!this.scrollFlag){this.scrollFlag=!0;var t=this.$refs,i=["about","course","review"].reverse();this.scrollTime&&clearTimeout(this.scrollTime),this.scrollTime=setTimeout((function(){Object.keys(t).forEach((function(i){e.tops["".concat(i,"Top")]=t[i].$el.getBoundingClientRect().top})),e.scrollFlag=!1,e.tabsClass=e.tops.aboutTop-44<=0?"van-tabs--fixed":"",e.setCurrentActive(i)}),400)}},setCurrentActive:function(e){if(!this.isManualSwitch){for(var t=0;t<e.length;t++)if(!(this.tops["".concat(e[t],"Top")]-44>0))return void(this.active=e.length-t-1);this.active=0}},handleJoin:function(){var e=this,t=this.vipAccessToJoin;if(this.accessToJoin||t){var i=this.details,s=this.planDetails,r=1===Number(i.buyable)||0==+s.price||t;this.$store.state.token?r&&(!+s.price||t?d.a.joinClass({query:{classroomId:i.classId}}).then((function(t){e.details.joinStatus=t})).catch((function(e){})):this.$router.push({name:"order",params:{id:i.classId},query:{expiryScope:this.learnExpiry,targetType:"classroom"}})):this.$router.push({name:"login",query:{redirect:this.redirect}})}},getLearnExpiry:function(e){var t=e.val;this.learnExpiry=t},sellOut:function(){this.isEmpty=!0}}},M=Object(o.a)(A,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"course-detail classroom-detail"},[i("div",{staticClass:"join-before"},[i("detail-head",{attrs:{cover:e.details.cover,price:e.planDetails.price,"classroom-id":e.details.classId,"seckill-activities":e.marketingActivities.seckill},on:{goodsEmpty:e.sellOut}}),i("detail-plan",{attrs:{details:e.planDetails,"join-status":e.details.joinStatus},on:{getLearnExpiry:e.getLearnExpiry}}),i("div",{staticClass:"segmentation"}),e.showOnsale?[i("onsale",{attrs:{"unreceived-coupons":e.unreceivedCoupons,"mini-coupons":e.miniCoupons,activities:e.marketingActivities}}),i("div",{staticClass:"segmentation"})]:e._e(),i("van-tabs",{class:e.tabsClass,on:{click:e.onTabClick},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,(function(e){return i("van-tab",{key:e,attrs:{title:e}})})),1),i("e-panel",{ref:"about",staticClass:"about",attrs:{title:"班级介绍"}},[i("more-mask",{attrs:{disabled:e.loadMoreAbout},on:{maskLoadMore:function(t){e.loadMoreAbout=!0}}},[i("div",{domProps:{innerHTML:e._s(e.details.summary)}})])],1),i("div",{staticClass:"segmentation"}),i("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.teachers,title:"教师介绍"}}),i("div",{staticClass:"segmentation"}),i("teacher",{staticClass:"teacher",attrs:{"teacher-info":e.details.headTeacher?[e.details.headTeacher]:[],title:"班主任","defaul-value":"尚未设置班主任"}}),i("div",{staticClass:"segmentation"}),i("course-set-list",{ref:"course",attrs:{"course-sets":e.details.courses,"disable-mask":e.disableMask,title:"班级课程","defaul-value":"暂无课程"},on:{"update:disableMask":function(t){e.disableMask=t},"update:disable-mask":function(t){e.disableMask=t}}}),i("div",{staticClass:"segmentation"}),i("review-list",{ref:"review",attrs:{"target-id":e.details.classId,reviews:e.details.reviews,title:"学员评价",type:"classroom","defaul-value":"暂无评价"}}),!e.marketingActivities.seckill||e.marketingActivities.seckill&&(e.isEmpty||"已到期"===e.seckillStatus)||0==e.planDetails.price?i("e-footer",{attrs:{disabled:!e.accessToJoin},nativeOn:{click:function(t){return e.handleJoin(t)}}},[e._v("\n      "+e._s(e._f("filterJoinStatus")(e.details.access.code,"classroom",e.vipAccessToJoin)))]):e._e(),e.showSeckill&&"已到期"!==e.seckillStatus?i("div",[i("e-footer",{attrs:{disabled:!e.accessToJoin,half:"true"},nativeOn:{click:function(t){return e.handleJoin(t)}}},[e._v(e._s(e._f("filterJoinStatus")(e.details.access.code,"classroom",e.vipAccessToJoin)))]),i("e-footer",{attrs:{half:"true"},nativeOn:{click:function(t){return e.activityHandle(e.marketingActivities.seckill.id)}}},[e._v("去秒杀")])],1):e._e()],2)])}),[],!1,null,null,null).exports,P={components:{},data:function(){return{details:{isEmpty:!0,summary:"",joinStatus:!1,courses:[],teachers:[],assistants:[],headTeacher:{},access:{code:"加载中"},cover:"",reviews:[],classId:0,vipLevel:null},planDetails:{title:"",service:[],price:"0",studentNum:0,expiryMode:"forever",expiryValue:"0",vipLevel:null},currentComp:""}},computed:Object(r.a)({},Object(h.d)({isLoading:function(e){return e.isLoading}})),watch:{"details.joinStatus":{handler:function(e){this.getComponent(e)}}},created:function(){var e=this,t=this.$route.params.id;d.a.getClassroomDetail({query:{classroomId:t}}).then((function(t){e.getComponent(t.member),e.getDetails(t)})).catch((function(e){s.a.fail(e.message)}))},methods:{getDetails:function(e){var t=0===Object.keys(e).length,i=e.about,s=!t&&e.member,r=e.courses,a=e.teachers,n=e.assistants,o=e.buyable,c=e.vipLevel,l=e.headTeacher,u=e.access,d=e.reviews,p=e.expiryMode,f=e.member,h=e.expiryValue,m=e.title,v=e.price,y=e.studentNum,g=e.service,b=e.cover.large,_=e.id,w={title:m,service:g,price:v,studentNum:y,expiryMode:p,expiryValue:h,vipLevel:c};this.planDetails=w,this.details={summary:i,joinStatus:s,isEmpty:t,courses:r,classId:_,buyable:o,vipLevel:c,teachers:a,assistants:n,headTeacher:l,access:u,cover:b,reviews:d,member:f}},getComponent:function(e){this.currentComp=e?T:M}}},I=Object(o.a)(P,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"course-detail"},[this.isLoading?t("e-loading"):this._e(),t(this.currentComp,{tag:"component",attrs:{details:this.details,"plan-details":this.planDetails}})],1)}),[],!1,null,null,null);t.default=I.exports},"9e6a":function(e,t,i){"use strict";var s=i("d233"),r=Object.prototype.hasOwnProperty,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:s.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},n=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},o=function(e,t,i){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,n=/(\[[^[\]]*])/.exec(s),o=n?s.slice(0,n.index):s,c=[];if(o){if(!i.plainObjects&&r.call(Object.prototype,o)&&!i.allowPrototypes)return;c.push(o)}for(var l=0;null!==(n=a.exec(s))&&l<i.depth;){if(l+=1,!i.plainObjects&&r.call(Object.prototype,n[1].slice(1,-1))&&!i.allowPrototypes)return;c.push(n[1])}return n&&c.push("["+s.slice(n.index)+"]"),function(e,t,i){for(var s=t,r=e.length-1;r>=0;--r){var a,n=e[r];if("[]"===n&&i.parseArrays)a=[].concat(s);else{a=i.plainObjects?Object.create(null):{};var o="["===n.charAt(0)&&"]"===n.charAt(n.length-1)?n.slice(1,-1):n,c=parseInt(o,10);i.parseArrays||""!==o?!isNaN(c)&&n!==o&&String(c)===o&&c>=0&&i.parseArrays&&c<=i.arrayLimit?(a=[])[c]=s:a[o]=s:a={0:s}}s=a}return s}(c,t,i)}};e.exports=function(e,t){var i=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset;return{allowDots:void 0===e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||s.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth?e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null==e)return i.plainObjects?Object.create(null):{};for(var c="string"==typeof e?function(e,t){var i,o={},c=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,l=t.parameterLimit===1/0?void 0:t.parameterLimit,u=c.split(t.delimiter,l),d=-1,p=t.charset;if(t.charsetSentinel)for(i=0;i<u.length;++i)0===u[i].indexOf("utf8=")&&("utf8=%E2%9C%93"===u[i]?p="utf-8":"utf8=%26%2310003%3B"===u[i]&&(p="iso-8859-1"),d=i,i=u.length);for(i=0;i<u.length;++i)if(i!==d){var f,h,m=u[i],v=m.indexOf("]="),y=-1===v?m.indexOf("="):v+1;-1===y?(f=t.decoder(m,a.decoder,p),h=t.strictNullHandling?null:""):(f=t.decoder(m.slice(0,y),a.decoder,p),h=t.decoder(m.slice(y+1),a.decoder,p)),h&&t.interpretNumericEntities&&"iso-8859-1"===p&&(h=n(h)),h&&t.comma&&h.indexOf(",")>-1&&(h=h.split(",")),r.call(o,f)?o[f]=s.combine(o[f],h):o[f]=h}return o}(e,i):e,l=i.plainObjects?Object.create(null):{},u=Object.keys(c),d=0;d<u.length;++d){var p=u[d],f=o(p,c[p],i);l=s.merge(l,f,i)}return s.compact(l)}},b313:function(e,t,i){"use strict";var s=String.prototype.replace,r=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return s.call(e,r,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},d233:function(e,t,i){"use strict";var s=Object.prototype.hasOwnProperty,r=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),n=function(e,t){for(var i=t&&t.plainObjects?Object.create(null):{},s=0;s<e.length;++s)void 0!==e[s]&&(i[s]=e[s]);return i};e.exports={arrayToObject:n,assign:function(e,t){return Object.keys(t).reduce((function(e,i){return e[i]=t[i],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],s=0;s<t.length;++s)for(var a=t[s],n=a.obj[a.prop],o=Object.keys(n),c=0;c<o.length;++c){var l=o[c],u=n[l];"object"==typeof u&&null!==u&&-1===i.indexOf(u)&&(t.push({obj:n,prop:l}),i.push(u))}return function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(r(i)){for(var s=[],a=0;a<i.length;++a)void 0!==i[a]&&s.push(i[a]);t.obj[t.prop]=s}}}(t),e},decode:function(e,t,i){var s=e.replace(/\+/g," ");if("iso-8859-1"===i)return s.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(s)}catch(e){return s}},encode:function(e,t,i){if(0===e.length)return e;var s="string"==typeof e?e:String(e);if("iso-8859-1"===i)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var r="",n=0;n<s.length;++n){var o=s.charCodeAt(n);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?r+=s.charAt(n):o<128?r+=a[o]:o<2048?r+=a[192|o>>6]+a[128|63&o]:o<55296||o>=57344?r+=a[224|o>>12]+a[128|o>>6&63]+a[128|63&o]:(n+=1,o=65536+((1023&o)<<10|1023&s.charCodeAt(n)),r+=a[240|o>>18]+a[128|o>>12&63]+a[128|o>>6&63]+a[128|63&o])}return r},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,i,a){if(!i)return t;if("object"!=typeof i){if(r(t))t.push(i);else{if(!t||"object"!=typeof t)return[t,i];(a&&(a.plainObjects||a.allowPrototypes)||!s.call(Object.prototype,i))&&(t[i]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(i);var o=t;return r(t)&&!r(i)&&(o=n(t,a)),r(t)&&r(i)?(i.forEach((function(i,r){if(s.call(t,r)){var n=t[r];n&&"object"==typeof n&&i&&"object"==typeof i?t[r]=e(n,i,a):t.push(i)}else t[r]=i})),t):Object.keys(i).reduce((function(t,r){var n=i[r];return s.call(t,r)?t[r]=e(t[r],n,a):t[r]=n,t}),o)}}}}]);