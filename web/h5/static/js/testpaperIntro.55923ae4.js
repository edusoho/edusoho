(window.webpackJsonp=window.webpackJsonp||[]).push([["testpaperIntro"],{3025:function(t,e,n){"use strict";n.r(e),n("8e6e"),n("ac6a"),n("456d"),n("c5f6"),n("e7e5");var i=n("d399"),r=n("bd86"),s=n("3ce7"),a=n("2f62"),o=n("0d25");function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(n,!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var u={name:"TestpaperIntro",mixins:[n("b7cf").a],data:function(){return{testpaper:null,testpaperTitle:"",info:{},startTime:null,limitTime:null,score:null,total:0,testId:null,targetId:null,counts:{},result:null,question_type_seq:[],answerName:null,timeName:null,answer:null,time:null,obj:{single_choice:"单选题",choice:"多选题",essay:"问答题",uncertain_choice:"不定项选择题",determine:"判断题",fill:"填空题",material:"材料题"}}},computed:c({sum:function(){var t=0;for(var e in this.counts)t+=parseInt(this.counts[e]);return t},disabled:function(){var t=(new Date).getTime();return this.startTime>t}},Object(a.d)({isLoading:function(t){return t.isLoading},user:function(t){return t.user}})),created:function(){this.getInfo()},beforeRouteEnter:function(t,e,n){document.getElementById("app").style.background="#f6f6f6",n()},beforeRouteLeave:function(t,e,n){document.getElementById("app").style.background="",n()},methods:c({},Object(a.b)("course",["handExamdo"]),{getInfo:function(){var t=this;this.testId=this.$route.query.testId,this.targetId=this.$route.query.targetId,s.a.testpaperIntro({params:{targetId:this.targetId,targetType:"task"},query:{testId:this.testId}}).then((function(e){t.counts=e.items,t.testpaperTitle=e.task.title,t.testpaper=e.testpaper,t.result=e.testpaperResult,t.info=e.task.activity.testpaperInfo,t.score=t.testpaper.score,t.startTime=1e3*parseInt(t.info.startTime),t.limitTime=parseInt(t.info.limitTime),t.question_type_seq=t.testpaper.metas.question_type_seq,t.canDoing(t.result,t.user.id).then((function(){t.startTestpaper()})).catch((function(e){var n=e.answer,i=e.endTime;t.submitExam(n,i)}))})).catch((function(t){i.a.fail(t.message)}))},submitExam:function(t,e){var n=this;e=e||(new Date).getTime();var r={answer:t,resultId:this.result.id,userId:this.user.id,beginTime:Number(this.result.beginTime),endTime:e};this.handExamdo(r).then((function(t){n.showResult()})).catch((function(t){i.a.fail(t.message)}))},startTestpaper:function(){this.$router.push({name:"testpaperDo",query:{testId:this.testId,targetId:this.targetId,title:this.testpaperTitle,action:"do"},params:{KeepDoing:!0}})},showResult:function(){this.$router.push({name:"testpaperResult",query:{resultId:this.result.id,testId:this.testId,targetId:this.targetId}})},formateStartTime:function(t){return Object(o.formatTime)(new Date(t))}})},p=n("2877"),d=Object(p.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isLoading?n("e-loading"):t._e(),n("div",{staticClass:"intro-body"},[n("van-panel",{staticClass:"panel intro-panel",attrs:{title:"考试名称"}},[n("div",{staticClass:"intro-panel__content intro-panel__content--title"},[t._v(t._s(t.testpaperTitle))])]),t.startTime?n("van-panel",{staticClass:"panel intro-panel",attrs:{title:"开考时间"}},[n("div",{class:["intro-panel__content",t.result||!t.disabled?"":"intro-tip"]},[t._v(t._s(t.formateStartTime(t.startTime)))])]):t._e(),n("van-panel",{staticClass:"panel intro-panel",attrs:{title:"考试时长"}},[t.limitTime?n("div",{class:["intro-panel__content",t.result||!t.disabled?"":"intro-tip"]},[t._v(t._s(t.limitTime)+"分钟")]):n("div",{staticClass:"intro-panel__content"},[t._v("不限制")])]),n("van-panel",{staticClass:"panel intro-panel",attrs:{title:"试卷满分"}},[n("div",{staticClass:"intro-panel__content"},[t._v("满分"+t._s(t.score)+"分")])]),n("van-panel",{staticClass:"panel intro-panel",attrs:{title:"题目数量"}},[n("div",{staticClass:"intro-panel__content"},[n("van-cell",{staticClass:"intro-cell intro-cell--total",attrs:{border:!1,value:t.sum+"题",title:"共计"}}),t._l(t.question_type_seq,(function(e){return n("van-cell",{key:e,staticClass:"intro-cell",attrs:{border:!1,title:t.obj[e],value:t.counts[e]+"题"}})}))],2)])],1),n("div",{staticClass:"intro-footer"},[t.result?n("van-button",{staticClass:"intro-footer__btn",attrs:{type:"primary"},on:{click:t.showResult}},[t._v("查看成绩")]):n("van-button",{staticClass:"intro-footer__btn",attrs:{disabled:t.disabled,type:"primary"},on:{click:function(e){return t.startTestpaper()}}},[t._v("开始考试")])],1)],1)}),[],!1,null,null,null);e.default=d.exports},b7cf:function(t,e,n){"use strict";n("c5f6"),n("e17f");var i=n("2241");n("456d"),n("ac6a"),e.a={methods:{canDoing:function(t,e){return new Promise((function(n,r){if(t&&"doing"===t.status){var s="".concat(e,"-").concat(t.id),a=JSON.parse(localStorage.getItem(s));a=a?Object.keys(a).forEach((function(t){a[t]=a[t].filter((function(t){return""!==t}))})):{},i.a.confirm({title:"提示",cancelButtonText:"放弃考试",confirmButtonText:"继续考试",message:"您有未完成的考试，是否继续？"}).then((function(){if(Number(t.limitedTime)>0){var e=Math.ceil(((new Date).getTime()-1e3*t.beginTime)/1e3/60);if(Number(e)>Number(t.limitedTime)){var i=Number(1e3*t.beginTime)+Number(60*t.limitedTime*1e3);return void r({answer:a,endTime:i})}}n()})).catch((function(){r({answer:a,endTime:null})}))}}))}}}}}]);