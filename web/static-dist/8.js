/*! For license information please see 8.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1665:function(e,t,i){"use strict";var s={props:{type:null}},n=i(20),a=Object(n.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return"random"===e.type?i("div",{staticClass:"paper-type paper-type-random"},[e._v(e._s(e._f("trans")("question.bank.paper.random")))]):"regular"===e.type?i("div",{staticClass:"paper-type paper-type-regular"},[e._v("\n  "+e._s(e._f("trans")("question.bank.paper.regular"))+"\n")]):"aiPersonality"===e.type?i("div",{staticClass:"paper-type paper-type-ai"},[e._v("\n  "+e._s(e._f("trans")("question.bank.paper.aiPersonality"))+"\n")]):e._e()}),[],!1,null,null,null);t.a=a.exports},1807:function(e,t,i){e.exports=i(1875)},1808:function(e,t,i){e.exports=i(1878)},1875:function(e,t,i){i(1876),e.exports=i(73).Number.isInteger},1876:function(e,t,i){var s=i(90);s(s.S,"Number",{isInteger:i(1877)})},1877:function(e,t,i){var s=i(141),n=Math.floor;e.exports=function(e){return!s(e)&&isFinite(e)&&n(e)===e}},1878:function(e,t,i){i(1879),e.exports=i(73).Number.parseInt},1879:function(e,t,i){var s=i(90),n=i(677);s(s.S+s.F*(Number.parseInt!=n),"Number",{parseInt:n})},376:function(e,t,i){e.exports=i(660)},4:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},422:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},49:function(e,t){function i(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function s(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,t,n){var a=document.head||document.getElementsByTagName("head")[0],o=document.createElement("script");"function"==typeof t&&(n=t,t={}),t=t||{},n=n||function(){},o.type=t.type||"text/javascript",o.charset=t.charset||"utf8",o.async=!("async"in t)||!!t.async,o.src=e,t.attrs&&function(e,t){for(var i in t)e.setAttribute(i,t[i])}(o,t.attrs),t.text&&(o.text=""+t.text),("onload"in o?i:s)(o,n),o.onload||i(o,n),a.appendChild(o)}},5:function(e,t,i){var s=i(24);function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),s(e,n.key,n)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},525:function(e,t,i){var s=i(90),n=i(378),a=i(205),o=i(422),r="["+o+"]",c=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),l=function(e,t,i){var n={},r=a((function(){return!!o[e]()||"​"!="​"[e]()})),c=n[e]=r?t(p):o[e];i&&(n[i]=c),s(s.P+s.F*r,"String",n)},p=l.trim=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=l},660:function(e,t,i){i(661),e.exports=i(73).Reflect.deleteProperty},661:function(e,t,i){var s=i(90),n=i(276).f,a=i(139);s(s.S,"Reflect",{deleteProperty:function(e,t){var i=n(a(e),t);return!(i&&!i.configurable)&&delete e[t]}})},677:function(e,t,i){var s=i(120).parseInt,n=i(525).trim,a=i(422),o=/^[-+]?0[xX]/;e.exports=8!==s(a+"08")||22!==s(a+"0x16")?function(e,t){var i=n(String(e),3);return s(i,t>>>0||(o.test(i)?16:10))}:s},712:function(e,t,i){"use strict";i.r(t);var s=i(17),n=i.n(s),a=i(29),o=i.n(a),r=i(21),c=i.n(r),u=i(38),l=i.n(u),p=i(15),d=i.n(p),h=i(27),y=i.n(h),f=i(24),g=i.n(f),m=i(1807),v=i.n(m),C=i(1808),b=i.n(C),_=i(50),q=i.n(_),w=i(22),k=i.n(w),x=i(30),S=i(49),T=i.n(S),E={components:{TestPaperTypeTag:i(1665).a},props:{type:null,paperQuestionCount:void 0,paperScore:void 0},methods:{backConfirm:function(){this.$emit("back-confirm")}}},D=i(20),P=Object(D.a)(E,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-affix",{attrs:{"offset-top":0}},[i("div",{staticClass:"test-paper-save-header"},[i("div",{staticClass:"test-paper-save-header-left"},[i("div",{staticClass:"test-paper-save-header-left-back",on:{click:e.backConfirm}},[i("span",{staticClass:"test-paper-save-header-left-back-img"},[i("img",{attrs:{src:"/static-dist/app/img/question-bank/back-image.png",alt:""}})]),e._v(" "),i("span",{staticClass:"test-paper-save-header-left-back-text"},[e._v("返回")])]),e._v(" "),i("i"),e._v(" "),i("test-paper-type-tag",{attrs:{type:e.type}})],1),e._v(" "),i("div",{staticClass:"test-paper-save-header-right"},[i("span",{staticClass:"test-paper-save-header-right-item"},[i("span",{staticClass:"test-paper-save-header-right-text"},[e._v("试题")]),e._v(" "),i("span",{staticClass:"test-paper-save-header-right-number"},[e._v(e._s(e.paperQuestionCount))])]),e._v(" "),i("i"),e._v(" "),i("span",{staticClass:"test-paper-save-header-right-item"},[i("span",{staticClass:"test-paper-save-header-right-text"},[e._v("总分")]),e._v(" "),i("span",{staticClass:"test-paper-save-header-right-number"},[e._v(e._s(e.paperScore))])])])])])}),[],!1,null,null,null).exports,F=i(1666),I=i.n(F),N=i(71),V=i.n(N),Q={name:"QuestionTypeDisplaySetMenu",props:{questionTypeDisplaySettings:void 0,settingKey:void 0},components:{Draggable:I.a},data:function(){return{questionTypeDisplaySetting:[]}},methods:{onMenuVisibleChange:function(e){e?this.questionTypeDisplaySetting=V.a.cloneDeep(this.questionTypeDisplaySettings[this.settingKey]):this.$emit("updateQuestionTypeDisplaySetting",this.settingKey,V.a.cloneDeep(this.questionTypeDisplaySetting))},onSwitchClick:function(e){e.checked?(this.questionTypeDisplaySetting.forEach((function(t){t.checked&&t.type!==e.type&&(e.checked=!1)})),e.checked&&this.$message.error("至少保留一个题型")):e.checked=!0}}},L=Object(D.a)(Q,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-dropdown",{attrs:{trigger:["click"],placement:"bottomRight"},on:{visibleChange:e.onMenuVisibleChange}},[i("div",{staticClass:"question-type-display-setting"},[i("img",{attrs:{src:"/static-dist/app/img/question-bank/question-type-show-image.png",alt:""}}),e._v(" "),i("span",[e._v("题型展示设置")])]),e._v(" "),i("a-menu",{staticClass:"question-type-setting-menu",attrs:{slot:"overlay"},slot:"overlay"},[i("draggable",{attrs:{handle:".question-type-setting-menu-item-label-icon","drag-class":"question-type-setting-menu-item-drag"},model:{value:e.questionTypeDisplaySetting,callback:function(t){e.questionTypeDisplaySetting=t},expression:"questionTypeDisplaySetting"}},[i("transition-group",e._l(e.questionTypeDisplaySetting,(function(t){return i("a-menu-item",{key:t.type,staticClass:"question-type-setting-menu-item"},[i("span",{staticClass:"question-type-setting-menu-item-label"},[i("img",{staticClass:"question-type-setting-menu-item-label-icon",attrs:{src:"/static-dist/app/img/question-bank/question-type-drag.png",alt:""}}),e._v(" "),i("span",{staticClass:"question-type-setting-menu-item-label-text"},[e._v(e._s(t.name))])]),e._v(" "),i("a-switch",{staticClass:"question-type-setting-menu-item-switch",attrs:{checked:t.checked},on:{click:function(i){return e.onSwitchClick(t)}}})],1)})),1)],1)],1)],1)}),[],!1,null,null,null).exports,$=i(111),R=i.n($),O=i(175),A=i.n(O),j=i(126),B=i.n(j),U={props:{visible:void 0,bankId:void 0},data:function(){return{form:this.$form.createForm(this,{name:"create-question-category"}),names:"",validateNames:function(e,t,i){var s;void 0!==t&&""!==t&&t.split("\n").map((function(e){e.length>30&&(s=new Error(Translator.trans("question_bank.question_category.name_max_message"))),0===e.trim().length&&(s=new Error(Translator.trans("validate.visible_character.message")))})),i(s)}}},methods:{onCancel:function(){this.$emit("cancel")},onOk:function(){var e=this;this.form.validateFields((function(t){t||x.a.post("/api/item_bank/".concat(e.bankId,"/item_category"),{names:e.names}).then((function(t){t.ok&&(e.$emit("ok"),e.$message.success("添加成功"))}))}))},onNamesChange:function(e){this.names=e.target.value}}};function G(){G=function(){return t};var e,t={},i=Object.prototype,s=i.hasOwnProperty,a=g.a||function(e,t,i){e[t]=i.value},r="function"==typeof y.a?y.a:{},u=r.iterator||"@@iterator",p=r.asyncIterator||"@@asyncIterator",h=r.toStringTag||"@@toStringTag";function f(e,t,i){return g()(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,i){return e[t]=i}}function m(e,t,i,s){var n=t&&t.prototype instanceof w?t:w,o=d()(n.prototype),r=new L(s||[]);return a(o,"_invoke",{value:I(e,i,r)}),o}function v(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}t.wrap=m;var C="suspendedStart",b="executing",_="completed",q={};function w(){}function k(){}function x(){}var S={};f(S,u,(function(){return this}));var T=l.a,E=T&&T(T($([])));E&&E!==i&&s.call(E,u)&&(S=E);var D=x.prototype=w.prototype=d()(S);function P(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function F(e,t){function i(n,a,o,r){var u=v(e[n],e,a);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==c()(p)&&s.call(p,"__await")?t.resolve(p.__await).then((function(e){i("next",e,o,r)}),(function(e){i("throw",e,o,r)})):t.resolve(p).then((function(e){l.value=e,o(l)}),(function(e){return i("throw",e,o,r)}))}r(u.arg)}var n;a(this,"_invoke",{value:function(e,s){function a(){return new t((function(t,n){i(e,s,t,n)}))}return n=n?n.then(a,a):a()}})}function I(t,i,s){var n=C;return function(a,o){if(n===b)throw Error("Generator is already running");if(n===_){if("throw"===a)throw o;return{value:e,done:!0}}for(s.method=a,s.arg=o;;){var r=s.delegate;if(r){var c=N(r,s);if(c){if(c===q)continue;return c}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(n===C)throw n=_,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);n=b;var u=v(t,i,s);if("normal"===u.type){if(n=s.done?_:"suspendedYield",u.arg===q)continue;return{value:u.arg,done:s.done}}"throw"===u.type&&(n=_,s.method="throw",s.arg=u.arg)}}}function N(t,i){var s=i.method,n=t.iterator[s];if(n===e)return i.delegate=null,"throw"===s&&t.iterator.return&&(i.method="return",i.arg=e,N(t,i),"throw"===i.method)||"return"!==s&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+s+"' method")),q;var a=v(n,t.iterator,i.arg);if("throw"===a.type)return i.method="throw",i.arg=a.arg,i.delegate=null,q;var o=a.arg;return o?o.done?(i[t.resultName]=o.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,q):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,q)}function V(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function Q(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(V,this),this.reset(!0)}function $(t){if(t||""===t){var i=t[u];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function i(){for(;++n<t.length;)if(s.call(t,n))return i.value=t[n],i.done=!1,i;return i.value=e,i.done=!0,i};return a.next=a}}throw new TypeError(c()(t)+" is not iterable")}return k.prototype=x,a(D,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:k,configurable:!0}),k.displayName=f(x,h,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return o.a?o()(e,x):(e.__proto__=x,f(e,h,"GeneratorFunction")),e.prototype=d()(D),e},t.awrap=function(e){return{__await:e}},P(F.prototype),f(F.prototype,p,(function(){return this})),t.AsyncIterator=F,t.async=function(e,i,s,a,o){void 0===o&&(o=n.a);var r=new F(m(e,i,s,a),o);return t.isGeneratorFunction(i)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},P(D),f(D,h,"Generator"),f(D,u,(function(){return this})),f(D,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),i=[];for(var s in t)i.push(s);return i.reverse(),function e(){for(;i.length;){var s=i.pop();if(s in t)return e.value=s,e.done=!1,e}return e.done=!0,e}},t.values=$,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(Q),!t)for(var i in this)"t"===i.charAt(0)&&s.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function n(s,n){return r.type="throw",r.arg=t,i.next=s,n&&(i.method="next",i.arg=e),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],r=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=s.call(o,"catchLoc"),u=s.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,q):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),q},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),Q(i),q}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var s=i.completion;if("throw"===s.type){var n=s.arg;Q(i)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,i,s){return this.delegate={iterator:$(t),resultName:i,nextLoc:s},"next"===this.method&&(this.arg=e),q}},t}function K(e,t){var i=void 0!==y.a&&e[A.a]||e["@@iterator"];if(!i){if(R()(e)||(i=function(e,t){if(e){if("string"==typeof e)return M(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?B()(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?M(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var s=0,n=function(){};return{s:n,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,r=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){r=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw a}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=Array(t);i<t;i++)s[i]=e[i];return s}var Y={props:{bankId:void 0,selectedCategories:void 0},components:{QuestionCategoryCreateModal:Object(D.a)(U,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{staticClass:"question-category-add-modal",attrs:{visible:e.visible,width:420,centered:!0,maskClosable:!1,title:"添加题目分类",cancelText:"取消",okText:"保存"},on:{cancel:e.onCancel,ok:e.onOk}},[i("div",{staticClass:"question-category-add-modal-body"},[i("span",{staticClass:"question-category-add-modal-body-description"},[e._v("可批量添加分类，一行一个，每个分类最多输入30个字符")]),e._v(" "),i("div",{staticClass:"question-category-add-modal-body-content"},[i("div",{staticClass:"question-category-add-modal-body-content-label"},[i("span",[e._v("分类名称")])]),e._v(" "),i("a-form",{attrs:{form:e.form}},[i("a-form-item",[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["names",{initialValue:e.names,rules:[{required:!0,message:"请输入分类名称"},{validator:e.validateNames}]}],expression:"[\n              'names',\n              {\n                initialValue: names,\n                rules: [\n                  { required: true, message: '请输入分类名称' },\n                  { validator: validateNames },\n                ]\n              },\n            ]"}],attrs:{placeholder:"请输入"},on:{change:e.onNamesChange}})],1)],1)],1)])])}),[],!1,null,null,null).exports},data:function(){return{drawerVisible:!1,modalVisible:!1,checkChildrenOperationVisibleId:void 0,categories:[],categoriesTree:{},checkedCategories:{},disabledCategories:{}}},computed:{checkChildrenVisible:function(){var e=this;return function(t){return t===e.checkChildrenOperationVisibleId&&0!==e.categoriesTree[t].children.length&&!e.disabledCategories[t]&&e.hasChildUnchecked(t)}},unCheckChildrenVisible:function(){var e=this;return function(t){return t===e.checkChildrenOperationVisibleId&&0!==e.categoriesTree[t].children.length&&!e.disabledCategories[t]&&!e.hasChildUnchecked(t)}},checkAllBoxIndeterminate:function(){var e,t=0,i=K(this.categories);try{for(i.s();!(e=i.n()).done;){var s=e.value;this.checkedCategories[s.id]&&t++}}catch(e){i.e(e)}finally{i.f()}return t>0&&t<this.categories.length},allCategoriesChecked:function(){var e,t=K(this.categories);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(!this.disabledCategories[i.id]&&!this.checkedCategories[i.id])return!1}}catch(e){t.e(e)}finally{t.f()}return this.categories.length>0},clearOperateVisible:function(){var e,t=K(this.categories);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(this.checkedCategories[i.id])return!0}}catch(e){t.e(e)}finally{t.f()}return!1}},methods:{onDrawerDisplay:function(){this.fetchQuestionCategories(),this.drawerVisible=!0},fetchQuestionCategories:function(){var e=arguments,t=this;return k()(G().mark((function i(){var s,n,a;return G().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=e.length>0&&void 0!==e[0]?e[0]:"",i.next=3,x.a.get("/api/item/categoryId/count",{params:{bank_id:t.bankId}});case 3:return n=i.sent,t.disabledCategories={},n.forEach((function(e){t.disabledCategories[e.category_id]=!1})),i.next=8,x.a.get("/api/item_bank/".concat(t.bankId,"/item_category_transform/treeList"));case 8:a=i.sent,t.categories=[],t.categoriesTree={},a.forEach((function(e){e.name.includes(s)&&(t.categories.push({id:e.id,name:e.name,depth:e.depth,level:t.getCategoryLevelText(e.depth)}),t.categoriesTree[e.id]={children:[]},t.categoriesTree[e.parent_id]&&t.categoriesTree[e.parent_id].children.push(e.id),void 0===t.disabledCategories[e.id]&&(t.disabledCategories[e.id]=!0))})),t.checkedCategories={},t.selectedCategories.forEach((function(e){t.disabledCategories[e.id]||t.checkedCategory(e.id)}));case 14:case"end":return i.stop()}}),i)})))()},getCategoryLevelText:function(e){return{1:"一级分类",2:"二级分类",3:"三级分类"}[e]},onCheckAllChange:function(e){var t=this;this.categories.forEach((function(i){t.disabledCategories[i.id]||t.$set(t.checkedCategories,i.id,e.target.checked)}))},onCheckBoxChange:function(e){this.$set(this.checkedCategories,e.target.value,e.target.checked)},hasChildUnchecked:function(e){if(!this.disabledCategories[e]&&!this.checkedCategories[e])return!0;if(this.categoriesTree[e].children){var t,i=K(this.categoriesTree[e].children);try{for(i.s();!(t=i.n()).done;){var s=t.value;if(this.hasChildUnchecked(s))return!0}}catch(e){i.e(e)}finally{i.f()}}return!1},checkedSelfAndChildren:function(e){var t=this;this.disabledCategories[e]||this.checkedCategory(e),this.categoriesTree[e].children&&this.categoriesTree[e].children.forEach((function(e){t.checkedSelfAndChildren(e)}))},unCheckedSelfAndChildren:function(e){var t=this;this.unCheckedCategory(e),this.categoriesTree[e].children&&this.categoriesTree[e].children.forEach((function(e){t.unCheckedSelfAndChildren(e)}))},unCheckedAllCategories:function(){var e=this;this.categories.forEach((function(t){e.unCheckedCategory(t.id)}))},checkedCategory:function(e){this.$set(this.checkedCategories,e,!0)},unCheckedCategory:function(e){this.$set(this.checkedCategories,e,!1)},saveCheckedCategories:function(){var e=this;if(0!==this.categories.length){var t=[];this.categories.forEach((function(i){e.checkedCategories[i.id]&&t.push(i)})),0!==t.length?(this.$emit("save-selected-categories",t),this.drawerVisible=!1,this.$message.success("保存成功")):this.$message.error("请选择分类")}else this.$message.error("该题库下暂无分类，请添加题目分类")},onSearchCategories:function(e){this.fetchQuestionCategories(e.target.value)},onDrawerClose:function(){var e=this;this.$confirm({title:"确定放弃此次操作吗？",content:"当前操作尚未保存",icon:"exclamation-circle",okText:"确定",cancelText:"取消",centered:!0,onOk:function(){e.drawerVisible=!1}})},onCategoriesCreated:function(){this.fetchQuestionCategories(),this.modalVisible=!1}}},z=Y,J=Object(D.a)(z,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"question-category-choose-btn",on:{click:e.onDrawerDisplay}},[i("span",{staticClass:"question-category-choose-btn-text"},[e._v("+ 选择分类")])]),e._v(" "),i("a-drawer",{staticClass:"question-category-choose-drawer",attrs:{title:"选择分类",width:"960",visible:e.drawerVisible,maskClosable:!1},on:{close:e.onDrawerClose}},[i("div",{staticClass:"question-category-choose-container-body"},[i("div",{staticClass:"question-category-choose-all"},[i("div",{staticClass:"question-category-choose-all-header"},[i("a-input",{attrs:{placeholder:"搜索分类"},on:{pressEnter:e.onSearchCategories}},[i("img",{staticClass:"question-category-choose-all-header-search-icon",attrs:{slot:"prefix",src:"/static-dist/app/img/question-bank/question-category-search-icon.png",alt:""},slot:"prefix"})]),e._v(" "),i("a-checkbox",{attrs:{indeterminate:e.checkAllBoxIndeterminate,checked:e.allCategoriesChecked},on:{change:e.onCheckAllChange}},[i("span",{staticClass:"question-category-choose-all-header-check-all-text"},[e._v("选择全部分类")])])],1),e._v(" "),i("div",{staticClass:"question-category-choose-all-body"},[e._l(e.categories,(function(t){return i("div",{staticClass:"question-category-choose-all-body-category",on:{mouseover:function(i){e.checkChildrenOperationVisibleId=t.id},mouseleave:function(t){e.checkChildrenOperationVisibleId=void 0}}},[i("div",{class:"question-category-choose-all-body-category-depth-"+t.depth},[e.disabledCategories[t.id]?i("a-tooltip",{attrs:{placement:"topLeft",title:"该分类下暂无题目"}},[i("a-checkbox",{attrs:{disabled:!0}},[i("span",{staticClass:"question-category-choose-all-body-category-name"},[e._v(e._s(t.name))])])],1):e._e(),e._v(" "),!1===e.disabledCategories[t.id]?i("a-checkbox",{attrs:{value:t.id,checked:e.checkedCategories[t.id]},on:{change:e.onCheckBoxChange}},[i("span",{staticClass:"question-category-choose-all-body-category-name"},[e._v(e._s(t.name))])]):e._e()],1),e._v(" "),i("div",[i("span",{directives:[{name:"show",rawName:"v-show",value:e.checkChildrenVisible(t.id),expression:"checkChildrenVisible(category.id)"}],staticClass:"question-category-choose-all-body-category-operation",on:{click:function(i){return e.checkedSelfAndChildren(t.id)}}},[e._v("全选")]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.unCheckChildrenVisible(t.id),expression:"unCheckChildrenVisible(category.id)"}],staticClass:"question-category-choose-all-body-category-operation",on:{click:function(i){return e.unCheckedSelfAndChildren(t.id)}}},[e._v("取消全选")])])])})),e._v(" "),0===e.categories.length?i("div",{staticClass:"question-category-choose-all-body-empty"},[i("div",{staticClass:"question-category-choose-all-body-empty-content"},[i("div",{staticClass:"question-category-choose-all-body-empty-content-img"},[i("img",{attrs:{src:"/static-dist/app/img/question-bank/empty.png",alt:""}})]),e._v(" "),i("span",{staticClass:"question-category-choose-all-body-empty-content-text"},[e._v("暂无分类")])]),e._v(" "),i("button",{staticClass:"question-category-choose-all-body-add-category-btn",on:{click:function(t){e.modalVisible=!0}}},[e._v("添加题目分类")])]):e._e()],2)]),e._v(" "),i("div",{staticClass:"question-category-choose-selected"},[i("div",{staticClass:"question-category-choose-selected-header"},[i("span",{staticClass:"question-category-choose-selected-header-selected"},[e._v("已选")]),e._v(" "),i("a-popconfirm",{directives:[{name:"show",rawName:"v-show",value:e.clearOperateVisible,expression:"clearOperateVisible"}],attrs:{title:"确定要清空全部吗？",placement:"bottomRight","ok-text":"确定","cancel-text":"取消"},on:{confirm:e.unCheckedAllCategories}},[i("span",{staticClass:"question-category-choose-selected-header-clear"},[e._v("清空")])]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!e.clearOperateVisible,expression:"!clearOperateVisible"}],staticClass:"question-category-choose-selected-header-clear-disable"},[e._v("清空")])],1),e._v(" "),i("div",{staticClass:"question-category-choose-selected-body"},e._l(e.categories,(function(t){return i("div",{directives:[{name:"show",rawName:"v-show",value:e.checkedCategories[t.id],expression:"checkedCategories[category.id]"}],staticClass:"question-category-choose-selected-body-item"},[i("div",{staticClass:"question-category-choose-selected-body-item-text"},[i("a-tooltip",{attrs:{placement:"top",title:t.name}},[i("div",{staticClass:"question-category-choose-selected-body-item-text-name"},[e._v(e._s(t.name))])]),e._v(" "),i("span",{staticClass:"question-category-choose-selected-body-item-text-level"},[e._v(e._s(t.level))])],1),e._v(" "),i("img",{staticClass:"question-category-choose-selected-body-item-remove",attrs:{src:"/static-dist/app/img/question-bank/remove-selected-question-category-icon.png",alt:""},on:{click:function(i){return e.unCheckedCategory(t.id)}}})])})),0)])]),e._v(" "),i("div",{staticClass:"question-category-choose-container-footer"},[i("div",{staticClass:"question-category-choose-container-footer-btn-group"},[i("button",{staticClass:"question-category-choose-container-footer-btn-cancel",on:{click:e.onDrawerClose}},[i("span",{staticClass:"question-category-choose-container-footer-btn-text"},[e._v("取消")])]),e._v(" "),i("button",{staticClass:"question-category-choose-container-footer-btn-save",on:{click:e.saveCheckedCategories}},[i("span",{staticClass:"question-category-choose-container-footer-btn-text"},[e._v("保存")])])])])]),e._v(" "),i("question-category-create-modal",{attrs:{visible:e.modalVisible,bankId:e.bankId},on:{ok:e.onCategoriesCreated,cancel:function(t){e.modalVisible=!1}}})],1)}),[],!1,null,null,null).exports,W={name:"QuestionTypeCategoryEditDrawer",props:{drawerVisible:!1,defaultQuestionTypeDisplaySettings:void 0,questionTypeDisplaySettingKey:void 0,defaultCategories:void 0,defaultScores:void 0,defaultQuestionCounts:void 0,bankId:void 0},components:{QuestionTypeDisplaySetMenu:L},data:function(){return{editingRow:null,questionTypeDisplaySettings:{},questionTypeDisplaySetting:[],categories:[],questionCounts:{single_choice:{choose:[],total:{}},choice:{choose:[],total:{}},essay:{choose:[],total:{}},uncertain_choice:{choose:[],total:{}},determine:{choose:[],total:{}},fill:{choose:[],total:{}},material:{choose:[],total:{}}},scores:{single_choice:2,choice:2,essay:2,uncertain_choice:2,determine:2,fill:2,material:2}}},computed:{totalCount:function(){var e=this;return function(t,i){return e.questionCounts[i].total[t]?e.questionCounts[i].total[t]:0}},countErrorClass:function(){var e=this;return function(t,i){return Number(e.questionCounts[i].choose[t])>e.questionCounts[i].total[t]?"question-type-category-display-cell-number-total-error":""}}},methods:{fetchQuestionCounts:function(){var e=this;this.questionTypeDisplaySetting.forEach((function(t){e.defaultCategories.forEach((function(i){e.questionCounts[t.type].choose[i.id]=0,e.defaultQuestionCounts[t.type].categoryCounts&&e.defaultQuestionCounts[t.type].categoryCounts[i.id]&&(e.questionCounts[t.type].choose[i.id]=e.defaultQuestionCounts[t.type].categoryCounts[i.id])})),e.scores[t.type]=e.defaultScores[t.type]}));var t=[];this.defaultCategories.forEach((function(e){t.push(e.id)})),x.a.get("/api/item/categoryIdAndType/count",{params:{bank_id:this.bankId,category_ids:t}}).then((function(t){t.forEach((function(t){e.$set(e.questionCounts[t.type].total,t.category_id,t.itemNum)}))}))},close:function(){this.$emit("close")},save:function(){var e=this,t=0;this.questionTypeDisplaySetting.forEach((function(i){e.categories.forEach((function(s){t+=e.questionCounts[i.type].choose[s.id]}))})),0!==t?(this.$emit("save",this.categories,V.a.cloneDeep(this.questionTypeDisplaySetting),V.a.cloneDeep(this.questionCounts),V.a.cloneDeep(this.scores)),this.$message.success(Translator.trans("site.save_success_hint")),this.close()):this.$message.error("请至少选择 1 道题目")},closeConfirm:function(){this.$confirm({title:"确定放弃此次操作吗？",content:"当前操作尚未保存",centered:!0,okText:"确定",cancelText:"取消",onOk:this.close})},removeCategory:function(e){this.categories=this.categories.filter((function(t){return t.id!==e}))},sumNum:function(e){var t=this,i=0;return this.categories.forEach((function(s){i+=t.questionCounts[e].choose[s.id]?Number(t.questionCounts[e].choose[s.id]):0})),i},sumScore:function(e){return(this.sumNum(e)*this.scores[e]).toFixed(1)},onQuestionTypeDisplaySettingUpdate:function(e,t){this.questionTypeDisplaySettings[e]=t,this.questionTypeDisplaySetting=t},onInputCountBlur:function(e,t){this.editingRow=null,""===this.questionCounts[e].choose[t]&&(this.questionCounts[e].choose[t]=0),this.questionCounts[e].choose[t]=b()(this.questionCounts[e].choose[t]),this.questionCounts[e].choose[t]>this.questionCounts[e].total[t]&&(this.questionCounts[e].choose[t]=this.questionCounts[e].total[t])},onInputScoreBlur:function(e){this.editingRow=null,""===this.scores[e]?this.scores[e]=2:v()(Number(this.scores[e]))||(this.scores[e]=Number(this.scores[e]).toFixed(1)),0===Number(this.scores[e])&&(this.scores[e]=2)}},watch:{drawerVisible:function(e){e?(document.body.style.overflowY="hidden",this.questionTypeDisplaySettings=V.a.cloneDeep(this.defaultQuestionTypeDisplaySettings),this.questionTypeDisplaySetting=this.defaultQuestionTypeDisplaySettings[this.questionTypeDisplaySettingKey],this.categories=V.a.cloneDeep(this.defaultCategories),this.fetchQuestionCounts()):document.body.style.overflowY="auto"}}},H={name:"QuestionTypeCategoryDisplay",components:{QuestionTypeCategoryEditDrawer:Object(D.a)(W,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-drawer",{attrs:{"get-container":".test-create",width:"100vw","wrap-class-name":"drawer-container",visible:e.drawerVisible,closable:!1},scopedSlots:e._u([{key:"title",fn:function(){return[i("div",{staticClass:"drawer-header"},[i("div",{staticClass:"drawer-header-return",on:{click:e.closeConfirm}},[e._v("< "+e._s(e._f("trans")("importer.import_back_btn")))]),e._v(" "),i("div",{staticClass:"separator"}),e._v(" "),i("span",[e._v("按题型+分类抽题")])])]},proxy:!0}])},[e._v(" "),i("div",{staticClass:"drawer-body"},[i("question-type-display-set-menu",{attrs:{"question-type-display-settings":e.questionTypeDisplaySettings,"setting-key":e.questionTypeDisplaySettingKey},on:{updateQuestionTypeDisplaySetting:e.onQuestionTypeDisplaySettingUpdate}}),e._v(" "),i("div",{staticClass:"question-type-category-display"},[i("div",{staticClass:"question-type-category-display-header"},[i("div",{staticClass:"question-type-category-display-header-top"},[e._v("分类")]),e._v(" "),e._l(e.categories,(function(t,s){return i("div",{staticClass:"question-type-category-display-header-normal",class:{"row-editing":e.editingRow===s}},[i("div",{staticClass:"question-type-category-display-header-normal-level"},[e._v(e._s(t.level))]),e._v(" "),i("a-tooltip",{attrs:{placement:"top",title:t.name}},[i("span",{staticClass:"category-name"},[e._v(e._s(t.name))])])],1)})),e._v(" "),i("div",{staticClass:"question-type-category-display-header-score",class:{"row-editing":e.editingRow===e.categories.length}},[i("span",{staticClass:"question-type-category-display-header-top-content"},[e._v("按题型设置分值")])]),e._v(" "),i("div",{staticClass:"question-type-category-display-header-bottom"},[i("span",{staticClass:"question-type-category-display-header-bottom-title"},[e._v("合计")]),e._v(" "),i("span",{staticClass:"question-type-category-display-header-bottom-description"},[e._v("（题数/总分）")])])],2),e._v(" "),e._l(e.questionTypeDisplaySetting,(function(t){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.checked,expression:"type.checked"}],staticClass:"question-type-category-display-header-type"},[i("div",{staticClass:"question-type-category-display-header-top"},[i("div",{staticClass:"question-type-category-display-header-top-content"},[e._v(e._s(t.name))])]),e._v(" "),e._l(e.categories,(function(s,n){return i("div",{staticClass:"question-type-category-display-cell",class:{"row-editing":e.editingRow===n,"question-type-category-display-cell-active":e.totalCount(s.id,t.type)>0,"question-type-category-display-cell-inactive":0===e.totalCount(s.id,t.type)}},[e.totalCount(s.id,t.type)>0?i("input",{directives:[{name:"model",rawName:"v-model",value:e.questionCounts[t.type].choose[s.id],expression:"questionCounts[type.type].choose[category.id]"}],staticClass:"question-type-category-display-cell-number",attrs:{type:"number",min:"0",max:e.totalCount(s.id,t.type)},domProps:{value:e.questionCounts[t.type].choose[s.id]},on:{focus:function(t){e.editingRow=n},blur:function(i){return e.onInputCountBlur(t.type,s.id)},input:function(i){i.target.composing||e.$set(e.questionCounts[t.type].choose,s.id,i.target.value)}}}):e._e(),e._v(" "),0===e.totalCount(s.id,t.type)?i("span",{staticClass:"question-type-category-display-cell-number-total"},[e._v("0")]):e._e(),e._v(" "),i("span",{staticClass:"question-type-category-display-cell-number-total",class:e.countErrorClass(s.id,t.type)},[e._v("/"+e._s(e.totalCount(s.id,t.type)))])])})),e._v(" "),i("div",{staticClass:"question-type-category-display-cell question-type-category-display-cell-active",class:{"row-editing":e.editingRow===e.categories.length}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.scores[t.type],expression:"scores[type.type]"}],staticClass:"question-type-category-display-cell-number",attrs:{type:"number",min:"0"},domProps:{value:e.scores[t.type]},on:{focus:function(t){e.editingRow=e.categories.length},blur:function(i){return e.onInputScoreBlur(t.type)},input:function(i){i.target.composing||e.$set(e.scores,t.type,i.target.value)}}})]),e._v(" "),i("div",{staticClass:"question-type-category-display-cell-sum"},[e._v(e._s(e.sumNum(t.type)+" / "+e.sumScore(t.type)))])],2)})),e._v(" "),i("div",{staticClass:"question-type-category-display-header-action"},[i("div",{staticClass:"question-type-category-display-header-top"},[e._v("操作")]),e._v(" "),e._l(e.categories,(function(t,s){return i("div",{staticClass:"question-type-category-display-cell",class:{"row-editing":e.editingRow===s}},[i("a-popconfirm",{attrs:{title:"确定要删除当前分类吗？","ok-text":"移除","cancel-text":"取消"},on:{confirm:function(i){return e.removeCategory(t.id)}}},[i("a",[e._v("移除")])])],1)})),e._v(" "),i("div",{staticClass:"question-type-category-display-cell",class:{"row-editing":e.editingRow===e.categories.length}},[i("div",{staticClass:"question-type-category-display-cell-number"})]),e._v(" "),i("div",{staticClass:"question-type-category-display-cell-sum"})],2)],2)],1),e._v(" "),i("div",{staticClass:"drawer-bottom"},[i("a-button",{on:{click:e.closeConfirm}},[e._v(e._s(e._f("trans")("site.cancel")))]),e._v(" "),i("a-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e._f("trans")("site.btn.save")))])],1)])}),[],!1,null,null,null).exports},props:{questionTypeDisplaySettings:void 0,questionTypeDisplaySettingKey:void 0,categories:void 0,scores:void 0,questionCounts:void 0,bankId:void 0,countVisible:void 0},data:function(){return{editMaskVisible:!1,drawerVisible:!1,questionTotalCounts:{single_choice:{},choice:{},essay:{},uncertain_choice:{},determine:{},fill:{},material:{}}}},computed:{totalCount:function(){var e=this;return function(t,i){return e.questionTotalCounts[i][t]?e.questionTotalCounts[i][t]:0}},chooseCount:function(){var e=this;return function(t,i){return e.countVisible?0===e.totalCount(t,i)?0:0===e.questionCounts[i].categoryCounts[t]?"":e.questionCounts[i].categoryCounts[t]:""}},sumCount:function(){var e=this;return function(t){if(!e.countVisible)return 0;var i=0;return e.categories.forEach((function(s){e.questionCounts[t].categoryCounts[s.id]&&(i+=Number(e.questionCounts[t].categoryCounts[s.id]))})),i}},sumScore:function(){var e=this;return function(t){if(!e.countVisible)return(0).toFixed(1);var i=0;return e.categories.forEach((function(s){e.questionCounts[t].categoryCounts[s.id]&&(i+=Number(e.questionCounts[t].categoryCounts[s.id]))})),(i*e.scores[t]).toFixed(1)}}},watch:{countVisible:function(e){var t=this;if(e){var i=[];this.categories.forEach((function(e){i.push(e.id)})),x.a.get("/api/item/categoryIdAndType/count",{params:{bank_id:this.bankId,category_ids:i}}).then((function(e){e.forEach((function(e){t.$set(t.questionTotalCounts[e.type],e.category_id,e.itemNum)}))}))}}},methods:{onEditDrawerSave:function(e,t,i,s){this.$emit("updateCategories",e),this.$emit("updateQuestionTypeDisplaySetting",this.questionTypeDisplaySettingKey,t),this.$emit("updateQuestionConfigs",i,s)}}},X=Object(D.a)(H,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"question-type-category-display",on:{mouseover:function(t){e.editMaskVisible=!0},mouseleave:function(t){e.editMaskVisible=!1}}},[i("div",{staticClass:"question-type-category-display-header"},[i("div",{staticClass:"question-type-category-display-header-top"},[e._v("分类")]),e._v(" "),e._l(e.categories,(function(t){return i("div",{staticClass:"question-type-category-display-header-normal"},[i("div",{staticClass:"question-type-category-display-header-normal-level"},[e._v(e._s(t.level))]),e._v(" "),i("span",{staticClass:"category-name"},[e._v(e._s(t.name))])])})),e._v(" "),e._m(0)],2),e._v(" "),e._l(e.questionTypeDisplaySettings[e.questionTypeDisplaySettingKey],(function(t){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.checked,expression:"type.checked"}],staticClass:"question-type-category-display-header-type"},[i("div",{staticClass:"question-type-category-display-header-top"},[i("div",{staticClass:"question-type-category-display-header-top-content"},[e._v(e._s(t.name))])]),e._v(" "),e._l(e.categories,(function(s){return i("div",{staticClass:"question-type-category-display-cell",class:{"question-type-category-display-cell-inactive":e.countVisible&&0===e.totalCount(s.id,t.type)}},[i("span",{staticClass:"question-type-category-display-cell-number"},[e._v(e._s(e.chooseCount(s.id,t.type)))])])})),e._v(" "),i("div",{staticClass:"question-type-category-display-cell-sum"},[e._v(e._s(e.sumCount(t.type))+"/"+e._s(e.sumScore(t.type)))])],2)})),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.editMaskVisible,expression:"editMaskVisible"}],staticClass:"edit-mask-container"},[i("a-button",{on:{click:function(t){e.drawerVisible=!0}}},[e._v("编辑")])],1),e._v(" "),i("question-type-category-edit-drawer",{attrs:{"drawer-visible":e.drawerVisible,"bank-id":e.bankId,"default-categories":e.categories,"default-question-type-display-settings":e.questionTypeDisplaySettings,"question-type-display-setting-key":e.questionTypeDisplaySettingKey,"default-scores":e.scores,"default-question-counts":e.questionCounts},on:{close:function(t){e.drawerVisible=!1},save:e.onEditDrawerSave}})],2)}),[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"question-type-category-display-header-bottom"},[i("span",{staticClass:"question-type-category-display-header-bottom-title"},[e._v("合计")]),e._v(" "),i("span",{staticClass:"question-type-category-display-header-bottom-description"},[e._v("（题数/总分）")])])}],!1,null,null,null).exports,Z=i(82);function ee(){ee=function(){return t};var e,t={},i=Object.prototype,s=i.hasOwnProperty,a=g.a||function(e,t,i){e[t]=i.value},r="function"==typeof y.a?y.a:{},u=r.iterator||"@@iterator",p=r.asyncIterator||"@@asyncIterator",h=r.toStringTag||"@@toStringTag";function f(e,t,i){return g()(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,i){return e[t]=i}}function m(e,t,i,s){var n=t&&t.prototype instanceof w?t:w,o=d()(n.prototype),r=new L(s||[]);return a(o,"_invoke",{value:I(e,i,r)}),o}function v(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}t.wrap=m;var C="suspendedStart",b="executing",_="completed",q={};function w(){}function k(){}function x(){}var S={};f(S,u,(function(){return this}));var T=l.a,E=T&&T(T($([])));E&&E!==i&&s.call(E,u)&&(S=E);var D=x.prototype=w.prototype=d()(S);function P(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function F(e,t){function i(n,a,o,r){var u=v(e[n],e,a);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==c()(p)&&s.call(p,"__await")?t.resolve(p.__await).then((function(e){i("next",e,o,r)}),(function(e){i("throw",e,o,r)})):t.resolve(p).then((function(e){l.value=e,o(l)}),(function(e){return i("throw",e,o,r)}))}r(u.arg)}var n;a(this,"_invoke",{value:function(e,s){function a(){return new t((function(t,n){i(e,s,t,n)}))}return n=n?n.then(a,a):a()}})}function I(t,i,s){var n=C;return function(a,o){if(n===b)throw Error("Generator is already running");if(n===_){if("throw"===a)throw o;return{value:e,done:!0}}for(s.method=a,s.arg=o;;){var r=s.delegate;if(r){var c=N(r,s);if(c){if(c===q)continue;return c}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(n===C)throw n=_,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);n=b;var u=v(t,i,s);if("normal"===u.type){if(n=s.done?_:"suspendedYield",u.arg===q)continue;return{value:u.arg,done:s.done}}"throw"===u.type&&(n=_,s.method="throw",s.arg=u.arg)}}}function N(t,i){var s=i.method,n=t.iterator[s];if(n===e)return i.delegate=null,"throw"===s&&t.iterator.return&&(i.method="return",i.arg=e,N(t,i),"throw"===i.method)||"return"!==s&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+s+"' method")),q;var a=v(n,t.iterator,i.arg);if("throw"===a.type)return i.method="throw",i.arg=a.arg,i.delegate=null,q;var o=a.arg;return o?o.done?(i[t.resultName]=o.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,q):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,q)}function V(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function Q(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(V,this),this.reset(!0)}function $(t){if(t||""===t){var i=t[u];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function i(){for(;++n<t.length;)if(s.call(t,n))return i.value=t[n],i.done=!1,i;return i.value=e,i.done=!0,i};return a.next=a}}throw new TypeError(c()(t)+" is not iterable")}return k.prototype=x,a(D,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:k,configurable:!0}),k.displayName=f(x,h,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return o.a?o()(e,x):(e.__proto__=x,f(e,h,"GeneratorFunction")),e.prototype=d()(D),e},t.awrap=function(e){return{__await:e}},P(F.prototype),f(F.prototype,p,(function(){return this})),t.AsyncIterator=F,t.async=function(e,i,s,a,o){void 0===o&&(o=n.a);var r=new F(m(e,i,s,a),o);return t.isGeneratorFunction(i)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},P(D),f(D,h,"Generator"),f(D,u,(function(){return this})),f(D,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),i=[];for(var s in t)i.push(s);return i.reverse(),function e(){for(;i.length;){var s=i.pop();if(s in t)return e.value=s,e.done=!1,e}return e.done=!0,e}},t.values=$,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(Q),!t)for(var i in this)"t"===i.charAt(0)&&s.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function n(s,n){return r.type="throw",r.arg=t,i.next=s,n&&(i.method="next",i.arg=e),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],r=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=s.call(o,"catchLoc"),u=s.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,q):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),q},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),Q(i),q}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var s=i.completion;if("throw"===s.type){var n=s.arg;Q(i)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,i,s){return this.delegate={iterator:$(t),resultName:i,nextLoc:s},"next"===this.method&&(this.arg=e),q}},t}var te={components:{TestPaperSaveHeader:P,QuestionTypeDisplaySetMenu:L,QuestionCategorySelectDrawer:J,QuestionTypeCategoryDisplay:X},props:{itemBankId:null,id:null},data:function(){return{bankId:document.getElementById("itemBankId").value,descriptionEditorVisible:!1,descriptionEditor:void 0,CKEditorConfig:{publicPath:document.getElementById("ckeditor_path").value,jqueryPath:document.getElementById("jquery_path").value,filebrowserImageUploadUrl:document.getElementById("ckeditor_image_upload_url").value,filebrowserImageDownloadUrl:document.getElementById("ckeditor_image_download_url").value,language:"zh_CN"===document.documentElement.lang?"zh-cn":document.documentElement.lang},difficultyVisible:!1,questionTypeDisplaySettings:{questionType:this.getDefaultQuestionTypeDisplaySetting(),questionTypeCategory:this.getDefaultQuestionTypeDisplaySetting()},questionCounts:{single_choice:{choose:0,total:0},choice:{choose:0,total:0},essay:{choose:0,total:0},uncertain_choice:{choose:0,total:0},determine:{choose:0,total:0},fill:{choose:0,total:0},material:{choose:0,total:0}},scores:{questionType:{single_choice:2,choice:2,essay:2,uncertain_choice:2,determine:2,fill:2,material:2},questionTypeCategory:{single_choice:2,choice:2,essay:2,uncertain_choice:2,determine:2,fill:2,material:2}},selectedQuestionCategories:[],difficultyScales:{simple:{text:"简单",scale:30,totalCount:0,chooseCount:0},normal:{text:"一般",scale:40,totalCount:0,chooseCount:0},difficulty:{text:"困难",scale:30,totalCount:0,chooseCount:0}},form:this.$form.createForm(this,{name:"save-test-paper"}),testPaperFormState:{name:this.$route.query.name||"",description:"",type:this.$route.query.type||"random",itemBankId:null,num:20,generateType:"questionType",questionCategoryCounts:[],scores:{},percentages:{simple:"",normal:"",difficulty:""},wrongQuestionRate:"0"},fetching:!1,editingRow:null,questionCountVisible:!1}},computed:{sumScore:function(){var e=this;return function(t){return(e.questionCounts[t].choose*e.scores.questionType[t]).toFixed(1)}},paperQuestionCount:function(){var e=this,t=0;return this.questionTypeDisplaySettings[this.testPaperFormState.generateType].forEach((function(i){i.checked&&("questionType"===e.testPaperFormState.generateType?t+=Number(e.questionCounts[i.type].choose):e.questionCounts[i.type].categoryCounts&&e.selectedQuestionCategories.forEach((function(s){e.questionCounts[i.type].categoryCounts[s.id]&&(t+=Number(e.questionCounts[i.type].categoryCounts[s.id]))})))})),t},paperScore:function(){var e=this,t=0;return this.questionTypeDisplaySettings[this.testPaperFormState.generateType].forEach((function(i){i.checked&&("questionType"===e.testPaperFormState.generateType?t+=Number(e.questionCounts[i.type].choose)*e.scores.questionType[i.type]:e.questionCounts[i.type].categoryCounts&&e.selectedQuestionCategories.forEach((function(s){e.questionCounts[i.type].categoryCounts[s.id]&&(t+=Number(e.questionCounts[i.type].categoryCounts[s.id])*e.scores.questionTypeCategory[i.type])})))})),t.toFixed(1)},isPersonalTestPaper:function(){return"aiPersonality"===this.testPaperFormState.type},countErrorClass:function(){var e=this;return function(t){return Number(e.questionCounts[t].choose)>e.questionCounts[t].total?"question-type-display-cell-number-total-error":""}}},mounted:function(){var e=this;this.fetchQuestionCounts(),this.$nextTick((function(){T()(e.CKEditorConfig.jqueryPath,(function(t){t&&console.log(t),T()(e.CKEditorConfig.publicPath,(function(e){e&&console.log(e)}))}))})),document.addEventListener("click",this.handleRouterSkip)},beforeDestroy:function(){document.removeEventListener("click",this.handleRouterSkip)},methods:{confirmLeave:function(e){this.$confirm({title:"确定要离开当前页面？",content:"离开后所有已编辑更改的数据将消失！",icon:"exclamation-circle",okText:"离开",cancelText:"取消",centered:!0,onOk:function(){window.location.href=e}})},handleRouterSkip:function(e){var t=e.target;if("A"===t.tagName&&t.getAttribute("href")&&t.getAttribute("data-is-link")){var i=t.getAttribute("href");e.preventDefault(),this.confirmLeave(i)}},initDescriptionEditor:function(){var e=this;this.descriptionEditor&&this.descriptionEditor.destroy(),this.descriptionEditor=CKEDITOR.replace("test-paper-description",{toolbar:"Minimal",fileSingleSizeLimit:app.fileSingleSizeLimit,filebrowserImageUploadUrl:this.CKEditorConfig.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:this.CKEditorConfig.filebrowserImageDownloadUrl,language:this.CKEditorConfig.language,startupFocus:!0}),this.descriptionEditor.setData(this.testPaperFormState.description),this.descriptionEditor.on("blur",(function(){var t=e.descriptionEditor.getData();e.testPaperFormState.description=t,e.form.setFieldsValue({description:e.testPaperFormState.description}),""!==t?e.form.validateFields(["description"],k()(ee().mark((function e(){return ee().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))):e.descriptionEditorVisible=!1}))},fetchQuestionCounts:function(){var e=this;x.a.get("/api/item/questionType/count",{params:{bank_id:this.bankId}}).then((function(t){t.forEach((function(t){e.questionCounts[t.type].total=t.itemNum}))})),x.a.get("/api/item/difficulty/count",{params:{bank_id:this.bankId}}).then((function(t){t.forEach((function(t){e.difficultyScales[t.difficulty].totalCount=t.itemNum}))}))},getDefaultQuestionTypeDisplaySetting:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return[{type:"single_choice",name:"单选题",checked:e},{type:"choice",name:"多选题",checked:e},{type:"essay",name:"问答题",checked:e},{type:"uncertain_choice",name:"不定项",checked:e},{type:"determine",name:"判断题",checked:e},{type:"fill",name:"填空题",checked:e},{type:"material",name:"材料题",checked:e}]},backConfirm:function(){var e=this;this.$confirm({title:"是否要保存更改？",icon:"exclamation-circle",okText:"保存",cancelText:"不保存",centered:!0,onOk:function(){e.saveTestPaper()},onCancel:function(){e.$router.push({name:"list"})}})},onQuestionTypeDisplaySettingUpdate:function(e,t){this.$set(this.questionTypeDisplaySettings,e,t)},onQuestionConfigsUpdate:function(e,t){var i=this;q()(e).forEach((function(s){i.scores.questionTypeCategory[s]=t[s],i.questionCounts[s].categoryCounts=e[s].choose})),this.questionCountVisible=!0},onDescriptionInputFocus:function(){this.initDescriptionEditor(),this.descriptionEditorVisible=!0},onSliderChange:function(e){this.difficultyScales.simple.scale=e[0],this.difficultyScales.normal.scale=e[1]-e[0],this.difficultyScales.difficulty.scale=100-e[1]},onQuestionCategoriesSelected:function(e){this.selectedQuestionCategories=e},saveTestPaper:function(){var e=this;this.fetching||this.form.validateFields(function(){var t=k()(ee().mark((function t(i){var s,n;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i){t.next=33;break}if(0!==e.paperQuestionCount){t.next=4;break}return e.$message.error("请至少选择 1 道题目"),t.abrupt("return");case 4:if(e.fetching=!0,e.testPaperFormState.questionCategoryCounts=[],e.testPaperFormState.itemBankId=e.itemBankId,e.testPaperFormState.num="".concat("aiPersonality"===e.testPaperFormState.type?0:e.testPaperFormState.num),"questionType"===e.testPaperFormState.generateType?(s={},e.questionTypeDisplaySettings.questionType.forEach((function(t){t.checked&&(s[t.type]=e.questionCounts[t.type].choose)})),e.testPaperFormState.questionCategoryCounts.push({categoryId:"",counts:s})):e.selectedQuestionCategories.forEach((function(t){var i={};e.questionTypeDisplaySettings.questionTypeCategory.forEach((function(s){s.checked&&(i[s.type]=e.questionCounts[s.type].categoryCounts[t.id])})),e.testPaperFormState.questionCategoryCounts.push({categoryId:t.id,counts:i})})),e.testPaperFormState.scores=e.scores[e.testPaperFormState.generateType],e.testPaperFormState.percentages={simple:"",normal:"",difficulty:""},e.difficultyVisible&&(e.testPaperFormState.percentages={simple:"".concat(e.difficultyScales.simple.scale),normal:"".concat(e.difficultyScales.normal.scale),difficulty:"".concat(e.difficultyScales.difficulty.scale)}),n="create"===e.$route.name,t.prev=13,!n){t.next=19;break}return t.next=17,Z.I.create(e.testPaperFormState);case 17:t.next=22;break;case 19:return e.testPaperFormState.id=e.id,t.next=22,Z.I.update(e.testPaperFormState);case 22:return t.next=24,e.$router.push({name:"list",query:{tab:e.isPersonalTestPaper?"ai_personality":"all"}});case 24:n?e.$message.success("创建成功"):e.$message.success("保存成功"),t.next=30;break;case 27:t.prev=27,t.t0=t.catch(13),n?e.$message.error("创建失败"):e.$message.error("保存失败");case 30:return t.prev=30,e.fetching=!1,t.finish(30);case 33:case"end":return t.stop()}}),t,null,[[13,27,30,33]])})));return function(e){return t.apply(this,arguments)}}())},handleChangeNum:function(e){var t=this;this.testPaperFormState.num=b()(e)||1,this.$nextTick((function(){t.form.setFieldsValue({num:t.testPaperFormState.num})}))},handleChangeWrongRate:function(e){var t=this;this.testPaperFormState.wrongQuestionRate=b()(e)||0,this.$nextTick((function(){t.form.setFieldsValue({wrongQuestionRate:t.testPaperFormState.wrongQuestionRate})}))},handleChangeName:function(e){this.testPaperFormState.name=e.target.value,this.form.setFieldsValue({name:e})},onInputCountBlur:function(e){this.editingRow=null,""===this.questionCounts[e].choose&&(this.questionCounts[e].choose=0),this.questionCounts[e].choose=b()(this.questionCounts[e].choose),this.questionCounts[e].choose>this.questionCounts[e].total&&(this.questionCounts[e].choose=this.questionCounts[e].total)},onInputScoreBlur:function(e){if(this.editingRow=null,""===this.scores.questionType[e])this.scores.questionType[e]=2;else{var t=Number(this.scores.questionType[e]);t=t<=0?2:t,v()(t)||(t=t.toFixed(1)),this.scores.questionType[e]=t}}},beforeMount:function(){var e=this;return k()(ee().mark((function t(){var i,s,n,a,o,r,c;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("update"!==e.$route.name){t.next=12;break}return t.next=3,Z.I.get(e.id);case 3:s=t.sent,e.testPaperFormState.name=s.name,e.testPaperFormState.type=s.type,e.testPaperFormState.description=s.description,e.testPaperFormState.itemBankId=s.bank_id,i=s.assessmentGenerateRule,e.testPaperFormState.description&&e.onDescriptionInputFocus(),t.next=16;break;case 12:return t.next=14,x.a.get("/api/item_bank/".concat(e.bankId,"/assessment_generate_template/").concat(e.testPaperFormState.type));case 14:(n=t.sent).id&&(i=n);case 16:if(!i){t.next=36;break}if(e.testPaperFormState.num=i.num,e.testPaperFormState.generateType=i.type,e.testPaperFormState.wrongQuestionRate=i.wrong_question_rate,a=q()(i.question_setting.questionCategoryCounts[0].counts),(o=e.getDefaultQuestionTypeDisplaySetting(!1)).forEach((function(e){-1!==a.indexOf(e.type)&&(e.checked=!0)})),e.questionTypeDisplaySettings[e.testPaperFormState.generateType]=o,a.forEach((function(t){e.scores[e.testPaperFormState.generateType][t]=i.question_setting.scores[t]})),"questionType"!==e.testPaperFormState.generateType){t.next=29;break}a.forEach((function(t){e.questionCounts[t].choose=i.question_setting.questionCategoryCounts[0].counts[t]})),t.next=34;break;case 29:return e.questionCountVisible=!0,t.next=32,x.a.get("/api/item_bank/".concat(e.bankId,"/item_category_transform/map"));case 32:r=t.sent,i.question_setting.questionCategoryCounts.forEach((function(t){a.forEach((function(i){var s=e.questionCounts[i].categoryCounts||{};s[t.categoryId]=t.counts[i],e.$set(e.questionCounts[i],"categoryCounts",s)})),e.selectedQuestionCategories.push({id:r[t.categoryId].id,name:r[t.categoryId].name,level:{1:"一级分类",2:"二级分类",3:"三级分类"}[r[t.categoryId].depth]})}));case 34:(c=i.difficulty).simple&&c.normal&&c.difficulty&&(e.difficultyVisible=!0,e.difficultyScales.simple.scale=b()("".concat(c.simple)),e.difficultyScales.normal.scale=b()("".concat(c.normal)),e.difficultyScales.difficulty.scale=b()("".concat(c.difficulty)));case 36:case"end":return t.stop()}}),t)})))()}},ie=te,se=Object(D.a)(ie,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"test-create"},[i("test-paper-save-header",{attrs:{type:e.testPaperFormState.type,"paper-question-count":e.paperQuestionCount,"paper-score":e.paperScore},on:{"back-confirm":e.backConfirm}}),e._v(" "),i("div",{staticClass:"test-create-content"},[e.isPersonalTestPaper?i("a-alert",{attrs:{message:"个性卷 —— 个性化纠错练习，提升学员对知识的全面掌握，错题，新题优先作答，错误率较高的知识点反个性习，提升掌握度！",type:"success",closable:"","show-icon":""}},[i("template",{slot:"icon"},[i("img",{attrs:{src:"/static-dist/app/img/question-bank/testpaperAiIcon.png",alt:""}})])],2):e._e(),e._v(" "),i("a-form",{staticClass:"test-paper-save-form",attrs:{id:"test-create-form",form:e.form}},[i("div",{staticClass:"test-paper-save-form-item test-paper-save-form-item-align-flex-start"},[i("div",{staticClass:"test-paper-save-form-item-label"},[i("span",{staticClass:"test-paper-save-form-item-label-required"},[e._v("*")]),e._v(" "),i("span",{staticClass:"test-paper-save-form-item-label-text"},[e._v("试卷名称")])]),e._v(" "),i("a-form-item",[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:e.testPaperFormState.name,rules:[{required:!0,message:"请输入试卷名称"}]}],expression:"[\n                'name',\n                { initialValue: testPaperFormState.name, rules: [{ required: true, message: '请输入试卷名称' }] },\n              ]"}],attrs:{placeholder:"请输入试卷名称",maxLength:50},on:{change:e.handleChangeName}}),e._v(" "),i("span",{staticClass:"max-num"},[e._v(e._s(e.testPaperFormState.name?e.testPaperFormState.name.length:0)+"/50")])],1)],1),e._v(" "),i("div",{staticClass:"test-paper-save-form-item test-paper-save-form-item-align-flex-start"},[i("div",{staticClass:"test-paper-save-form-item-label"},[i("span",{staticClass:"test-paper-save-form-item-label-text"},[e._v("试卷说明")])]),e._v(" "),i("a-form-item",[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{initialValue:"",rules:[{required:!1,max:500,message:"超出 500  个字符长度限制"}]}],expression:"[\n                'description',\n                { initialValue: '', rules: [{ required: false, max: 500, message: '超出 500  个字符长度限制' }, ] },\n              ]"},{name:"show",rawName:"v-show",value:!e.descriptionEditorVisible,expression:"!descriptionEditorVisible"}],attrs:{placeholder:"请输入试卷说明"},on:{focus:e.onDescriptionInputFocus}}),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!e.descriptionEditorVisible,expression:"!descriptionEditorVisible"}],staticClass:"max-num"},[e._v("0/500")]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.descriptionEditorVisible,expression:"descriptionEditorVisible"}]},[i("a-textarea",{attrs:{name:"test-paper-description"}})],1)],1)],1),e._v(" "),e.isPersonalTestPaper?e._e():i("div",{staticClass:"test-paper-save-form-item test-paper-save-form-item-align-flex-start"},[i("div",{staticClass:"test-paper-save-form-item-label"},[i("span",{staticClass:"test-paper-save-form-item-label-required"},[e._v("*")]),e._v(" "),i("span",{staticClass:"test-paper-save-form-item-label-text"},[e._v("试卷份数")])]),e._v(" "),i("div",{staticClass:"test-paper-number"},[i("a-form-item",[i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["num",{initialValue:e.testPaperFormState.num,rules:[{required:!0,message:"请至少设置 1 份试卷"}]}],expression:"[\n                  'num',\n                  { initialValue: testPaperFormState.num, rules: [{ required: true, message: '请至少设置 1 份试卷' }, ] },\n                ]"}],attrs:{id:"inputNumber",min:1,max:200},on:{change:e.handleChangeNum}})],1),e._v(" "),i("span",{staticClass:"test-paper-number-text"},[e._v("≤200")]),e._v(" "),i("a-tooltip",{attrs:{overlayClassName:"test-paper-number-tips"}},[i("template",{slot:"title"},[e._v("\n                为了确保每位学生都能获得丰富多样的学习体验，并考虑到系统处理效率及资源分配的最优状态，我们精心设定了试卷生成的灵活性与合理性平衡点。目前，系统支持您创建最多200张独特的随机试卷\n              ")]),e._v(" "),i("img",{staticClass:"test-paper-number-tips-icon",attrs:{src:"/static-dist/app/img/question-bank/test-num-tips.png",alt:""}})],2)],1)]),e._v(" "),i("div",{staticClass:"extraction-method-content"},[i("div",{staticClass:"extraction-method-content-setting"},[i("div",{staticClass:"test-paper-save-form-item"},[i("div",{staticClass:"test-paper-save-form-item-label"},[i("span",{staticClass:"test-paper-save-form-item-label-text"},[e._v("抽题方式")])]),e._v(" "),i("a-radio-group",{model:{value:e.testPaperFormState.generateType,callback:function(t){e.$set(e.testPaperFormState,"generateType",t)},expression:"testPaperFormState.generateType"}},[i("a-radio",{attrs:{value:"questionType"}},[e._v("按题型抽题")]),e._v(" "),e.isPersonalTestPaper?e._e():i("a-radio",{attrs:{value:"questionTypeCategory"}},[e._v("按题型+分类抽题")])],1)],1),e._v(" "),"questionType"===e.testPaperFormState.generateType?i("question-type-display-set-menu",{attrs:{"question-type-display-settings":e.questionTypeDisplaySettings,"setting-key":e.testPaperFormState.generateType},on:{updateQuestionTypeDisplaySetting:e.onQuestionTypeDisplaySettingUpdate}}):e._e()],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"questionType"===e.testPaperFormState.generateType,expression:"testPaperFormState.generateType === 'questionType'"}],staticClass:"question-type-display"},[i("div",{staticClass:"question-type-display-header"},[i("div",{staticClass:"question-type-display-header-top"},[e._v("题型设置")]),e._v(" "),i("div",{staticClass:"question-type-display-header-normal",class:{"row-editing":"number"===e.editingRow}},[e._v("\n                题目数量\n              ")]),e._v(" "),i("div",{staticClass:"question-type-display-header-normal",class:{"row-editing":"score"===e.editingRow}},[e._v("\n                每题分值\n              ")]),e._v(" "),i("div",{staticClass:"question-type-display-header-bottom"},[i("span",{staticClass:"question-type-display-header-bottom-title"},[e._v("合计")]),e._v(" "),i("span",{staticClass:"question-type-display-header-bottom-description"},[e._v("（题数/总分）")])])]),e._v(" "),e._l(e.questionTypeDisplaySettings.questionType,(function(t){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.checked,expression:"type.checked"}],staticClass:"question-type-display-col"},[i("div",{staticClass:"question-type-display-header-top"},[i("span",{staticClass:"question-type-display-header-top-text"},[e._v(e._s(t.name))])]),e._v(" "),i("div",{staticClass:"question-type-display-cell-number",class:{"row-editing":"number"===e.editingRow,"question-type-display-cell-number-disable":0===e.questionCounts[t.type].total}},[i("span",{directives:[{name:"show",rawName:"v-show",value:e.questionCounts[t.type].total>0,expression:"questionCounts[type.type].total > 0"}],staticClass:"question-type-display-cell-number-edit"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.questionCounts[t.type].choose,expression:"questionCounts[type.type].choose"}],attrs:{type:"number"},domProps:{value:e.questionCounts[t.type].choose},on:{focus:function(t){e.editingRow="number"},blur:function(i){return e.onInputCountBlur(t.type)},input:function(i){i.target.composing||e.$set(e.questionCounts[t.type],"choose",i.target.value)}}})]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:0===e.questionCounts[t.type].total,expression:"questionCounts[type.type].total === 0"}],staticClass:"question-type-display-cell-number-total"},[e._v(e._s(e.questionCounts[t.type].total))]),e._v(" "),i("span",{staticClass:"question-type-display-cell-number-total",class:e.countErrorClass(t.type)},[e._v("/"+e._s(e.questionCounts[t.type].total))])]),e._v(" "),i("div",{staticClass:"question-type-display-cell-score",class:{"row-editing":"score"===e.editingRow}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.scores.questionType[t.type],expression:"scores.questionType[type.type]"}],attrs:{type:"number"},domProps:{value:e.scores.questionType[t.type]},on:{focus:function(t){e.editingRow="score"},blur:function(i){return e.onInputScoreBlur(t.type)},input:function(i){i.target.composing||e.$set(e.scores.questionType,t.type,i.target.value)}}})]),e._v(" "),i("div",{staticClass:"question-type-display-cell-sum"},[e._v(e._s(e.questionCounts[t.type].choose)+" / "+e._s(e.sumScore(t.type)))])])}))],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"questionTypeCategory"===e.testPaperFormState.generateType,expression:"testPaperFormState.generateType === 'questionTypeCategory'"}],staticClass:"question-category-choose"},[i("question-category-select-drawer",{attrs:{bankId:e.bankId,"selected-categories":e.selectedQuestionCategories},on:{"save-selected-categories":e.onQuestionCategoriesSelected}}),e._v(" "),i("question-type-category-display",{directives:[{name:"show",rawName:"v-show",value:e.selectedQuestionCategories.length>0,expression:"selectedQuestionCategories.length > 0"}],attrs:{"question-type-display-settings":e.questionTypeDisplaySettings,"question-type-display-setting-key":e.testPaperFormState.generateType,categories:e.selectedQuestionCategories,scores:e.scores.questionTypeCategory,"question-counts":e.questionCounts,"bank-id":e.bankId,"count-visible":e.questionCountVisible},on:{updateCategories:e.onQuestionCategoriesSelected,updateQuestionTypeDisplaySetting:e.onQuestionTypeDisplaySettingUpdate,updateQuestionConfigs:e.onQuestionConfigsUpdate}})],1)]),e._v(" "),e.isPersonalTestPaper?i("div",{staticClass:"test-paper-save-form-item"},[i("div",{staticClass:"test-paper-save-form-item-label"},[i("span",{staticClass:"test-paper-save-form-item-label-text"},[e._v("错题比例")])]),e._v(" "),i("div",{staticClass:"test-paper-number"},[i("a-form-item",[i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["wrongQuestionRate",{initialValue:e.testPaperFormState.wrongQuestionRate,rules:[{required:!0,message:"请填写错题比例"}]}],expression:"[\n                  'wrongQuestionRate',\n                  { initialValue: testPaperFormState.wrongQuestionRate, rules: [{ required: true, message: '请填写错题比例' }, ] },\n                ]"}],attrs:{id:"inputNumber",min:0,max:100},on:{change:e.handleChangeWrongRate}})],1),e._v(" "),i("span",{staticClass:"test-paper-number-text"},[e._v("%")])],1)]):e._e(),e._v(" "),e.isPersonalTestPaper?e._e():i("div",{staticClass:"test-paper-save-form-item"},[i("div",{staticClass:"test-paper-save-form-item-label"},[i("span",{staticClass:"test-paper-save-form-item-label-text"},[e._v("难度调节")])]),e._v(" "),i("a-switch",{attrs:{"checked-children":"开启","un-checked-children":"关闭"},model:{value:e.difficultyVisible,callback:function(t){e.difficultyVisible=t},expression:"difficultyVisible"}})],1),e._v(" "),e.isPersonalTestPaper?e._e():i("div",{directives:[{name:"show",rawName:"v-show",value:e.difficultyVisible,expression:"difficultyVisible"}],staticClass:"test-paper-difficulty"},[i("div",{staticClass:"test-paper-save-form-item"},[i("div",{staticClass:"test-paper-save-form-item-label"},[i("span",{staticClass:"test-paper-save-form-item-label-text"},[e._v("试卷难度")])]),e._v(" "),i("a-slider",{staticClass:"test-paper-difficulty-slider",attrs:{range:"","default-value":[e.difficultyScales.simple.scale,e.difficultyScales.normal.scale+e.difficultyScales.difficulty.scale],tooltipVisible:!1},on:{change:e.onSliderChange}})],1),e._v(" "),i("div",{staticClass:"test-paper-difficulty-content"},[i("div",{staticClass:"test-paper-difficulty-scale"},e._l(e.difficultyScales,(function(t,s){return i("span",{staticClass:"test-paper-difficulty-scale-text"},[e._v(e._s(t.text)+" "+e._s(t.scale)+"%")])})),0),e._v(" "),i("span",{staticClass:"test-paper-difficulty-tips"},[e._v("如果某个难度的题目数不够，将会随机选择题目来补充")])])])])],1),e._v(" "),i("div",{staticClass:"test-paper-save-footer"},[i("button",{staticClass:"test-paper-save",on:{click:e.saveTestPaper}},[e._v(e._s("create"===e.$route.name?"创建":"保存"))]),e._v(" "),i("button",{staticClass:"test-create-cancel",on:{click:e.backConfirm}},[e._v("取消")])])],1)}),[],!1,null,null,null);t.default=se.exports}}]);