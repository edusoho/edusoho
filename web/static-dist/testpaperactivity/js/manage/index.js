!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/static-dist/",n(n.s=32)}([function(t,e,n){t.exports=!n(6)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(4),i=n(2),o=n(13),a=n(15),s=n(21),c=function(t,e,n){var l,u,d,p=t&c.F,f=t&c.G,m=t&c.S,h=t&c.P,v=t&c.B,g=t&c.W,y=f?i:i[e]||(i[e]={}),$=y.prototype,w=f?r:m?r[e]:(r[e]||{}).prototype;for(l in f&&(n=e),n)(u=!p&&w&&void 0!==w[l])&&s(y,l)||(d=u?w[l]:n[l],y[l]=f&&"function"!=typeof w[l]?n[l]:v&&u?o(d,r):g&&w[l]==d?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(d):h&&"function"==typeof d?o(Function.call,d):d,h&&((y.virtual||(y.virtual={}))[l]=d,t&c.R&&$&&!$[l]&&a($,l,d)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e){var n=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(t,e,n){t.exports=n(11)},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(16),i=n(17),o=n(19),a=Object.defineProperty;e.f=n(0)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){var r=n(25);function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(t,i.key,i)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}},function(t,e,n){n(12),t.exports=n(2).parseInt},function(t,e,n){var r=n(1),i=n(22);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var r=n(14);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(7),i=n(20);t.exports=n(0)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(5);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(0)&&!n(6)((function(){return 7!=Object.defineProperty(n(18)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(5),i=n(4).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(5);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(4).parseInt,i=n(23).trim,o=n(8),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},function(t,e,n){var r=n(1),i=n(24),o=n(6),a=n(8),s="["+a+"]",c=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),u=function(t,e,n){var i={},s=o((function(){return!!a[t]()||"​"!="​"[t]()})),c=i[t]=s?e(d):a[t];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},d=u.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(l,"")),t};t.exports=u},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){t.exports=n(26)},function(t,e,n){n(27);var r=n(2).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){var r=n(1);r(r.S+r.F*!n(0),"Object",{defineProperty:n(7).f})},function(t,e,n){t.exports=n(30)},,function(t,e,n){n(31),t.exports=n(2).Date.now},function(t,e,n){var r=n(1);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";n.r(e);var r=n(28),i=n.n(r),o=n(3),a=n.n(o),s=n(9),c=n.n(s),l=n(10),u=n.n(l);new(function(){function t(e){c()(this,t),this.$element=e,this.$form=this.$element.find("#step2-form"),this.$questionBankSelector=this.$element.find("#question-bank"),this.$testpaperSelector=this.$element.find("#testpaper-media"),this.$questionItemShow=this.$element.find("#questionItemShowDiv"),this.$scoreItem=this.$element.find(".js-score-form-group"),this._init()}return u()(t,[{key:"_init",value:function(){var t=this;Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%24==0?24:this.getHours()%24,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(t)&&(t=t.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+{0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"}[this.getDay()+""])),e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},this.setValidateRule(),this.initQuestionBankSelector(),this.initTestPaperSelector(),this.initSelectTestPaper(this.$testpaperSelector.select2("data")),this.initEvent(),this.initStepForm2(),this.initAddComment(),window.ltc.on("getActivity",(function(e){window.ltc.emit("returnActivity",{valid:t.validator.form(),data:window.ltc.getFormSerializeObject($("#step2-form"))})})),window.ltc.on("getValidate",(function(e){window.ltc.emit("returnValidate",{valid:t.validator.form(),context:{score:t.$testpaperSelector.select2("data").score}}),window.ltc.emit("returnValidate",{valid:t.validator.form()})}))}},{key:"setValidateRule",value:function(){$.validator.addMethod("arithmeticFloat",(function(t,e){return this.optional(e)||/^[0-9]+(\.[0-9]?)?$/.test(t)}),$.validator.format(Translator.trans("activity.testpaper_manage.arithmetic_float_error_hint")))}},{key:"initEvent",value:function(){var t=this;this.$element.find("#question-bank").on("change",(function(e){return t.changeQuestionBank(e)})),this.$element.find("#testpaper-media").on("change",(function(e){return t.changeTestPaper(e)})),this.$element.find("input[name=doTimes]").on("change",(function(e){return t.showRedoInterval(e)})),this.$element.find('input[name="testMode"]').on("change",(function(e){return t.startTimeCheck(e)}))}},{key:"initAddComment",value:function(){var t=$("#customCommentTable"),e=t.find("tr").length;$("#addComment").on("click",(function(){var n='<tr>\n              <td class="form-inline">\n                <input type="text" class="form-control" name="start['+e+']" style="width: 47px;"> -\n                <input type="text" class="form-control" name="end['+e+']" style="width: 47px;">\n              </td>\n              <td class="form-inline">\n                <textarea name="comment['+e+']" rows="1" class="form-control js-comment-content" style="width: 339px;margin-right: 15px;"></textarea>\n                <div class="default-comment">\n                  <a href="javascript:;" class="js-default-comment">'+Translator.trans("activity.testpaper_manage.default_comment")+'</a>\n                   <div class="default-comment-list hidden">                   <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment1")+'</div>                    <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment2")+'</div>                    <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment3")+'</div>                    <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment4")+'</div>                    <div class="default-comment-list__item js-default-comment-item">'+Translator.trans("activity.testpaper_manage.default_comment5")+'</div>                  </div>                </div>\n              </td>\n              <td class="form-inline vertical-middle">\n                <a href="javascript:;" class="js-comment-remove">'+Translator.trans("activity.testpaper_manage.comment_remove")+"</a>\n              </td>\n            </tr>";t.append(n),t.removeClass("hidden"),e++})),t.on("input",".js-comment-content",(function(t){var e=t.target.scrollHeight-12;$(this).height(e)})),t.on("click",".js-comment-remove",(function(){$(this).parent().parent().remove()})),t.on("click",".js-default-comment-item",(function(){$(this).parent().parent().siblings(".js-comment-content").val($(this).text())}))}},{key:"initStepForm2",value:function(){this.validator=this.$form.validate({onkeyup:!1,rules:{title:{required:!0,trim:!0,maxlength:50,course_title:!0},testpaperId:{required:!0,digits:!0,min:1},length:{required:!0,digits:!0},startTime:{required:function(){return 1==$('[name="doTimes"]:checked').val()&&"realTime"==$('[name="testMode"]:checked').val()},DateAndTime:function(){return 1==$('[name="doTimes"]:checked').val()&&"realTime"==$('[name="testMode"]:checked').val()}},redoInterval:{required:function(){return 0==$('[name="doTimes"]:checked').val()},arithmeticFloat:!0,max:1e9}},messages:{testpaperId:{required:Translator.trans("activity.testpaper_manage.media_error_hint"),min:Translator.trans("activity.testpaper_manage.media_error_hint")},redoInterval:{max:Translator.trans("activity.testpaper_manage.max_error_hint")}}})}},{key:"initSelectTestPaper",value:function(t){var e=a()(t.id);e?(this.getItemsTable(this.$testpaperSelector.data("getTestpaperItems"),e),$('input[name="title"]').val()||$('input[name="title"]').val(t.text),this.initScoreSlider()):($("#questionItemShowDiv").hide(),$("#js-test-and-comment").hide())}},{key:"initEmptyTestPaperSelector",value:function(){this.$testpaperSelector.select2({data:[{id:"0",text:Translator.trans("activity.testpaper_manage.media_required"),selected:!0}]})}},{key:"initAjaxTestPaperSelector",value:function(){this.$testpaperSelector.select2({ajax:{url:this.$testpaperSelector.data("url"),dataType:"json",quietMillis:250,data:function(t,e){return{keyword:t,page:e}},results:function(t,e){var n=[];return $.each(t.testPapers,(function(t,e){n.push({id:e.id,text:e.name,score:e.score})})),{results:n,more:10*e<t.openCount}}},initSelection:function(t,e){var n=$("#testPaperName").val(),r=t.val(),i=$("#score-condition").data("score");a()(r)||(n=""),e({id:r,text:n||Translator.trans("activity.testpaper_manage.media_required"),score:i})},formatSelection:function(t){return t.text},dropdownAutoWidth:!0}),this.$testpaperSelector.removeClass("hidden")}},{key:"initQuestionBankSelector",value:function(){this.$questionBankSelector.select2({treeview:!0,dropdownAutoWidth:!0,treeviewInitState:"collapsed",placeholderOption:"first",formatResult:function(t){var e=(t.text+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />");return t.id?'<div class="select2-result-text"><span class="select2-match"></span><span><i class="es-icon es-icon-tiku"></i>'.concat(e,"</span></div>"):e},dropdownCss:{width:""}})}},{key:"initTestPaperSelector",value:function(){$("#testPaperName").val()?this.initAjaxTestPaperSelector():this.initEmptyTestPaperSelector()}},{key:"changeQuestionBank",value:function(t){var e=$(".js-help-block");e.addClass("hidden"),this.$testpaperSelector.addClass("hidden"),this.$questionItemShow.hide(),this.$scoreItem.hide(),this.$testpaperSelector.val("0");var n=this.$questionBankSelector.select2("data").id;if(a()(n)){var r=this.$questionBankSelector.data("url");r=r.replace(/[0-9]/,n);var i=this;$.post(r,(function(t){return 0===t.totalCount?(e.addClass("color-danger").removeClass("hidden").text(Translator.trans("queston_bank.testpaper.empty_tips")).show(),void i.initEmptyTestPaperSelector()):0===t.openCount?(e.removeClass("color-danger").removeClass("hidden").text(Translator.trans("queston_bank.testpaper.no_open_tips")).show(),void i.initEmptyTestPaperSelector()):(i.$testpaperSelector.data("url",r),void i.initAjaxTestPaperSelector())})).error((function(t){cd.message({type:"danger",message:t.responseJson.error.message})}))}else this.initEmptyTestPaperSelector()}},{key:"changeTestPaper",value:function(t){var e=this.$testpaperSelector.select2("data");this.initSelectTestPaper(e)}},{key:"showRedoInterval",value:function(t){var e=$(t.currentTarget);$('input[name="showAnswerMode"]:checked').length&&$('input[name="showAnswerMode"]:checked').prop("checked",!1),1==e.val()?($("#lesson-redo-interval-field").closest(".form-group").hide(),$(".starttime-check-div").show(),$(".js-show-answer-mode").length>0&&$(".js-show-answer-mode").hide()):($("#lesson-redo-interval-field").closest(".form-group").show(),$(".starttime-check-div").hide(),$(".js-show-answer-mode").length>0&&$(".js-show-answer-mode").show())}},{key:"startTimeCheck",value:function(t){"realTime"==$(t.currentTarget).val()?($(".starttime-input").removeClass("hidden"),this.dateTimePicker()):$(".starttime-input").addClass("hidden")}},{key:"changeCondition",value:function(t){"score"!=$(t.currentTarget).find("option:selected").val()?$(".js-score-form-group").addClass("hidden"):$(".js-score-form-group").removeClass("hidden")}},{key:"getItemsTable",value:function(t,e){$.post(t,{testpaperId:e},(function(t){$("#questionItemShowTable").html(t),$("#questionItemShowDiv").show()}))}},{key:"dateTimePicker",value:function(){var t=this,e=new Date,n=$("#startTime");!n.is(":visible")||""!=n.val()&&"0"!=n.val()||n.val(e.Format("yyyy-MM-dd hh:mm")),n.datetimepicker({autoclose:!0,format:"yyyy-mm-dd hh:ii",language:document.documentElement.lang,minView:"hour",endDate:new Date(i()()+31536e7)}).on("show",(function(e){t.$form.height(t.$form.height()+270)})).on("hide",(function(e){t.validator.form(),t.$form.height(t.$form.height()-270)})).on("changeDate",(function(t){})),n.datetimepicker("setStartDate",e)}},{key:"initScoreSlider",value:function(){var t=0;t=this.$testpaperSelector.select2("data").score?this.$testpaperSelector.select2("data").score:$("#score-condition").data("score"),$(".js-score-total").text(t);var e=Math.round(t*$("#score-condition").data("pass"));t=a()(t);var n=document.getElementById("score-slider"),r={start:e,connect:[!0,!1],tooltips:[!0],step:1,range:{min:0,max:t}};this.scoreSlider&&this.scoreSlider.destroy(),this.scoreSlider=noUiSlider.create(n,r),n.noUiSlider.on("update",(function(e,n){var r=(100*(e[n]/t)).toFixed(0);$(".noUi-tooltip").text("".concat(r,"%")),$(".js-score-tooltip").css("left","".concat(r,"%")),$(".js-passScore").text(Math.round(r/100*t)),$("#finishData").val(r/100)}));var i=Translator.trans("activity.testpaper_manage.qualified_score_hint",{passScore:'<span class="js-passScore">'+e+"</span>"}),o='<div class="score-tooltip js-score-tooltip"><div class="tooltip top" role="tooltip" style="">\n      <div class="tooltip-arrow"></div>\n      <div class="tooltip-inner ">\n        '.concat(i,"\n      </div>\n      </div></div>");$(".noUi-handle").append(o),$(".noUi-tooltip").text("".concat((e/t*100).toFixed(0),"%")),$(".js-score-tooltip").css("left","".concat((e/t*100).toFixed(0),"%")),$("#js-test-and-comment").show()}}]),t}())($("#iframe-content"))}]);