(window.webpackJsonp=window.webpackJsonp||[]).push([[397],{108:function(e,t,s){e.exports=s(335)},1277:function(e,t,s){"use strict";s.r(t);var n=s(129),a=s.n(n),r=s(108),i=s.n(r),o=s(79),c=s.n(o),l=s(72),u=s.n(l),d=s(80),p=s.n(d),m=s(46),f=s.n(m),h=s(39),v=s.n(h),_=s(23),g=s.n(_),b=s(15),k=s.n(b),w=s(34),y=s.n(w),S=s(17),x=s.n(S),C=s(61),R=s.n(C),T=s(493),I={props:{visible:{type:Boolean,required:!0,default:!1},multiClass:{type:Object,required:!0,default:{}}},data:function(){return{form:this.$form.createForm(this,{name:"add_student"})}},methods:{handleCancel:function(){this.$emit("handle-cancel"),this.form.resetFields()},handleSubmit:function(){var e=this;return y()(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.form.validateFields((function(t,s){console.log(t),t||T.m.add({id:e.multiClass.id,userInfo:s.name,price:s.price,remark:s.remark}).then((function(t){e.$message.success("学员添加成功！",2),e.visible=!1,window.location.reload()})).catch((function(t){e.$message.warning("学员添加失败！",2)}))}));case 1:case"end":return t.stop()}}),t)})))()},validatorName:R.a.debounce(function(){var e=y()(g.a.mark((function e(t,s,n){var a,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.d.checkStudentName(this.multiClass?this.multiClass.courseId:0,{title:s});case 2:if(a=e.sent,r=a.result,i=a.message,r){e.next=8;break}return this.form.setFields({name:{value:s,errors:[new Error(i)]}}),e.abrupt("return");case 8:n();case 9:case"end":return e.stop()}}),e,this)})));return function(t,s,n){return e.apply(this,arguments)}}(),300),validatorPrice:function(e,t,s){/^[0-9]{0,8}(\.\d{0,2})?$/.test(t)?s():s(new Error(Translator.trans("validate.positive_currency.message")))},maxPrice:function(e,t,s){x()(t)>this.multiClass.course.price?s(new Error(Translator.trans("course_manage.student_create.price_max_error_hint"))):s()}}},P=s(31),M=Object(P.a)(I,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-modal",{attrs:{title:"添加学员",visible:e.visible},on:{cancel:e.handleCancel}},[s("a-form",{attrs:{form:e.form,"label-col":{span:4},"wrapper-col":{span:20}}},[s("a-form-item",{attrs:{label:"学员",extra:"只能添加系统中已经注册的用户"}},[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入学员"},{validator:e.validatorName}]}],expression:"['name', { rules: [\n          { required: true, message: '请输入学员' },\n          { validator: validatorName }\n        ]}]"}],attrs:{placeholder:"邮箱／手机／用户名"}})],1),e._v(" "),e.multiClass.course.price?s("a-form-item",{attrs:{label:"购买价格",extra:"本课程的价格为 "+e.multiClass.course.price+" 元"}},[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["price",{initialValue:e.multiClass.course.price,rules:[{validator:e.validatorPrice},{validator:e.maxPrice}]}],expression:"['price',\n        {\n          initialValue: multiClass.course.price,\n          rules: [\n            { validator: validatorPrice },\n            { validator: maxPrice }\n          ]\n        }]"}],attrs:{type:"text",suffix:"元"}})],1):e._e(),e._v(" "),s("a-form-item",{attrs:{label:"备注",extra:"选填"}},[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"['remark']"}]})],1)],1),e._v(" "),s("template",{slot:"footer"},[s("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n      取消\n    ")]),e._v(" "),s("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n      确认\n    ")])],1)],2)}),[],!1,null,null,null).exports,H={props:{visible:{type:Boolean,required:!0,default:!1}},methods:{handleCancel:function(){this.$emit("handle-cancel")}}},$=Object(P.a)(H,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-modal",{attrs:{title:"学员信息",visible:e.visible,footer:null},on:{cancel:e.handleCancel}},[s("a-descriptions",{attrs:{bordered:"",column:1}},[s("a-descriptions-item",{attrs:{label:"用户名"}},[e._v("\n      Zhou Maomao\n    ")]),e._v(" "),s("a-descriptions-item",{attrs:{label:"Email"}},[e._v("\n      1810000000\n    ")]),e._v(" "),s("a-descriptions-item",{attrs:{label:"用户组"}},[e._v("\n      Hangzhou, Zhejiang\n    ")]),e._v(" "),s("a-descriptions-item",{attrs:{label:"用户名"}},[e._v("\n      Zhou Maomao\n    ")]),e._v(" "),s("a-descriptions-item",{attrs:{label:"Email"}},[e._v("\n      1810000000\n    ")]),e._v(" "),s("a-descriptions-item",{attrs:{label:"用户组"}},[e._v("\n      Hangzhou, Zhejiang\n    ")]),e._v(" "),s("a-descriptions-item",{attrs:{label:"Address"}},[e._v("\n      No. 18, Wantang Road, Xihu District, Hangzhou, Zhejiang, China\n    ")]),e._v(" "),s("a-descriptions-item",{attrs:{label:"Remark"}},[e._v("\n      empty\n    ")])],1)],1)}),[],!1,null,null,null).exports,j={props:{visible:{type:Boolean,required:!0,default:!1},multiClass:{type:Object,required:!0,default:{}},selectedStudentIds:{type:Array,required:!0,default:{}},multiClassId:{required:!0,default:0}},data:function(){return{form:this.$form.createForm(this),assistant:{list:[],title:"",initialValue:[]}}},created:function(){this.fetchAssistants()},methods:{fetchAssistants:function(){var e=this,t=this.assistant.title,s={id:this.multiClassId};t&&(s.nickname=t),T.j.search(s).then((function(t){e.assistant.list=R.a.concat(e.assistant.list,t)}))},handleSearchAssistant:R.a.debounce((function(e){this.assistant={list:[],title:e},this.fetchAssistants()}),200),handleCancel:function(){this.$emit("handle-cancel"),this.form.resetFields()},handleSubmit:function(){var e=this;return y()(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.form.validateFields((function(t,s){console.log(t),t||T.a.add({assistantId:s.assistantId,multiClassId:e.multiClass.id,studentIds:e.selectedStudentIds}).then((function(t){e.$message.success("助教修改成功！",2),e.$emit("handle-cancel"),window.location.reload()})).catch((function(t){e.$message.warning("助教修改失败",2)}))}));case 1:case"end":return t.stop()}}),t)})))()}}},O=Object(P.a)(j,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-modal",{attrs:{title:"批量修改助教",visible:e.visible},on:{cancel:e.handleCancel}},[s("a-form",{attrs:{form:e.form,"label-col":{span:4},"wrapper-col":{span:20}}},[s("a-form-item",{attrs:{label:"选择助教"}},[s("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["assistantId",{initialValue:e.assistant.initialValue,rules:[{required:!0,message:"请选择助教"}]}],expression:"['assistantId', {\n          initialValue: assistant.initialValue,\n          rules: [\n            { required: true, message: '请选择助教' }\n          ]\n        }]"}],attrs:{"show-search":"","filter-option":!1,placeholder:"请选择助教"},on:{search:e.handleSearchAssistant}},e._l(e.assistant.list,(function(t){return s("a-select-option",{key:t.id},[e._v("\n          "+e._s(t.nickname)+"\n        ")])})),1)],1)],1),e._v(" "),s("template",{slot:"footer"},[s("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n      取消\n    ")]),e._v(" "),s("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n      确认\n    ")])],1)],2)}),[],!1,null,null,null).exports,V=s(1306);function z(e,t){var s=f()(e);if(p.a){var n=p()(e);t&&(n=n.filter((function(t){return u()(e,t).enumerable}))),s.push.apply(s,n)}return s}function E(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?z(Object(s),!0).forEach((function(t){v()(e,t,s[t])})):c.a?i()(e,c()(s)):z(Object(s)).forEach((function(t){a()(e,t,u()(s,t))}))}return e}var F=[{title:"学员",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"手机号",dataIndex:"phone",scopedSlots:{customRender:"phone"}},{title:"学习进度",dataIndex:"learningProgressPercent",scopedSlots:{customRender:"learningProgressPercent"}},{title:"助教老师",dataIndex:"assistant",width:"10%",ellipsis:!0,scopedSlots:{customRender:"assistant"}},{title:"提问",dataIndex:"threadCount",scopedSlots:{customRender:"threadCount"}},{title:"作业提交",dataIndex:"finishedHomeworkCount",scopedSlots:{customRender:"finishedHomeworkCount"}},{title:"试卷提交",dataIndex:"finishedTestpaperCount",scopedSlots:{customRender:"finishedTestpaperCount"}},{title:"有效期",dataIndex:"deadline",scopedSlots:{customRender:"deadline"}},{title:"报名时间",dataIndex:"createdTime",scopedSlots:{customRender:"createdTime"}},{title:"操作",dataIndex:"actions",scopedSlots:{customRender:"actions"}}],Y=[{title:"课时",dataIndex:"activity",scopedSlots:{customRender:"lesson"},width:"15%",ellipsis:!0},{title:"作业/考试",dataIndex:"answerScene",scopedSlots:{customRender:"exam"},width:"15%",ellipsis:!0},{title:"提交时间",dataIndex:"end_time",scopedSlots:{customRender:"end_time"}},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"批阅人",dataIndex:"teacherInfo",scopedSlots:{customRender:"teacherInfo"}},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}],K={all:{total:0,offset:0,pageSize:5},reviewing:{total:0,offset:0,pageSize:5},doing:{total:0,offset:0,pageSize:5},finished:{total:0,offset:0,pageSize:5}},U={components:{AddStudentModal:M,StudentInfoModal:$,AssistantListModal:O,userInfoTable:V.a},data:function(){return{resultColumns:Y,students:[],modalShowUser:{},selectedUser:{},multiClass:{course:{id:0}},columns:F,selectedRowKeys:[],selectedRowKeysStr:"",selectedUserIds:[],loading:!1,addStudentVisible:!1,viewStudentInfoVisible:!1,assistantListModalVisible:!1,selectedStudentIds:[],id:this.$route.params.id,getListLoading:!1,keyword:"",paging:{total:0,offset:0,pageSize:10},testpaperPaging:K,homeworkPaging:K,status:["all","reviewing","doing","finished"],statusMap:{doing:"进行中",paused:"暂停",reviewing:"未批阅",finished:"已批阅"},gradeMap:{excellent:"优秀",good:"良好",passed:"合格",unpassed:"不合格"},homeworkResultList:{type:Object,required:!0,default:{}},testpaperResultList:{type:Object,required:!0,default:{}},currentHomeworkTab:0,currentTestpaperTab:0,homeworkModalVisible:!1,testpaperModalVisible:!1}},computed:{hasSelected:function(){return this.selectedRowKeys.length>0},testpaperResults:function(){var e=this.status[this.currentTestpaperTab];return this.testpaperResultList[e]},homeworkResults:function(){var e=this.status[this.currentHomeworkTab];return this.homeworkResultList[e]}},watch:{currentTestpaperTab:function(e){this.getTestpaperResults(e)},currentHomeworkTab:function(e){this.getHomeworkResults(e)}},created:function(){this.getMultiClassStudents(),this.getMultiClass()},befeoreRouteUpdate:function(e,t,s){this.id=e.params.id,s()},methods:{onHomeworkModalCancel:function(){this.homeworkModalVisible=!1,this.currentHomeworkTab=0,this.homeworkPaging=K,this.homeworkResultList={}},onTestpaperModalCancel:function(){this.testpaperModalVisible=!1,this.currentTestpaperTab=0,this.testpaperPaging=K,this.testpaperResultList={}},getMultiClassStudents:function(){var e=arguments,t=this;return y()(g.a.mark((function s(){var n,a,r,i;return g.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},s.next=3,T.m.search({id:t.id,keyword:n.keyword||t.keyword||"",offset:n.offset||t.paging.offset||0,limit:n.limit||t.paging.pageSize||10});case 3:a=s.sent,r=a.data,i=a.paging,t.students=r,i.page=i.offset/i.limit+1,t.paging=k()(t.paging,i);case 9:case"end":return s.stop()}}),s)})))()},handleTestpaperTableChange:function(e){var t=this.status[this.currentTestpaperTab],s=E({},this.testpaperPaging[t]);s.current=e.current,s.offset=(e.current-1)*e.pageSize,this.testpaperPaging[t]=s;var n={limit:e.pageSize,offset:(e.current-1)*e.pageSize};this.getTestpaperResults(this.currentTestpaperTab,n)},handleHomeworkTableChange:function(e){var t=this.status[this.currentHomeworkTab],s=E({},this.homeworkPaging[t]);s.current=e.current,s.offset=(e.current-1)*e.pageSize,this.homeworkPaging[t]=s;var n={limit:e.pageSize,offset:(e.current-1)*e.pageSize};console.log(this.homeworkPaging),console.log(n),this.getHomeworkResults(this.currentHomeworkTab,n)},handleStudentTableChange:function(e){var t=E({},this.paging);t.current=e.current,t.offset=(e.current-1)*e.pageSize,this.paging=t;var s={limit:e.pageSize,offset:(e.current-1)*e.pageSize};this.getMultiClassStudents(s)},getMultiClass:function(){var e=this;return y()(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.i.get(e.id).then((function(t){e.multiClass=t})).catch((function(e){}));case 2:case"end":return t.stop()}}),t)})))()},onRemoveStudent:function(e){var t=this;T.m.deleteMultiClassMember(this.multiClass.id,e).then((function(e){t.getMultiClassStudents(),t.$message.success("移除学员成功！")})).catch((function(e){t.$message.warning("移除学员失败！")}))},onSearch:function(e){this.keyword=e,this.getMultiClassStudents({keyword:e})},onClickHomeworkModal:function(e){this.isPermission("course_homework_review")&&(this.selectedUser=e,this.getHomeworkResults(),this.homeworkModalVisible=!0)},onClickTestpaperModal:function(e){this.isPermission("course_exam_review")&&(this.selectedUser=e,this.getTestpaperResults(),this.testpaperModalVisible=!0)},start:function(){var e=this;this.loading=!0,setTimeout((function(){e.loading=!1,e.selectedRowKeys=[]}),1e3)},onSelectChange:function(e){this.selectedRowKeys=e,this.getSelectedRowKeysQueryStr()},getHomeworkResults:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.status[t];T.n.searchStudentExamResults(this.$route.params.id,this.selectedUser.id,{status:n,type:"homework",offset:s.offset||this.homeworkPaging[n].offset||K[n].offset,limit:s.limit||this.homeworkPaging[n].pageSize||K[n].pageSize}).then((function(t){t.paging.page=t.paging.offset/t.paging.limit+1,e.homeworkPaging[n]=k()(e.homeworkPaging[n],t.paging),console.log(e.homeworkPaging[n]),e.$set(e.homeworkResultList,n,t)}))},getTestpaperResults:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.status[t];T.n.searchStudentExamResults(this.$route.params.id,this.selectedUser.id,{status:n,type:"testpaper",offset:s.offset||this.testpaperPaging[n].offset||K[n].offset,limit:s.limit||this.testpaperPaging[n].pageSize||K[n].pageSize}).then((function(t){t.paging.page=t.paging.offset/t.paging.limit+1,e.testpaperPaging[n]=k()(e.testpaperPaging[n],t.paging),e.$set(e.testpaperResultList,n,t)}))},addStudent:function(){this.addStudentVisible=!0},close:function(){this.viewStudentInfoVisible=!1},viewStudentInfo:function(e){var t=this;return y()(g.a.mark((function s(){return g.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,T.r.get(e.id);case 2:t.modalShowUser=s.sent,t.viewStudentInfoVisible=!0;case 5:case"end":return s.stop()}}),s)})))()},clickBatchUpdateAssistantModal:function(){0!==this.selectedRowKeys.length?(this.assistantListModalVisible=!0,this.selectedStudentIds=this.selectedUserIds):this.$message.error("请至少选中一项后修改",1)},onBatchRemoveStudent:function(){if(0!==this.selectedRowKeys.length){var e=this;this.$confirm({title:"是否移除这些学员？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){T.m.batchDeleteClassMember(e.multiClass.id,{userIds:e.selectedUserIds}).then((function(t){e.getMultiClassStudents(),e.$message.success("移除学员成功！"),e.selectedRowKeys=[]})).catch((function(t){e.$message.warning("移除学员失败！")}))},onCancel:function(){console.log("Cancel")}})}else this.$message.error("请至少选中一项后移除",1)},onSelectEmpty:function(){this.$message.error("请至少选中一项后进行修改！",1)},confirm:function(e){this.onRemoveStudent(e)},getSelectedRowKeysQueryStr:function(){var e=this,t="",s=[];this.selectedRowKeys&&this.selectedRowKeys.forEach((function(n,a){e.students.forEach((function(e,a){e.id==n&&(t="".concat(t,"&ids[]=").concat(e.user.id),s.push(e.user.id))}))})),this.selectedRowKeysStr=t,this.selectedUserIds=s}}},D=(s(1364),Object(P.a)(U,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"student-manage"},[s("div",{staticClass:"clearfix",staticStyle:{"margin-bottom":"24px"}},[s("a-input-search",{staticClass:"pull-left",staticStyle:{width:"260px"},attrs:{placeholder:"请输入姓名或手机号搜索"},on:{search:e.onSearch}}),e._v(" "),s("a-space",{staticClass:"pull-left cd-ml24",attrs:{size:"middle"}},[e.isPermission("course_member_create")?s("a-button",{attrs:{icon:"plus",type:"primary"},on:{click:function(t){return e.addStudent()}}},[e._v("\n        添加学员\n      ")]):e._e(),e._v(" "),s("a-button",{attrs:{type:"primary","data-toggle":"modal","data-target":"#modal","data-backdrop":"static","data-keyboard":"false","data-url":"/importer/course-member/index?courseId="+e.multiClass.course.id}},[s("a-space",[s("svg-icon",{attrs:{icon:"icon-import"}}),e._v("\n          批量导入\n        ")],1)],1),e._v(" "),s("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.clickBatchUpdateAssistantModal()}}},[s("a-space",[s("svg-icon",{attrs:{icon:"icon-edit"}}),e._v("\n          修改助教\n        ")],1)],1),e._v(" "),e.isPermission("course_member_delete")?s("a-button",{attrs:{type:"primary"},on:{click:e.onBatchRemoveStudent}},[s("a-space",[s("svg-icon",{attrs:{icon:"icon-remove"}}),e._v("\n          批量移除\n        ")],1)],1):e._e(),e._v(" "),0===e.selectedRowKeys.length&&e.isPermission("course_member_deadline_edit")?s("a-button",{attrs:{type:"primary"},on:{click:e.onSelectEmpty}},[s("a-space",[s("svg-icon",{attrs:{icon:"icon-edit"}}),e._v("\n          批量修改有效期\n        ")],1)],1):e._e(),e._v(" "),e.selectedRowKeys.length>0&&e.isPermission("course_member_deadline_edit")?s("a-button",{attrs:{type:"primary","data-toggle":"modal","data-target":"#modal","data-backdrop":"static","data-keyboard":"false","data-url":"/course_set/"+e.multiClass.course.courseSetId+"/manage/course/"+e.multiClass.course.id+"/student/deadline?"+e.selectedRowKeysStr}},[s("a-space",[s("svg-icon",{attrs:{icon:"icon-edit"}}),e._v("\n          批量修改有效期\n        ")],1)],1):e._e()],1),e._v(" "),s("a-space",{staticClass:"pull-right",attrs:{size:"middle"}},[e.isPermission("course_member_export")?s("a-button",{staticClass:"js-export-btn",attrs:{type:"primary",href:"javascript:;","data-try-url":"/try/export/course-students","data-url":"/export/course-students","data-pre-url":"/pre/export/course-students","data-loading-text":"正在导出...","data-target-form":"#course-students-export","data-file-names":'["course-students"]'}},[s("a-space",[s("svg-icon",{attrs:{icon:"icon-export"}}),e._v("\n          批量导出\n        ")],1)],1):e._e()],1)],1),e._v(" "),s("a-modal",{attrs:{title:"学员详细信息",visible:e.viewStudentInfoVisible},on:{cancel:e.close}},[s("userInfoTable",{attrs:{user:e.modalShowUser}}),e._v(" "),s("template",{slot:"footer"},[s("a-button",{key:"back",on:{click:e.close}},[e._v(" 关闭 ")])],1)],2),e._v(" "),s("a-table",{attrs:{"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},columns:e.columns,"row-key":function(e){return e.id},pagination:e.paging,"data-source":e.students},on:{change:e.handleStudentTableChange},scopedSlots:e._u([{key:"name",fn:function(t,n){return s("a",{on:{click:function(t){return e.viewStudentInfo(n.user)}}},[e._v(e._s(n.user.nickname)),n.user.truename?s("span",[e._v("("+e._s(n.user.truename)+")")]):e._e()])}},{key:"phone",fn:function(t,s){return[e._v(e._s(s.user.verifiedMobile||"--"))]}},{key:"learningProgressPercent",fn:function(t,n){return s("a",{attrs:{"data-toggle":"modal","data-target":"#modal","data-url":"/course_set/"+e.multiClass.course.courseSetId+"/manage/course/"+e.multiClass.course.id+"/students/"+n.user.id+"/process"}},[e._v(e._s(t)+"%")])}},{key:"assistant",fn:function(t){return[e._v(e._s(t.nickname))]}},{key:"threadCount",fn:function(t){return[e._v(e._s(t))]}},{key:"finishedHomeworkCount",fn:function(t,n){return s("a",{on:{click:function(t){return e.onClickHomeworkModal(n.user)}}},[e._v(e._s(t)+"/"+e._s(n.homeworkCount))])}},{key:"finishedTestpaperCount",fn:function(t,n){return s("a",{on:{click:function(t){return e.onClickTestpaperModal(n.user)}}},[e._v(e._s(t)+"/"+e._s(n.testpaperCount))])}},{key:"deadline",fn:function(t){return[e._v(e._s(e.$dateFormat(t,"YYYY-MM-DD HH:mm")||"--"))]}},{key:"createdTime",fn:function(t){return[e._v(e._s(e.$dateFormat(t,"YYYY-MM-DD HH:mm")||"--"))]}},{key:"actions",fn:function(t,n){return[s("a-space",{attrs:{size:"middle"}},[s("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return e.viewStudentInfo(n.user)}}},[e._v("查看")]),e._v(" "),s("a-popconfirm",{attrs:{title:"确定移除?","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(t){return e.confirm(n.user.id)}}},[e.isPermission("course_member_delete")?s("span",{staticStyle:{color:"#fe4040",cursor:"pointer"}},[e._v("移除")]):e._e()])],1)]}}])}),e._v(" "),s("assistant-list-modal",{attrs:{visible:e.assistantListModalVisible,"multi-class-id":e.id,"multi-class":e.multiClass,"selected-student-ids":e.selectedStudentIds},on:{"handle-cancel":function(t){e.assistantListModalVisible=!1}}}),e._v(" "),s("add-student-modal",{attrs:{visible:e.addStudentVisible,"multi-class":e.multiClass},on:{"handle-cancel":function(t){e.addStudentVisible=!1}}}),e._v(" "),s("form",{staticClass:"hide",attrs:{id:"course-students-export"}},[s("input",{attrs:{type:"hidden",name:"courseSetId"},domProps:{value:e.multiClass.course.courseSetId}}),e._v(" "),s("input",{attrs:{type:"hidden",name:"courseId"},domProps:{value:e.multiClass.course.id}})]),e._v(" "),s("a-modal",{attrs:{visible:e.homeworkModalVisible,footer:null,title:e.selectedUser.nickname+" - 作业",width:920},on:{cancel:e.onHomeworkModalCancel}},[s("a-tabs",{model:{value:e.currentHomeworkTab,callback:function(t){e.currentHomeworkTab=t},expression:"currentHomeworkTab"}},[s("a-tab-pane",{key:0,attrs:{tab:"全部"}}),e._v(" "),s("a-tab-pane",{key:1,attrs:{tab:"未批阅"}}),e._v(" "),s("a-tab-pane",{key:2,attrs:{tab:"进行中"}}),e._v(" "),s("a-tab-pane",{key:3,attrs:{tab:"已批阅"}})],1),e._v(" "),e.homeworkResults?s("a-table",{attrs:{columns:e.resultColumns,"data-source":e.homeworkResults.data,pagination:e.homeworkPaging[e.status[e.currentHomeworkTab]]},on:{change:e.handleHomeworkTableChange},scopedSlots:e._u([{key:"lesson",fn:function(t,s){return[e._v(e._s(t.title||"--"))]}},{key:"exam",fn:function(t,s){return[e._v(e._s(t.name||"--"))]}},{key:"teacherInfo",fn:function(t,s){return[e._v(e._s(s.teacherInfo.nickname||"--"))]}},{key:"status",fn:function(t){return[e._v("\n        "+e._s(e.statusMap[t])+"\n      ")]}},{key:"end_time",fn:function(t){return[e._v("\n        "+e._s(e.$dateFormat(t,"YYYY-MM-DD HH:mm"))+"\n      ")]}},{key:"action",fn:function(t,n){return["reviewing"===n.status?s("a",{attrs:{href:"testpaper"===n.activity.mediaType?"/course/"+e.multiClass.course.id+"/manage/testpaper/"+n.id+"/check?action=check":"/course/"+e.multiClass.course.id+"/manage/homework/"+n.id+"/check?action=check",target:"_blank"}},[e._v("去批阅")]):"finished"===n.status?s("a",{attrs:{href:"/testpaper/result/"+n.id+"/show?action=check",target:"_blank"}},[e._v("查看结果")]):["doing","paused"].includes(n.status)?s("span",[e._v("--")]):e._e()]}}],null,!1,4202466841)}):e._e()],1),e._v(" "),s("a-modal",{attrs:{visible:e.testpaperModalVisible,footer:null,title:e.selectedUser.nickname+" - 试卷",width:920},on:{cancel:e.onTestpaperModalCancel}},[s("a-tabs",{model:{value:e.currentTestpaperTab,callback:function(t){e.currentTestpaperTab=t},expression:"currentTestpaperTab"}},[s("a-tab-pane",{key:0,attrs:{tab:"全部"}}),e._v(" "),s("a-tab-pane",{key:1,attrs:{tab:"未批阅"}}),e._v(" "),s("a-tab-pane",{key:2,attrs:{tab:"进行中"}}),e._v(" "),s("a-tab-pane",{key:3,attrs:{tab:"已批阅"}})],1),e._v(" "),e.testpaperResults?s("a-table",{attrs:{columns:e.resultColumns,"data-source":e.testpaperResults.data,pagination:e.testpaperPaging[e.status[e.currentTestpaperTab]]},on:{change:e.handleTestpaperTableChange},scopedSlots:e._u([{key:"lesson",fn:function(t,s){return[e._v(e._s(t.title||"--"))]}},{key:"exam",fn:function(t,s){return[e._v(e._s(t.name||"--"))]}},{key:"teacherInfo",fn:function(t,s){return[e._v(e._s(s.teacherInfo.nickname||"--"))]}},{key:"status",fn:function(t){return[e._v("\n        "+e._s(e.statusMap[t])+"\n      ")]}},{key:"end_time",fn:function(t){return[e._v("\n        "+e._s(e.$dateFormat(t,"YYYY-MM-DD HH:mm"))+"\n      ")]}},{key:"action",fn:function(t,n){return["reviewing"===n.status?s("a",{attrs:{href:"/course/"+e.multiClass.course.id+"/manage/testpaper/"+n.id+"/check?action=check",target:"_blank"}},[e._v("去批阅")]):"finished"===n.status?s("a",{attrs:{href:"/testpaper/result/"+n.id+"/show?action=check",target:"_blank"}},[e._v("查看结果")]):["doing","paused"].includes(n.status)?s("span",[e._v("--")]):e._e()]}}],null,!1,3025023754)}):e._e()],1)],1)}),[],!1,null,null,null));t.default=D.exports},1306:function(e,t,s){"use strict";var n={props:{user:{type:Object,default:{}}},computed:{getUserRoles:function(){return _.join(this.user.user.roles," ")}},methods:{toPersonalHomepage:function(e){window.open("/user/"+e+"/about","_blank")},formatTimeIp:function(e,t){var s="";return s+=0!=e?this.$dateFormat(e,"YYYY-MM-DD HH:mm"):" -- ",""!=t&&(s+=" / "+t+" 本机IP"),s},formatStr:function(e){return void 0===e||""==e||null==e?"暂无":e},formatGender:function(){return{male:"男性",female:"女性",secret:"秘密"}[this.user.profile.gender]}}},a=s(31),r=Object(a.a)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",{staticClass:"table table-striped table-condenseda table-bordered"},[s("tbody",[s("tr",[s("th",{attrs:{width:"30%"}},[e._v("用户名")]),e._v(" "),s("td",{attrs:{width:"70%"}},[s("a",{staticClass:"pull-right",attrs:{href:"javascript:;"},on:{click:function(t){return e.toPersonalHomepage(e.user.user.id)}}},[e._v("个人主页")]),e._v("\n        "+e._s(e.user.user.nickname)+"\n      ")])]),e._v(" "),s("tr",[s("th",[e._v("Email")]),e._v(" "),s("td",[e._v(e._s(e.user.profile.email||"- -"))])]),e._v(" "),s("tr",[s("th",[e._v("用户组")]),e._v(" "),s("td",[e._v(e._s(e.getUserRoles))])]),e._v(" "),s("tr",[s("th",[e._v("注册时间/IP")]),e._v(" "),s("td",[e._v(e._s(e.formatTimeIp(e.user.user.createdTime,e.user.user.createdIp)))])]),e._v(" "),s("tr",[s("th",[e._v("最近登录时间/IP")]),e._v(" "),s("td",[e._v(e._s(e.formatTimeIp(e.user.user.loginTime,e.user.user.loginIp)))])]),e._v(" "),s("tr",[s("th",[e._v("姓名")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.truename)))])]),e._v(" "),s("tr",[s("th",[e._v("性别")]),e._v(" "),s("td",[e._v(e._s(e.formatGender()))])]),e._v(" "),s("tr",[s("th",[e._v("身份证号")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.idcard)))])]),e._v(" "),s("tr",[s("th",[e._v("手机号码")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.mobile)))])]),e._v(" "),s("tr",[s("th",[e._v("公司")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.company)))])]),e._v(" "),s("tr",[s("th",[e._v("职业")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.job)))])]),e._v(" "),s("tr",[s("th",[e._v("头衔")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.user.title)))])]),e._v(" "),s("tr",[s("th",[e._v("个人签名")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.signature)))])]),e._v(" "),s("tr",[s("th",[e._v("自我介绍")]),e._v(" "),s("td",{domProps:{innerHTML:e._s(e.user.profile.about||"暂无")}})]),e._v(" "),s("tr",[s("th",[e._v("个人网站")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.site)))])]),e._v(" "),s("tr",[s("th",[e._v("微博")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.weibo)))])]),e._v(" "),s("tr",[s("th",[e._v("微信")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.weixin)))])]),e._v(" "),s("tr",[s("th",[e._v("QQ")]),e._v(" "),s("td",[e._v(e._s(e.formatStr(e.user.profile.qq)))])])])])}),[],!1,null,null,null);t.a=r.exports},1328:function(e,t,s){},1364:function(e,t,s){"use strict";var n=s(1328);s.n(n).a},15:function(e,t,s){e.exports=s(494)},17:function(e,t,s){e.exports=s(583)},210:function(e,t,s){s(211);var n=s(49).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},211:function(e,t,s){var n=s(134),a=s(180).f;s(334)("getOwnPropertyDescriptor",(function(){return function(e,t){return a(n(e),t)}}))},334:function(e,t,s){var n=s(74),a=s(49),r=s(309);e.exports=function(e,t){var s=(a.Object||{})[e]||Object[e],i={};i[e]=t(s),n(n.S+n.F*r((function(){s(1)})),"Object",i)}},335:function(e,t,s){s(336);var n=s(49).Object;e.exports=function(e,t){return n.defineProperties(e,t)}},336:function(e,t,s){var n=s(74);n(n.S+n.F*!s(140),"Object",{defineProperties:s(377)})},337:function(e,t,s){s(338),e.exports=s(49).Object.getOwnPropertyDescriptors},338:function(e,t,s){var n=s(74),a=s(339),r=s(134),i=s(180),o=s(379);n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,s,n=r(e),c=i.f,l=a(n),u={},d=0;l.length>d;)void 0!==(s=c(n,t=l[d++]))&&o(u,t,s);return u}})},339:function(e,t,s){var n=s(356),a=s(341),r=s(133),i=s(102).Reflect;e.exports=i&&i.ownKeys||function(e){var t=n.f(r(e)),s=a.f;return s?t.concat(s(e)):t}},340:function(e,t,s){s(378),e.exports=s(49).Object.getOwnPropertySymbols},39:function(e,t,s){var n=s(129);e.exports=function(e,t,s){return t in e?n(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},450:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},46:function(e,t,s){e.exports=s(580)},496:function(e,t,s){var n=s(74),a=s(419),r=s(309),i=s(450),o="["+i+"]",c=RegExp("^"+o+o+"*"),l=RegExp(o+o+"*$"),u=function(e,t,s){var a={},o=r((function(){return!!i[e]()||"​"!="​"[e]()})),c=a[e]=o?t(d):i[e];s&&(a[s]=c),n(n.P+n.F*o,"String",a)},d=u.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(l,"")),e};e.exports=u},580:function(e,t,s){s(581),e.exports=s(49).Object.keys},581:function(e,t,s){var n=s(355),a=s(354);s(334)("keys",(function(){return function(e){return a(n(e))}}))},583:function(e,t,s){s(584),e.exports=s(49).parseFloat},584:function(e,t,s){var n=s(74),a=s(585);n(n.G+n.F*(parseFloat!=a),{parseFloat:a})},585:function(e,t,s){var n=s(102).parseFloat,a=s(496).trim;e.exports=1/n(s(450)+"-0")!=-1/0?function(e){var t=a(String(e),3),s=n(t);return 0===s&&"-"==t.charAt(0)?-0:s}:n},72:function(e,t,s){e.exports=s(210)},79:function(e,t,s){e.exports=s(337)},80:function(e,t,s){e.exports=s(340)}}]);