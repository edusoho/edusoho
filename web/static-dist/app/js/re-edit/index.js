/*! For license information please see index.js.LICENSE.txt */
!function(t){function e(e){for(var a,o,r=e[0],l=e[1],c=e[2],h=0,d=[];h<r.length;h++)o=r[h],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);for(u&&u(e);d.length;)d.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],a=!0,r=1;r<i.length;r++){var l=i[r];0!==s[l]&&(a=!1)}a&&(n.splice(e--,1),t=o(o.s=i[0]))}return t}var a={},s={372:0},n=[];function o(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=a,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(i,a,function(e){return t[e]}.bind(null,a));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/static-dist/";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;n.push([1510,0]),i()}({1420:function(t,e,i){i(439),i(283),i(324),i(1421),i(1427),i(1430),i(1432),t.exports=i(67).Set},1421:function(t,e,i){"use strict";var a=i(1422),s=i(646);t.exports=i(1423)("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return a.def(s(this,"Set"),t=0===t?0:t,t)}},a)},1422:function(t,e,i){"use strict";var a=i(176).f,s=i(322),n=i(434),o=i(207),r=i(433),l=i(319),c=i(451),u=i(557),h=i(546),d=i(158),m=i(453).fastKey,p=i(646),f=d?"_s":"size",y=function(t,e){var i,a=m(e);if("F"!==a)return t._i[a];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,c){var u=t((function(t,a){r(t,u,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[f]=0,null!=a&&l(a,i,t[c],t)}));return n(u.prototype,{clear:function(){for(var t=p(this,e),i=t._i,a=t._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete i[a.i];t._f=t._l=void 0,t[f]=0},delete:function(t){var i=p(this,e),a=y(i,t);if(a){var s=a.n,n=a.p;delete i._i[a.i],a.r=!0,n&&(n.n=s),s&&(s.p=n),i._f==a&&(i._f=s),i._l==a&&(i._l=n),i[f]--}return!!a},forEach:function(t){p(this,e);for(var i,a=o(t,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(a(i.v,i.k,this);i&&i.r;)i=i.p},has:function(t){return!!y(p(this,e),t)}}),d&&a(u.prototype,"size",{get:function(){return p(this,e)[f]}}),u},def:function(t,e,i){var a,s,n=y(t,e);return n?n.v=i:(t._l=n={i:s=m(e,!0),k:e,v:i,p:a=t._l,n:void 0,r:!1},t._f||(t._f=n),a&&(a.n=n),t[f]++,"F"!==s&&(t._i[s]=n)),t},getEntry:y,setStrong:function(t,e,i){c(t,e,(function(t,i){this._t=p(t,e),this._k=i,this._l=void 0}),(function(){for(var t=this,e=t._k,i=t._l;i&&i.r;)i=i.p;return t._t&&(t._l=i=i?i.n:t._t._f)?u(0,"keys"==e?i.k:"values"==e?i.v:[i.k,i.v]):(t._t=void 0,u(1))}),i?"entries":"values",!i,!0),h(e)}}},1423:function(t,e,i){"use strict";var a=i(119),s=i(82),n=i(453),o=i(208),r=i(217),l=i(434),c=i(319),u=i(433),h=i(141),d=i(323),m=i(176).f,p=i(1424)(0),f=i(158);t.exports=function(t,e,i,y,v,g){var b=a[t],w=b,_=v?"set":"add",x=w&&w.prototype,k={};return f&&"function"==typeof w&&(g||x.forEach&&!o((function(){(new w).entries().next()})))?(w=e((function(e,i){u(e,w,t,"_c"),e._c=new b,null!=i&&c(i,v,e[_],e)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(t){var e="add"==t||"set"==t;!(t in x)||g&&"clear"==t||r(w.prototype,t,(function(i,a){if(u(this,w,t),!e&&g&&!h(i))return"get"==t&&void 0;var s=this._c[t](0===i?0:i,a);return e?this:s}))})),g||m(w.prototype,"size",{get:function(){return this._c.size}})):(w=y.getConstructor(e,t,v,_),l(w.prototype,i),n.NEED=!0),d(w,t),k[t]=w,s(s.G+s.W+s.F,k),g||y.setStrong(w,t,v),w}},1424:function(t,e,i){var a=i(207),s=i(445),n=i(255),o=i(384),r=i(1425);t.exports=function(t,e){var i=1==t,l=2==t,c=3==t,u=4==t,h=6==t,d=5==t||h,m=e||r;return function(e,r,p){for(var f,y,v=n(e),g=s(v),b=a(r,p,3),w=o(g.length),_=0,x=i?m(e,w):l?m(e,0):void 0;w>_;_++)if((d||_ in g)&&(y=b(f=g[_],_,v),t))if(i)x[_]=y;else if(y)switch(t){case 3:return!0;case 5:return f;case 6:return _;case 2:x.push(f)}else if(u)return!1;return h?-1:c||u?u:x}}},1425:function(t,e,i){var a=i(1426);t.exports=function(t,e){return new(a(t))(e)}},1426:function(t,e,i){var a=i(141),s=i(430),n=i(135)("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),a(e)&&null===(e=e[n])&&(e=void 0)),void 0===e?Array:e}},1427:function(t,e,i){var a=i(82);a(a.P+a.R,"Set",{toJSON:i(1428)("Set")})},1428:function(t,e,i){var a=i(385),s=i(1429);t.exports=function(t){return function(){if(a(this)!=t)throw TypeError(t+"#toJSON isn't generic");return s(this)}}},1429:function(t,e,i){var a=i(319);t.exports=function(t,e){var i=[];return a(t,!1,i.push,i,e),i}},1430:function(t,e,i){i(1431)("Set")},1431:function(t,e,i){"use strict";var a=i(82);t.exports=function(t){a(a.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},1432:function(t,e,i){i(1433)("Set")},1433:function(t,e,i){"use strict";var a=i(82),s=i(256),n=i(207),o=i(319);t.exports=function(t){a(a.S,t,{from:function(t){var e,i,a,r,l=arguments[1];return s(this),(e=void 0!==l)&&s(l),null==t?new this:(i=[],e?(a=0,r=n(l,arguments[2],2),o(t,!1,(function(t){i.push(r(t,a++))}))):o(t,!1,i.push,i),new this(i))}})}},1510:function(t,e,i){"use strict";i.r(e);var a=i(26),s=i.n(a),n=i(19),o=i.n(n),r=i(37),l=i.n(r),c=i(13),u=i.n(c),h=i(24),d=i.n(h),m=i(20),p=i.n(m),f=i(16),y=i.n(f),v=i(25),g=i.n(v),b=i(23),w=i.n(b),_=i(75),x=i.n(_),k=i(222);function S(){S=function(){return e};var t,e={},i=Object.prototype,a=i.hasOwnProperty,n=p.a||function(t,e,i){t[e]=i.value},r="function"==typeof d.a?d.a:{},c=r.iterator||"@@iterator",h=r.asyncIterator||"@@asyncIterator",m=r.toStringTag||"@@toStringTag";function f(t,e,i){return p()(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,i){return t[e]=i}}function v(t,e,i,a){var s=e&&e.prototype instanceof k?e:k,o=u()(s.prototype),r=new j(a||[]);return n(o,"_invoke",{value:$(t,i,r)}),o}function g(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=v;var b="suspendedStart",w="executing",_="completed",x={};function k(){}function E(){}function A(){}var D={};f(D,c,(function(){return this}));var C=l.a,I=C&&C(C(N([])));I&&I!==i&&a.call(I,c)&&(D=I);var q=A.prototype=k.prototype=u()(D);function T(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function F(t,e){function i(s,n,r,l){var c=g(t[s],t,n);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==o()(h)&&a.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,r,l)}),(function(t){i("throw",t,r,l)})):e.resolve(h).then((function(t){u.value=t,r(u)}),(function(t){return i("throw",t,r,l)}))}l(c.arg)}var s;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,s){i(t,a,e,s)}))}return s=s?s.then(n,n):n()}})}function $(e,i,a){var s=b;return function(n,o){if(s===w)throw Error("Generator is already running");if(s===_){if("throw"===n)throw o;return{value:t,done:!0}}for(a.method=n,a.arg=o;;){var r=a.delegate;if(r){var l=M(r,a);if(l){if(l===x)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===b)throw s=_,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=w;var c=g(e,i,a);if("normal"===c.type){if(s=a.done?_:"suspendedYield",c.arg===x)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(s=_,a.method="throw",a.arg=c.arg)}}}function M(e,i){var a=i.method,s=e.iterator[a];if(s===t)return i.delegate=null,"throw"===a&&e.iterator.return&&(i.method="return",i.arg=t,M(e,i),"throw"===i.method)||"return"!==a&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),x;var n=g(s,e.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,x;var o=n.arg;return o?o.done?(i[e.resultName]=o.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,x):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,x)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function N(e){if(e||""===e){var i=e[c];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,n=function i(){for(;++s<e.length;)if(a.call(e,s))return i.value=e[s],i.done=!1,i;return i.value=t,i.done=!0,i};return n.next=n}}throw new TypeError(o()(e)+" is not iterable")}return E.prototype=A,n(q,"constructor",{value:A,configurable:!0}),n(A,"constructor",{value:E,configurable:!0}),E.displayName=f(A,m,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return s.a?s()(t,A):(t.__proto__=A,f(t,m,"GeneratorFunction")),t.prototype=u()(q),t},e.awrap=function(t){return{__await:t}},T(F.prototype),f(F.prototype,h,(function(){return this})),e.AsyncIterator=F,e.async=function(t,i,a,s,n){void 0===n&&(n=y.a);var o=new F(v(t,i,a,s),n);return e.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},T(q),f(q,m,"Generator"),f(q,c,(function(){return this})),f(q,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var a in e)i.push(a);return i.reverse(),function t(){for(;i.length;){var a=i.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=N,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function s(a,s){return r.type="throw",r.arg=e,i.next=a,s&&(i.method="next",i.arg=t),!!s}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],r=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc<=this.prev&&a.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var n=s;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=t,o.arg=e,n?(this.method="next",this.next=n.finallyLoc,x):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),x},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),O(i),x}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var a=i.completion;if("throw"===a.type){var s=a.arg;O(i)}return s}}throw Error("illegal catch attempt")},delegateYield:function(e,i,a){return this.delegate={iterator:N(e),resultName:i,nextLoc:a},"next"===this.method&&(this.arg=t),x}},e}var E={data:function(){return{subject:{fileName:$("[name=filename]").val(),items:JSON.parse($("[name=items]").val())},showCKEditorData:{publicPath:$("[name=ckeditor_path]").val(),filebrowserImageUploadUrl:$("[name=ckeditor_image_upload_url]").val(),filebrowserImageDownloadUrl:$("[name=ckeditor_image_download_url]").val(),language:"zh_CN"===document.documentElement.lang?"zh-cn":document.documentElement.lang,jqueryPath:$("[name=jquery_path]").val()},bank_id:$("[name=bankId]").val(),category:JSON.parse($("[name=categoryTree]").val()),importType:$("[name=type]").val(),showAttachment:$("[name=show_attachment]").val(),cdnHost:$("[name=cdn_host]").val(),uploadSDKInitData:{sdkBaseUri:app.cloudSdkBaseUri,disableDataUpload:app.cloudDisableLogReport,disableSentry:app.cloudDisableLogReport,initUrl:$("[name=upload_init_url]").val(),finishUrl:$("[name=upload_finish_url]").val(),accept:JSON.parse($("[name=upload_accept]").val()),fileSingleSizeLimit:$("[name=upload_size_limit]").val(),ui:"batch",multiple:!0,multitaskNum:3,fileNumLimit:3,locale:document.documentElement.lang},fileId:0,redirect:!0,token:$('[name="import_token"]').val(),repeatList:[],loading:!1,isVisiblePopconfim:!1,isWrong:!1,duplicatedIds:[],ids:null,stopAnswer:{},aiAnalysisEnable:1==$("[name=ai_analysis_enable]").val()}},created:function(){var t=this;$(window).on("beforeunload",(function(){if(t.redirect)return Translator.trans("admin.block.not_saved_data_hint")}))},provide:function(){return{modeOrigin:"create",self:this}},methods:{getRepeatQuestion:function(t){var e=arguments,i=this;return w()(S().mark((function a(){var s,n;return S().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=e.length>1&&void 0!==e[1]?e[1]:0,n=i,s||(n.loading=!0),a.next=5,$.ajax({url:$("[name=check_duplicated_questions_url]").val(),contentType:"application/json;charset=utf-8",type:"post",data:g()(t),beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(e){for(var i in n.duplicatedIds=e.duplicatedIds,n.repeatList=[],e.duplicatedIds)n.repeatList.push(Number(i));s||(n.repeatList.length>0?n.$confirm({title:Translator.trans("created.question.confirm.import.title"),okText:Translator.trans("created.question.confirm.ok.btn"),cancelText:Translator.trans("created.question.confirm.import.close.btn"),icon:"exclamation-circle",onOk:function(){n.loading=!1,n.forceRemoveModalDom()},onCancel:function(){n.getImportData(t),n.forceRemoveModalDom()}}):n.getImportData(t))}));case 5:case"end":return a.stop()}}),a)})))()},forceRemoveModalDom:function(){var t=document.querySelector(".ant-modal-root");t&&t.remove(),document.body.style=""},editQuestion:function(t,e){var i=this;this.ids=t.ids,e=e.filter((function(e){return e.ids!==t.ids}));var a="material"===t.type?t.material:t.questions[0].stem;return new y.a((function(t){$.ajax({url:$("[name=check_question_duplicative_url]").val(),contentType:"application/json;charset=utf-8",type:"post",data:g()({material:a,items:e}),beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(e){i.isWrong=e,t(e)}))}))},getImportData:function(t){this.redirect=!1,$.ajax({url:$("[name=saveUrl]").val(),contentType:"application/json;charset=utf-8",type:"post",data:g()(t),beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){t.goto&&(window.location.href=t.goto)}))},deleteAttachmentCallback:function(){var t=this;return new y.a((function(e){$.ajax({url:$("[name=delete-attachment-url]").val(),type:"post",data:{id:t.fileId},beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){e(t)}))}))},deleteAttachment:function(t){this.fileId=t},previewAttachment:function(t){this.fileId=t},downloadAttachment:function(t){this.fileId=t},previewAttachmentCallback:function(){var t=this,e=this;return new y.a((function(i){$.ajax({url:$("[name=preview-attachment-url]").val(),type:"post",data:{id:t.fileId},beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){console.log(app),console.log(t),t.data.sdkBaseUri=app.cloudSdkBaseUri,t.data.disableDataUpload=app.cloudDisableLogReport,t.data.disableSentry=app.cloudDisableLogReport,i(t),e.fileId=0}))}))},downloadAttachmentCallback:function(){var t=this,e=this;return new y.a((function(i){$.ajax({url:$("[name=download-attachment-url]").val(),type:"post",data:{id:t.fileId},beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){i(t),e.fileId=0}))}))},changeEditor:function(t,e){var i=this;return e=e.filter((function(t){return t.ids!==i.ids})),new y.a((function(a){$.ajax({url:$("[name=check_question_duplicative_url]").val(),contentType:"application/json;charset=utf-8",type:"post",data:g()({material:t,items:e}),beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$("meta[name=csrf-token]").attr("content"))}}).done((function(t){t?i.isWrong=!0:(i.isWrong=!1,a(t))}))}))},getInitRepeatQuestion:function(t){var e=this;x()({url:$("[name=check_duplicated_questions_url]").val(),method:"POST",data:t,headers:{Accept:"application/vnd.edusoho.v2+json","X-CSRF-Token":$("meta[name=csrf-token]").attr("content"),"X-Requested-With":"XMLHttpRequest"}}).then((function(t){for(var i in e.repeatList=[],e.duplicatedIds=t.data.duplicatedIds,t.data.duplicatedIds)e.repeatList.push(Number(i))}))},getEditRepeatQuestion:function(t){this.getInitRepeatQuestion(t)},renderFormula:function(){this.$nextTick((function(){Object(k.a)()}))}}},A=E,D=i(22),C=Object(D.a)(A,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ibs-vue question-import",attrs:{id:"app"}},[i("item-import",{attrs:{isDownload:!1,subject:t.subject,showCKEditorData:t.showCKEditorData,bank_id:t.bank_id,category:t.category,importType:t.importType,showAttachment:t.showAttachment,cdnHost:t.cdnHost,repeatList:t.repeatList,loading:t.loading,isVisiblePopconfim:t.isVisiblePopconfim,uploadSDKInitData:t.uploadSDKInitData,aiAnalysisEnable:t.aiAnalysisEnable,deleteAttachmentCallback:t.deleteAttachmentCallback,previewAttachmentCallback:t.previewAttachmentCallback,downloadAttachmentCallback:t.downloadAttachmentCallback},on:{deleteAttachment:t.deleteAttachment,previewAttachment:t.previewAttachment,downloadAttachment:t.downloadAttachment,getRepeatQuestion:t.getRepeatQuestion,getImportData:t.getImportData,renderFormula:t.renderFormula,editQuestion:t.editQuestion,changeEditor:t.changeEditor,getInitRepeatQuestion:t.getInitRepeatQuestion,getEditRepeatQuestion:t.getEditRepeatQuestion}})],1)}),[],!1,null,null,null).exports,I=i(105),q=i.n(I),T=i(159),F=i.n(T),M=i(120),L=i.n(M),O=i(33),j=i.n(O),N=i(133),R=i.n(N),Q=i(149),V=i(150),K=i(151),B=i(148),U=i(152),P=i(245),H=i(246),J=i(43),z={name:"import-data",mixins:[J.a],props:{totalItem:{type:Number,default:0},totalTypes:{type:Object,default:function(){return{}}},importType:{type:String,default:"item"},allScore:{type:Number,default:0}},methods:{getTypeName:function(t){switch(t){case"single_choice":return this.t("single_choice");case"fill":return this.t("fill");case"essay":return this.t("essay");case"material":return this.t("material");case"uncertain_choice":return this.t("uncertain_choice");case"choice":return this.t("choice");case"determine":return this.t("determine");default:return""}}}},G=Object(D.a)(z,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ibs-import-list"},[i("div",{staticClass:"ibs-clearfix ibs-subject-rect__title"},[i("span",{staticClass:"ibs-left"},[t._v(t._s(t.t("itemImport.Topic_statistics")))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:"item"===t.importType,expression:"importType === 'item'"}],staticClass:"ibs-right ibs-subject-data__num"},[t._v(t._s(t.t("itemImport.Number_of_topics")(t.totalItem))+"\n    ")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"testpaper"===t.importType,expression:"importType === 'testpaper'"}],staticClass:"ibs-clearfix ibs-subject-data__item"},[i("span",{staticClass:"ibs-left ibs-subject-data__num"},[t._v(t._s(t.t("itemImport.Number_of_topics")(t.totalItem)))]),t._v(" "),i("span",{staticClass:"ibs-right ibs-subject-data__num"},[t._v(t._s(t.t("itemImport.allScore")(t.allScore)))])]),t._v(" "),t._l(t.totalTypes,(function(e,a,s){return i("div",{key:s,staticClass:"ibs-clearfix ibs-subject-data__item"},[i("span",{staticClass:"ibs-left"},[t._v(t._s(t.getTypeName(a)))]),t._v(" "),i("span",{staticClass:"ibs-right ibs-subject-data__num"},[t._v(t._s(t.t("itemImport.Number_of_topics")(e)))])])}))],2)}),[],!1,null,null,null).exports,W=i(31),X=i.n(W),Y=i(666),Z=i.n(Y),tt=i(50),et=i.n(tt),it={name:"import-list",mixins:[J.a],data:function(){return{checkedList:[],batchOperation:!1,all:!1,types:{},showSetModal:!1,setModalTitle:"",setModal:"",form:this.$form.createForm(this,{name:"form"}),difficultySelect:[{lable:this.t("Simple"),value:"simple"},{lable:this.t("Normal"),value:"normal"},{lable:this.t("Difficult"),value:"difficulty"}],hasError:!1}},props:{items:{type:Array,default:function(){return[]}},typeIndex:{type:Object,default:function(){}},category:{type:Array,default:function(){return[]}},errorList:{type:Array,default:function(){return[]}},totalTypes:{type:Object,default:function(){return{}}},repeatList:{type:Array,default:function(){return[]}}},computed:{singleChoiceAll:function(){var t="single_choice";return!(!this.types[t]||this.types[t].length!==this.typeIndex[t].length)},uncertainChoiceAll:function(){var t="uncertain_choice";return!(!this.types[t]||this.types[t].length!==this.typeIndex[t].length)},choiceAll:function(){var t="choice";return!(!this.types[t]||this.types[t].length!==this.typeIndex[t].length)},fillAll:function(){return!(!this.types.fill||this.types.fill.length!==this.typeIndex.fill.length)},essayAll:function(){return!(!this.types.essay||this.types.essay.length!==this.typeIndex.essay.length)},determineAll:function(){var t="determine";return!(!this.types[t]||this.types[t].length!==this.typeIndex[t].length)},All:function(){return this.checkedList.length===this.typeIndex.all.length},treeData:function(){var t=JSON.parse(g()(this.category));return this.formateCategory(t),t.unshift({value:0,title:this.t("None"),key:0}),t}},methods:{getTypeName:function(t){switch(t){case"single_choice":return this.t("single_choice");case"fill":return this.t("fill");case"essay":return this.t("essay");case"material":return this.t("material");case"uncertain_choice":return this.t("uncertain_choice_1");case"choice":return this.t("choice");case"determine":return this.t("determine");default:return""}},getCheckedType:function(t){switch(t){case"single_choice":return this.singleChoiceAll;case"fill":return this.fillAll;case"essay":return this.essayAll;case"material":default:return!1;case"uncertain_choice":return this.uncertainChoiceAll;case"choice":return this.choiceAll;case"determine":return this.determineAll}},hasUncertainChoiceOrChoice:function(t){var e=et()(t),i=e.includes("choice")&&(null==t?void 0:t.choice.length)>0,a=e.includes("uncertain_choice")&&(null==t?void 0:t.uncertain_choice.length)>0;return i||a},checkOtherScore1:function(t,e,i){var a=e.toString().split(".");e>=this.form.getFieldValue("score")?i("得分不超过全选得分"):a.length>1&&a[1].length>1?i("最多只能输入一位小数"):i()},onChange:function(t){t.length===this.typeIndex.all.length?this.all=!0:this.all=!1},checkAll:function(t){var e=JSON.parse(g()(this.typeIndex));(null==e?void 0:e.material)&&delete e.material,t.target.checked?(this.checkedList=e.all,this.types=e):(this.checkedList=[],this.types={})},checkChange:function(t,e){var i=this,a=JSON.parse(g()(this.typeIndex));t.target.checked?(this.checkedList=this.checkedList.concat(a[e]),this.checkedList=L()(new Z.a(this.checkedList)),this.types[e]?this.types[e]=a[e]:this.$set(this.types,e,a[e])):(this.typeIndex[e].forEach((function(t){var e=i.checkedList.indexOf(t);e>-1&&i.checkedList.splice(e,1)})),this.types[e]=[])},doOperation:function(){this.batchOperation=!0},closeOperation:function(){this.types={},this.checkedList=[],this.batchOperation=!1},changeChoose:function(t,e,i){if(this.types[e]||this.$set(this.types,e,[]),t.target.checked)this.types[e].push(i);else{var a=this.types[e].indexOf(i);this.types[e].splice(a,1)}},isHasMaterial:function(t){return t.every((function(t){return"material"===t.type}))},setDiffcult:function(){this.isCheckItem()||!this.isHasMaterial(this.items)?this.isCheckItem()?(this.showSetModal=!0,this.setModal="diffcult",this.setModalTitle=this.t("itemImport.Set_difficulty")):this.$message.error("".concat(this.t("itemImport.Choose_topic"))):this.$message.error("".concat(this.t("itemImport.Choose_topic_difficult")))},setScore:function(){this.isCheckItem()||!this.isHasMaterial(this.items)?this.isCheckItem()?(this.showSetModal=!0,this.setModal="score",this.setModalTitle=this.t("itemImport.Set_score")):this.$message.error("".concat(this.t("itemImport.Choose_topic"))):this.$message.error("".concat(this.t("itemImport.Choose_topic_score")))},setCategory:function(){this.isCheckItem()||!this.isHasMaterial(this.items)?this.isCheckItem()?(this.showSetModal=!0,this.setModal="category",this.setModalTitle=this.t("itemImport.Set_classification")):this.$message.error("".concat(this.t("itemImport.Choose_topic"))):this.$message.error("".concat(this.t("itemImport.Choose_topic_category")))},handleSetModal:function(){switch(this.setModal){case"score":this.handleScore();break;case"diffcult":this.handleDiffcult();break;case"category":this.handleCategory()}},handleScore:function(){var t=this;this.$nextTick((function(){t.form.validateFields(["score","otherScore1"],{force:!0},(function(e,i){e||(t.$emit("setScore",t.checkedList,i.score,i.otherScore1),t.showSetModal=!1)}))}))},handleDiffcult:function(){var t=this;this.$nextTick((function(){var e=t.form.getFieldValue("difficulty");t.$emit("setDifficult",t.checkedList,e),t.showSetModal=!1}))},handleCategory:function(){var t=this;this.$nextTick((function(){var e=t.form.getFieldValue("category_id"),i=t.form.getFieldValue("category_name")||t.t("None");t.$emit("setCategory",t.checkedList,e,i),t.showSetModal=!1}))},isCheckItem:function(){return!!this.checkedList.length},checkScore:function(t,e,i){e<0?i("".concat(this.t("ScoreRule.one"))):e>999?i("".concat(this.t("ScoreRule.two"))):/^(([1-9]{1}\d{0,2})|([0]{1}))(\.(\d){1})?$/.test(e)?i():i("".concat(this.t("ScoreRule.three")))},getContainer:function(){return document.getElementById("item-bank-sdk-import-list")},formateCategory:function(t){var e=this;t.forEach((function(t){t.value=t.id,t.title=t.name,t.key="".concat(t.name).concat(t.id),t.children&&e.formateCategory(t.children)}))},setCategoryId:function(t,e){this.form.setFieldsValue(X()({},"category_name",e[0])),this.form.setFieldsValue(X()({},"category_id",t))},isError:function(t){return this.errorList.includes(t)},isWorng:function(t){return this.repeatList.includes(t)}}},at=Object(D.a)(it,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-affix",{attrs:{offsetTop:0}},[i("div",{staticClass:"ibs-import-list ibs-mt16",attrs:{id:"item-bank-sdk-import-list"}},[i("div",{staticClass:"ibs-clearfix ibs-subject-rect__title"},[i("span",{staticClass:"ibs-left"},[t._v(t._s(t.t("itemImport.Title_list")))])]),t._v(" "),t.items.length>0?i("a-row",{staticClass:"ibs-mt24"},[t.errorList.length?i("div",{staticClass:"ibs-danger-color ibs-import-list-error-text"},[i("a-anchor",{attrs:{affix:!1}},[i("div",{staticStyle:{"margin-right":"4px"}},[t._v("\n            "+t._s(t.t("itemImport.Error_list_1"))+"\n          ")]),t._v(" "),t._l(t.errorList,(function(e,a){return i("a-anchor-link",{key:e,attrs:{href:"#ibs-import-"+e}},[i("div",{staticStyle:{display:"flex"},attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"error-link"},[t._v("\n                "+t._s(e+1)+" "+t._s(t.t("itemImport.Error_list_2"))+"\n              ")]),t._v(" "),a!==t.errorList.length-1?i("span",[t._v("、")]):t._e()])])})),t._v(" "),i("div",{staticStyle:{"margin-left":"4px"}},[t._v("\n            "+t._s(t.t("itemImport.Error_list_4"))+"\n          ")])],2)],1):t._e(),t._v(" "),i("a-checkbox-group",{staticClass:"ibs-width-full",attrs:{name:"checkboxgroup"},on:{change:t.onChange},model:{value:t.checkedList,callback:function(e){t.checkedList=e},expression:"checkedList"}},[i("a-anchor",{staticClass:"custom-anchor",attrs:{affix:!1}},t._l(t.items,(function(e,a){return i("a-anchor-link",{key:a,class:[{"ibs-import-list-error":t.isError(a)},{"ibs-import-list-worng":t.isWorng(a)}],attrs:{href:"#ibs-import-"+a,title:a+1}},[i("a-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.batchOperation&&"material"!==e.type,expression:"batchOperation && item.type !== 'material'"}],key:e.ids,staticClass:"ibs-import-list-item__checkbox",attrs:{value:e.ids},on:{change:function(i){return t.changeChoose(i,e.type,e.ids)}}}),t._v(" "),i("span",{staticClass:"ibs-import-list-item__text"},[t._v(t._s(t.getTypeName(e.type)))])],1)})),1)],1)],1):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.batchOperation,expression:"batchOperation"}]},[i("a-row",[i("a-col",{staticClass:"ibs-mb8",attrs:{span:8}},[i("a-checkbox",{attrs:{checked:t.All},on:{change:t.checkAll}},[t._v(t._s(t.t("itemImport.Check_all")))])],1),t._v(" "),t._l(t.totalTypes,(function(e,a,s){return i("a-col",{key:s,staticClass:"ibs-mb8",attrs:{span:8}},["material"!==a&&"uncertain_choice"!==a?i("a-checkbox",{attrs:{checked:t.getCheckedType(a)},on:{change:function(e){return t.checkChange(e,a)}}},[t._v(t._s(t.t(a)))]):t._e(),t._v(" "),"uncertain_choice"===a?i("a-checkbox",{attrs:{checked:t.getCheckedType(a)},on:{change:function(e){return t.checkChange(e,a)}}},[t._v(t._s(t.t("uncertain_choice_1")))]):t._e()],1)}))],2),t._v(" "),i("a-row",{staticClass:"ibs-mt8",attrs:{gutter:16}},[i("a-col",{staticClass:"ibs-mb8",attrs:{span:8}},[i("a-button",{attrs:{type:"link"},on:{click:t.setDiffcult}},[t._v(t._s(t.t("itemImport.Set_difficulty")))])],1),t._v(" "),i("a-col",{staticClass:"ibs-mb8",attrs:{span:8}},[i("a-button",{attrs:{type:"link"},on:{click:t.setScore}},[t._v(t._s(t.t("itemImport.Set_score")))])],1),t._v(" "),i("a-col",{staticClass:"ibs-mb8",attrs:{span:8}},[i("a-button",{attrs:{type:"link"},on:{click:t.setCategory}},[t._v(t._s(t.t("itemImport.Set_classification")))])],1)],1),t._v(" "),i("a-button",{staticClass:"ibs-import-list-item__btn",attrs:{type:"primary"},on:{click:t.closeOperation}},[t._v(t._s(t.t("complete"))+"\n      ")])],1),t._v(" "),i("a-button",{directives:[{name:"show",rawName:"v-show",value:!t.batchOperation,expression:"!batchOperation"}],staticClass:"ibs-import-list-item__btn",attrs:{type:"primary"},on:{click:t.doOperation}},[t._v(t._s(t.t("Batch_operation"))+"\n    ")])],1),t._v(" "),i("a-modal",{attrs:{title:t.setModalTitle,destroyOnClose:!0,getContainer:t.getContainer,cancelText:t.t("cancel"),okText:t.t("confirm")},on:{ok:t.handleSetModal},model:{value:t.showSetModal,callback:function(e){t.showSetModal=e},expression:"showSetModal"}},[i("a-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{message:"材料题不支持批量设置分数/难度/分类","show-icon":"",banner:""},scopedSlots:t._u([{key:"icon",fn:function(){return[i("a-icon",{staticStyle:{"font-size":"16px",color:"#faad14"},attrs:{type:"info-circle"}})]},proxy:!0}])}),t._v(" "),i("div",{staticClass:"ibs-import-list-choose ibs-mb24"},[t._v("\n      "+t._s(t.t("itemImport.List_choose_1"))+"：\n      "),t._l(t.types,(function(e,a,s){return i("div",{directives:[{name:"show",rawName:"v-show",value:e.length,expression:"value.length"}],key:s,staticClass:"ibs-import-list-choose-text"},[t._v("\n        "+t._s(e.length)+t._s(t.t("itemImport.List_choose_2"))+t._s(t.getTypeName(a))+"\n        "+t._s(s===Object.keys(t.types).length-1?"。":"，")+"\n      ")])}))],2),t._v(" "),i("a-form",{staticClass:"ibs-import-modal-form",attrs:{form:t.form}},["score"===t.setModal?i("a-form-item",{attrs:{label:t.t("Score"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["score",{rules:[{required:!0,validator:t.checkScore}],initialValue:2}],expression:"[\n            'score',\n            {\n              rules: [{ required: true, validator: checkScore }],\n              initialValue: 2\n            }\n          ]"}],staticStyle:{width:"200px"},attrs:{type:"number"}})],1):t._e(),t._v(" "),"score"===t.setModal&&t.hasUncertainChoiceOrChoice(t.types)?i("a-form-item",{staticClass:"missed-selection-score-item",attrs:{"label-col":{span:4},"wrapper-col":{span:16}},scopedSlots:t._u([{key:"label",fn:function(){return[i("a-tooltip",{attrs:{placement:"topLeft","arrow-point-at-center":""}},[i("template",{slot:"title"},[i("div",{staticClass:"missed-selection-score-tip-content"},[t._v("漏选得分：当学员选对一个或多个正确答案，但还是有漏选正确答案时的得分（某题满分2分，含3个正确答案，选中1个或2个正确答案得1分，选中全部3个正确答案得2分）")])]),t._v(" "),i("div",{staticClass:"missed-selection-score-item-label"},[t._v(t._s(t.t("otherScore1")))])],2)]},proxy:!0}],null,!1,2001085080)},[t._v(" "),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["otherScore1",{rules:[{required:!0,message:"请输入漏选得分"},{validator:t.checkOtherScore1}],initialValue:0}],expression:"[\n            'otherScore1',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: '请输入漏选得分',\n                },\n                {\n                  validator: checkOtherScore1\n                }\n              ],\n              initialValue: 0\n            }\n          ]"}],staticStyle:{width:"200px"},attrs:{type:"number"}})],1):t._e(),t._v(" "),"diffcult"===t.setModal?i("a-form-item",{attrs:{label:t.t("Difficulty"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["difficulty",{initialValue:"normal"}],expression:"['difficulty', { initialValue: 'normal' }]"}],attrs:{name:"radioGroup"}},t._l(t.difficultySelect,(function(e,a){return i("a-radio",{key:a,attrs:{value:e.value}},[t._v(t._s(e.lable))])})),1)],1):t._e(),t._v(" "),"category"===t.setModal?i("a-form-item",{attrs:{label:t.t("itemImport.Topic_classification"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["category_id",{initialValue:0}],expression:"['category_id', { initialValue: 0 }]"}],staticStyle:{width:"200px"},attrs:{showSearch:"",dropdownStyle:{maxHeight:"400px",overflow:"auto"},treeData:t.treeData,getPopupContainer:function(e){return e.parentNode||t.document.body},treeNodeFilterProp:"title",placeholder:"Please select"},on:{change:t.setCategoryId}})],1):t._e(),t._v(" "),"category"===t.setModal?i("a-form-item",{staticStyle:{marginBottom:"0"},attrs:{label:"","label-col":{span:0},"wrapper-col":{span:20}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["category_name",{initialValue:""}],expression:"['category_name', { initialValue: '' }]"}],attrs:{type:"hidden"}})],1):t._e()],1)],1)],1)}),[],!1,null,null,null).exports,st={name:"item-footer",mixins:[J.a],props:{difficulty:{type:String,default:""},score:{type:String,default:""},categoryName:{type:String,default:""}},methods:{getPopupContainer:function(){return document.getElementById("ibs-import-footer")},getDifficulty:function(t){switch(t){case"simple":return this.t("Simple");case"normal":return this.t("Normal");case"difficulty":return this.t("Difficult");default:return""}},getCategoryName:function(t){return t||this.t("None")}}},nt=Object(D.a)(st,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ibs-import-footer",attrs:{id:"ibs-import-footer"}},[i("div",{staticClass:"ibs-import-tap ibs-import-classification ibs-import__category"},[t._v("\n    "+t._s(t.t("itemImport.Category"))),i("span",[i("a-tooltip",{attrs:{placement:"top",getPopupContainer:t.getPopupContainer}},[i("template",{slot:"title"},[i("span",[t._v(t._s(t.getCategoryName(t.categoryName)))])]),t._v(" "),i("span",[t._v(t._s(t.getCategoryName(t.categoryName)))])],2)],1)]),t._v(" "),i("div",{staticClass:"ibs-import-tap ibs-import-classification"},[t._v("\n    "+t._s(t.t("itemImport.Difficulty"))),i("span",[t._v(t._s(t.getDifficulty(t.difficulty)))])]),t._v(" "),i("div",{staticClass:"ibs-import-tap ibs-import-classification"},[t._v("\n    "+t._s(t.t("itemImport.Score"))),i("span",[t._v(t._s(t.score))])])])}),[],!1,null,null,null).exports,ot=i(203),rt=i(417);function lt(){lt=function(){return e};var t,e={},i=Object.prototype,a=i.hasOwnProperty,n=p.a||function(t,e,i){t[e]=i.value},r="function"==typeof d.a?d.a:{},c=r.iterator||"@@iterator",h=r.asyncIterator||"@@asyncIterator",m=r.toStringTag||"@@toStringTag";function f(t,e,i){return p()(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,i){return t[e]=i}}function v(t,e,i,a){var s=e&&e.prototype instanceof k?e:k,o=u()(s.prototype),r=new O(a||[]);return n(o,"_invoke",{value:F(t,i,r)}),o}function g(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=v;var b="suspendedStart",w="executing",_="completed",x={};function k(){}function S(){}function E(){}var A={};f(A,c,(function(){return this}));var D=l.a,C=D&&D(D(j([])));C&&C!==i&&a.call(C,c)&&(A=C);var I=E.prototype=k.prototype=u()(A);function q(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function i(s,n,r,l){var c=g(t[s],t,n);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==o()(h)&&a.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,r,l)}),(function(t){i("throw",t,r,l)})):e.resolve(h).then((function(t){u.value=t,r(u)}),(function(t){return i("throw",t,r,l)}))}l(c.arg)}var s;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,s){i(t,a,e,s)}))}return s=s?s.then(n,n):n()}})}function F(e,i,a){var s=b;return function(n,o){if(s===w)throw Error("Generator is already running");if(s===_){if("throw"===n)throw o;return{value:t,done:!0}}for(a.method=n,a.arg=o;;){var r=a.delegate;if(r){var l=$(r,a);if(l){if(l===x)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===b)throw s=_,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=w;var c=g(e,i,a);if("normal"===c.type){if(s=a.done?_:"suspendedYield",c.arg===x)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(s=_,a.method="throw",a.arg=c.arg)}}}function $(e,i){var a=i.method,s=e.iterator[a];if(s===t)return i.delegate=null,"throw"===a&&e.iterator.return&&(i.method="return",i.arg=t,$(e,i),"throw"===i.method)||"return"!==a&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),x;var n=g(s,e.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,x;var o=n.arg;return o?o.done?(i[e.resultName]=o.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,x):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,x)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function j(e){if(e||""===e){var i=e[c];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,n=function i(){for(;++s<e.length;)if(a.call(e,s))return i.value=e[s],i.done=!1,i;return i.value=t,i.done=!0,i};return n.next=n}}throw new TypeError(o()(e)+" is not iterable")}return S.prototype=E,n(I,"constructor",{value:E,configurable:!0}),n(E,"constructor",{value:S,configurable:!0}),S.displayName=f(E,m,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===S||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return s.a?s()(t,E):(t.__proto__=E,f(t,m,"GeneratorFunction")),t.prototype=u()(I),t},e.awrap=function(t){return{__await:t}},q(T.prototype),f(T.prototype,h,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,a,s,n){void 0===n&&(n=y.a);var o=new T(v(t,i,a,s),n);return e.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},q(I),f(I,m,"Generator"),f(I,c,(function(){return this})),f(I,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var a in e)i.push(a);return i.reverse(),function t(){for(;i.length;){var a=i.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=j,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function s(a,s){return r.type="throw",r.arg=e,i.next=a,s&&(i.method="next",i.arg=t),!!s}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],r=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc<=this.prev&&a.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var n=s;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=t,o.arg=e,n?(this.method="next",this.next=n.finallyLoc,x):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),x},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),L(i),x}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var a=i.completion;if("throw"===a.type){var s=a.arg;L(i)}return s}}throw Error("illegal catch attempt")},delegateYield:function(e,i,a){return this.delegate={iterator:j(e),resultName:i,nextLoc:a},"next"===this.method&&(this.arg=t),x}},e}function ct(t,e){var i=void 0!==d.a&&t[F.a]||t["@@iterator"];if(!i){if(q()(t)||(i=function(t,e){if(t){if("string"==typeof t)return ut(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?L()(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ut(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,r=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){r=!0,n=t},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw n}}}}function ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=Array(e);i<e;i++)a[i]=t[i];return a}var ht={fileName:"这是试卷",items:[{type:"single_choice",material:"科目汇总表的汇总范围是（）。",attachments:[],analysis:"<p>这是解析</p>",category_id:"0",category_name:"",difficulty:"normal",score:"5.0",questions:[{stem:"",seq:"1",score:2,answer_mode:"single_choice",errors:{answer:{element:"answer",index:-1,code:100003,message:"缺少正确答案"},options_2:{element:"options",index:2,code:100002,message:"缺少选项"},stem:{element:"stem",index:-11,code:100001,message:"缺少题干"}},response_points:[{radio:{val:"A",text:"全部账户的借方余额"}},{radio:{val:"B",text:"全部账户的贷方余额"}},{radio:{val:"C",text:""}},{radio:{val:"D",text:"全部账户的借、贷方余额"}}],answer:[],analysis:"<p>这是解析</p>",attachments:[]}]},{type:"uncertain_choice",material:"资产应具备的基本特征有（）。",attachments:[],analysis:"<p>这是解析</p>",difficulty:"normal",category_id:"0",category_name:"",score:"5.0",questions:[{stem:"资产应具备的基本特征有（）。",answer_mode:"uncertain_choice",score:"5.0",response_points:[{checkbox:{val:"A",text:"资产是由企业过去的交易或事项形成"}},{checkbox:{val:"B",text:"必须是投资者投入的"}},{checkbox:{val:"C",text:"资产是由企业拥有和控制的"}},{checkbox:{val:"D",text:"资产预期能为企业带来经济利益"}}],answer:["A","B"],analysis:"<p></p>这是解析</p>",created_user_id:"1",updated_user_id:"1",updated_time:"1584945876",created_time:"1584945876",attachments:[]}]},{type:"choice",material:"资产应具备的基本特征有（）。",attachments:[],analysis:"<p>这是解析</p>",difficulty:"normal",category_id:"0",category_name:"",score:"5.0",questions:[{stem:"",score:2,answer_mode:"choice",errors:{answer:{element:"answer",index:-1,code:100003,message:"缺少正确答案"},options_1:{element:"options",index:1,code:100002,message:"缺少选项"},options_2:{element:"options",index:2,code:100002,message:"缺少选项"},stem:{element:"stem",index:-11,code:100001,message:"缺少题干"}},response_points:[{checkbox:{val:"A",text:"资产是由企业过去的交易或事项形成"}},{checkbox:{val:"B",text:""}},{checkbox:{val:"C",text:""}},{checkbox:{val:"D",text:"资产预期能为企业带来经济利益"}}],answer:[],analysis:"<p>这是解析</p>",attachments:[]}]},{type:"determine",material:"经上级有关部门批准的经济业务，应将批准文件作为原始凭证附件。",attachments:[],analysis:"<p>这是解析</p>",difficulty:"normal",category_id:"0",category_name:"",score:"5.0",questions:[{stem:"",score:2,answer_mode:"true_false",errors:{stem:{element:"stem",index:-11,code:100001,message:"缺少题干"}},response_points:[{radio:{val:"T",text:"正确"}},{radio:{val:"F",text:"错误"}}],answer:["T"],analysis:"<p>这是解析</p>",attachments:[]}]},{type:"fill",material:"",attachments:[],analysis:"<p>这是解析</p>",difficulty:"normal",category_id:"0",category_name:"",score:"5.0",questions:[{stem:"填空题唐代诗人李白，字[[李白]]，号[[谪仙人|青莲居士]]，人称诗仙。",score:2,answer_mode:"text",errors:{answers_0:{element:"answers",index:0,code:100002,message:"缺少正确答案"},stem:{element:"stem",index:-1,code:100001,message:"缺少题干"}},response_points:[{text:[]},{text:[]}],answer:["","谪仙人|青莲居士"],analysis:"<p>这是解析</p>",attachments:[]}]},{type:"essay",material:"<p>分别计算甲公司2X15年12月3日所得税负债或资产的账面余额。</p>",attachments:[],analysis:"<p>这是解析</p>",difficulty:"normal",question_num:"1",category_id:"0",category_name:"",score:"5.0",questions:[{id:"28",item_id:"28",stem:"<p>分别计算甲公司2X15年12月3日所得税负债或资产的账面余额。</p>",seq:"1",score:2,answer_mode:"rich_text",errors:{answer:{element:"answer",index:-1,code:100003,message:"缺少正确答案"},stem:{element:"stem",index:-11,code:100001,message:"缺少题干"}},response_points:[],answer:[],analysis:"<p>这是解析</p>",attachments:[]}]},{type:"material",material:"",attachments:[],analysis:"<p>这是解析</p>",difficulty:"normal",category_id:"0",category_name:"",score:"5.0",errors:{stem:{element:"stem",index:-1,code:100003,message:"缺少题干"},hasSubError:!0},questions:[{stem:"",score:2,answer_mode:"single_choice",errors:{answer:{element:"answer",index:-1,code:100003,message:"缺少正确答案"},options_0:{element:"options",index:0,code:100002,message:"缺少选项"},options_2:{element:"options",index:2,code:100002,message:"缺少选项"},stem:{element:"stem",index:-11,code:100001,message:"缺少题干"}},response_points:[{radio:{val:"A",text:""}},{radio:{val:"B",text:"全部账户的贷方余额"}},{radio:{val:"C",text:""}},{radio:{val:"D",text:"全部账户的借、贷方余额"}}],answer:[],analysis:"<p>这是解析</p>",attachments:[]},{stem:"<p>这是题干</p>",score:0,answer_mode:"choice",errors:{options_1:{element:"options",index:1,code:100002,message:"缺少选项"}},response_points:[{checkbox:{val:"A",text:"资产是由企业过去的交易或事项形成"}},{checkbox:{val:"B",text:""}},{checkbox:{val:"C",text:"资产是由企业拥有和控制的"}},{checkbox:{val:"D",text:"资产预期能为企业带来经济利益"}}],answer:["A","C"],analysis:"<p>这是解析</p>",attachments:[]},{stem:"<p>这是题干</p>",score:0,answer_mode:"true_false",response_points:[{radio:{val:"T",text:"正确"}},{radio:{val:"F",text:"错误"}}],answer:["F"],analysis:"<p>这是解析</p>",attachments:[]},{id:"32",item_id:"29",stem:"诗仙[[李白]], 号[[谪仙人|青莲居士]]",score:0,answer_mode:"text",errors:{answers_1:{element:"answers",index:0,code:100002,message:"缺少正确答案"}},response_points:[{text:[]},{text:[]}],answer:["李白",""],analysis:"<p>这是解析</p>",attachments:[]},{stem:"",score:0,answer_mode:"rich_text",errors:{answer:{element:"answer",index:-1,code:100003,message:"缺少正确答案"},stem:{element:"stem",index:-11,code:100001,message:"缺少题干"}},response_points:[{rich_text:[]}],answer:[],analysis:"<p>这是解析</p>",attachments:[]}]}]},dt={publicPath:"".concat(Object({NODE_ENV:"production"}).BASE_URL,"/es-ckeditor/ckeditor.js"),fileSingleSizeLimit:10,filebrowserImageUploadUrl:"",filebrowserImageDownloadUrl:"",language:"zh-cn",jqueryPath:"https://cdn.bootcss.com/jquery/3.4.1/jquery.js"},mt={name:"item-import",mixins:[J.a],props:{subject:{type:Object,default:function(){return ht}},showCKEditorData:{type:Object,default:function(){return dt}},bank_id:{type:String,default:""},category:{type:Array,default:function(){return[]}},importType:{type:String,default:"item"},repeatList:{type:Array,default:function(){return[]}},showAttachment:{type:String,default:"0"},cdnHost:{type:String,default:"service-cdn.qiqiuyun.net"},uploadSDKInitData:{type:Object,default:function(){}},deleteAttachmentCallback:{type:Function,default:function(){return new y.a((function(t){t()}))}},previewAttachmentCallback:{type:Function,default:function(){return new y.a((function(t){t()}))}},downloadAttachmentCallback:{type:Function,default:function(){return new y.a((function(t){t()}))}},isDownload:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1}},data:function(){return{mode:"import",btnoffsetTop:0,showFixBtn:!1,visible:!1,modelTypeVisible:!1,currentIndex:0,items:this.subject.items,allScore:0,allTypes:{},errorList:[],typeIndex:{all:[]},modelData:{title:this.t("itemImport.AddItem"),mode:"create",category:[],subject:{},type:""},fileName:this.subject.fileName||"",ids:this.subject.items.length,analysisTipClose:!0}},components:{judgeType:Q.a,singleChoice:V.a,choice:K.a,essay:B.a,fill:U.a,materialTitle:P.a,materialAnalysis:H.a,importData:G,importList:at,itemFooter:nt,itemManage:ot.a},watch:{items:{handler:function(t){this.formateItems(t)},deep:!0,immediate:!0}},provide:function(){return{showCKEditorData:this.showCKEditorData,showAttachment:Number(this.showAttachment),cdnHost:this.cdnHost,deleteAttachmentCallback:this.deleteAttachmentCallback,previewAttachmentCallback:this.previewAttachmentCallback,downloadAttachmentCallback:this.downloadAttachmentCallback,isDownload:this.isDownload,modeOrigin:"do"}},inject:["self"],created:function(){this.$on("previewFile",this.previewAttachment),this.$on("getDeleteFile",this.deleteAttachment),this.$on("downloadFile",this.downloadAttachment)},mounted:function(){var t=this,e={fileName:this.fileName,items:this.items};0==this.errorList.length&&this.$emit("getInitRepeatQuestion",e),this.$nextTick((function(){t.btnoffsetTop=t.$refs.ibsImportBtn.offsetTop-document.documentElement.clientHeight||document.body.clientHeight,window.addEventListener("scroll",t.changBtnFix)})),this.items.forEach((function(e,i){t.$set(t.items[i],"ids",i)})),this.$on("closeModal",this.closeModalData),this.formatMathAnswer()},methods:{formatMathAnswer:function(){var t=this,e=new rt.a(document.getElementById("math-editor-iframe-container"),"/static-dist/libs/math-editor/math-editor.html?".concat(window.app.version));e.on("ready",w()(lt().mark((function i(){var a,s,n,o,r,l,c,u,h,d,m,p,f,y,v,g,b;return lt().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:a=ct(t.items.entries()),i.prev=1,a.s();case 3:if((s=a.n()).done){i.next=48;break}n=R()(s.value,2),o=n[0],r=n[1],l=ct(r.questions.entries()),i.prev=6,l.s();case 8:if((c=l.n()).done){i.next=37;break}if(u=R()(c.value,2),h=u[0],"text"!==(d=u[1]).answer_mode){i.next=35;break}m=ct(d.answer.entries()),i.prev=12,m.s();case 14:if((p=m.n()).done){i.next=27;break}if(f=R()(p.value,2),y=f[0],v=f[1],!(g=v.match(/\$\$([^$]+)\$\$/))){i.next=25;break}return e.set(t.formatSpecialMathAnswer(g[1])),i.next=21,e.get();case 21:b=i.sent,d.stem=d.stem.replace("[[$$".concat(g[1],"$$]]"),"[[$$$".concat(b,"$$$]]")),d.answer[y]="$$".concat(b,"$$"),r.questions[h]=d;case 25:i.next=14;break;case 27:i.next=32;break;case 29:i.prev=29,i.t0=i.catch(12),m.e(i.t0);case 32:return i.prev=32,m.f(),i.finish(32);case 35:i.next=8;break;case 37:i.next=42;break;case 39:i.prev=39,i.t1=i.catch(6),l.e(i.t1);case 42:return i.prev=42,l.f(),i.finish(42);case 45:t.$set(t.items,o,r);case 46:i.next=3;break;case 48:i.next=53;break;case 50:i.prev=50,i.t2=i.catch(1),a.e(i.t2);case 53:return i.prev=53,a.f(),i.finish(53);case 56:t.renderFormula(),e.close();case 58:case"end":return i.stop()}}),i,null,[[1,50,53,56],[6,39,42,45],[12,29,32,35]])})))),e.open()},formatSpecialMathAnswer:function(t){return t=(t=t.replace(/\\mathrm\{([^}]*)\}/g,"$1 ")).replace("\\bot ","\\perp ")},formateItems:function(){var t=this;this.allTypes={},this.allScore=0,this.errorList=[],this.typeIndex={all:[]},this.items.forEach((function(e,i){t.totalScore(e),t.totalTypes(e),t.totalError(e,i),t.getTypeIndex(e,i)}))},totalScore:function(t){var e=this;"material"===t.type?t.questions.forEach((function(t){e.allScore+=j()(t.score)})):this.allScore+=j()(t.questions[0].score)},totalTypes:function(t){this.allTypes[t.type]?this.allTypes[t.type]=this.allTypes[t.type]+1:this.$set(this.allTypes,t.type,1)},totalError:function(t,e){("material"===t.type&&t.errors||t.questions[0].errors)&&this.errorList.push(e)},getTypeIndex:function(t){this.typeIndex[t.type]||this.$set(this.typeIndex,t.type,[]),this.typeIndex[t.type].push(t.ids),"material"!==t.type&&this.typeIndex.all.push(t.ids)},changBtnFix:function(){this.btnoffsetTop<(document.documentElement.clientHeight||document.body.clientHeight)||((window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)>=this.btnoffsetTop?this.showFixBtn=!1:this.showFixBtn=!0)},cancel:function(){this.visible=!1},handleOk:function(){this.visible=!1},handleCancel:function(){this.self.isWrong=!1},getContainer:function(){return document.getElementById("item-bank-sdk-import")},showEditModal:function(t,e){this.visible=!0,this.currentIndex=e,this.modelData.title=this.t("itemImport.EditItem"),this.modelData.mode="edit",this.modelData.category=this.category,this.modelData.subject=t,this.modelData.type=t.type,0==this.errorList.length&&this.$emit("editQuestion",t,this.items)},showCreateModal:function(t){this.modelData.title=this.t("itemImport.AddItem"),this.modelData.mode="create",this.modelData.category=this.category,this.modelData.type=t,this.modelTypeVisible=!1,this.visible=!0},createItem:function(t,e){this.currentIndex=e,this.modelTypeVisible=!0},getEditData:function(t){this.visible=!1,t.data.ids=this.items[this.currentIndex].ids,t.data.type=this.modelData.type,"material"===t.data.type&&this.checkMaterialError(t),this.$set(this.items,this.currentIndex,t.data)},checkMaterialError:function(t){var e=0;console.log(t),t.data.questions.forEach((function(t){t.errors&&(e+=1)})),console.log(e),e?t.data.errors={hasSubError:!0}:t.data.errors&&delete t.data.errors},getCreateData:function(t){this.visible=!1,this.ids+=1,t.data.ids=this.ids,t.data.type=this.modelData.type,this.items.splice(this.currentIndex+1,0,t.data)},getScore:function(t){if("material"===t.type)return this.t("itemImport.SubItem_all_score");var e=this.t("itemImport.Cell_Score");return"".concat(t.questions[0].score).concat(e)},deleteItem:function(t){var e=this;this.$confirm({title:this.t("itemImport.Confirm_delete"),content:this.t("itemImport.Confirm_delete_tip"),okText:this.t("confirm"),cancelText:this.t("cancel"),class:"ibs-text-left",onOk:function(){e.items.splice(t,1),e.getEditRepeatQuestion({fileName:e.fileName,items:e.items}),e.forceRemoveModalDom(),e.$emit("renderFormula")},onCancel:function(){e.forceRemoveModalDom()}})},forceRemoveModalDom:function(){var t=document.querySelector(".ibs-text-left").parentNode;t&&t.remove(),document.body.style=""},setScore:function(t,e,i){this.items.forEach((function(a){t.forEach((function(t){a.ids===t&&(a.questions[0].score=e,"choice"!==a.type&&"uncertain_choice"!==a.type||(a.questions[0].otherScore=i,a.questions[0].otherScore1=i,a.questions[0].scoreType="question"))}))}))},setDifficult:function(t,e){this.items.forEach((function(i){t.forEach((function(t){i.ids===t&&(i.difficulty=e)}))}))},setCategory:function(t,e,i){this.items.forEach((function(a){t.forEach((function(t){a.ids===t&&(a.category_id=e,a.category_name=i)}))}))},finishImport:function(){if(this.errorList.length){var t=this.errorList.map((function(t){return t+1})),e=this.t("itemImport.Order_Error")(t.join("、"));this.$message.error(e)}else if("testpaper"!==this.importType||this.fileName){var i={fileName:this.fileName,items:this.items};this.$emit("getRepeatQuestion",i)}else this.$message.error(this.t("itemImport.Title_tip"))},closeModalData:function(){this.visible=!1},deleteAttachment:function(t){var e=t.fileId?t.fileId:t,i=!!t.flag&&t.flag;if(i){var a=this.items[this.currentIndex];a.questions=a.questions.map((function(t){return t.attachments=t.attachments.filter((function(t){return t.id!==e})),t})),this.items.splice(this.currentIndex,1,a)}this.$emit("deleteAttachment",e,i)},previewAttachment:function(t){this.$emit("previewAttachment",t)},downloadAttachment:function(t){this.$emit("downloadAttachment",t)},changeEditor:function(t){this.$emit("changeEditor",t,this.items)},getEditRepeatQuestion:function(t){this.$emit("getEditRepeatQuestion",t)},getInitRepeatQuestion:function(){var t={fileName:this.fileName,items:this.items};this.$emit("getEditRepeatQuestion",t)},renderFormula:function(){this.$emit("renderFormula")},closeTip:function(){this.analysisTipClose=!1},changeAnalysis:function(t,e){var i=t.split("-"),a=R()(i,2),s=a[0],n=a[1],o=this.items[s];"material"!==o.type&&(o.analysis=e),o.questions[n].analysis=e,this.$set(this.items,s,o)}}},pt=Object(D.a)(mt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ibs-item-import",attrs:{id:"item-bank-sdk-import"}},[t.analysisTipClose?i("div",{staticClass:"ai-problem-analysis-tips",on:{click:t.closeTip}},[i("div",{staticClass:"ai-problem-analysis-tips-left"},[i("img",{attrs:{src:"/static-dist/app/img/question-bank/ai-analysis-tips-info.png",alt:""}}),t._v(" "),i("span",[t._v(t._s(t.t("itemEngine.aiAnalysisTips")))])]),t._v(" "),t._m(0)]):t._e(),t._v(" "),i("a-row",{staticClass:"ibs-item-import-content"},[i("a-col",{staticClass:"ibs-import-left",attrs:{span:6}},[i("import-data",{attrs:{totalItem:t.items.length,totalTypes:t.allTypes,allScore:t.allScore,importType:t.importType}}),t._v(" "),i("import-list",{attrs:{items:t.items,totalTypes:t.allTypes,typeIndex:t.typeIndex,category:t.category,errorList:t.errorList,repeatList:t.repeatList},on:{setCategory:t.setCategory,setDifficult:t.setDifficult,setScore:t.setScore}})],1),t._v(" "),t.items.length>0?i("a-col",{staticClass:"ibs-import-right",attrs:{span:17,offset:1}},["testpaper"===t.importType?i("div",{staticClass:"ibs-item-import-testpapername"},[i("a-input",{attrs:{placeholder:t.t("itemImport.SetTitle_tip")},model:{value:t.fileName,callback:function(e){t.fileName=e},expression:"fileName"}})],1):t._e(),t._v(" "),t._l(t.items,(function(e,a){return i("div",{key:a,attrs:{id:"ibs-import-"+a}},[i("div",{staticClass:"ibs-import-item"},[i("a-row",[i("a-col",{staticClass:"ibs-text-right ibs-mt16",attrs:{span:2}},[i("span",[t._v(t._s(a+1)+"、")])]),t._v(" "),i("a-col",{attrs:{span:22}},[i("material-title",{directives:[{name:"show",rawName:"v-show",value:"material"===e.type,expression:"item.type === 'material'"}],attrs:{material:e.material,item:t.items}}),t._v(" "),t._l(e.questions,(function(s,n){return i("div",{key:n+s.answer,staticClass:"ibs-pl16 ibs-pr16"},[i("a-row",[i("a-col",{directives:[{name:"show",rawName:"v-show",value:"material"===e.type,expression:"item.type === 'material'"}],staticClass:"ibs-text-right ibs-mt16",attrs:{span:2}},[i("span",[t._v("（"+t._s(n+1)+"） ")])]),t._v(" "),i("a-col",{attrs:{span:"material"===e.type?22:24}},["true_false"===s.answer_mode?i("judge-type",{attrs:{question:s,item:e,mode:t.mode,showScoreAndSeq:!1,seq:a+"-"+n},on:{changeAnalysis:t.changeAnalysis}}):t._e(),t._v(" "),"single_choice"===s.answer_mode?i("single-choice",{attrs:{question:s,item:e,mode:t.mode,showScoreAndSeq:!1,seq:a+"-"+n},on:{changeAnalysis:t.changeAnalysis}}):t._e(),t._v(" "),"choice"===s.answer_mode||"uncertain_choice"===s.answer_mode?i("choice",{attrs:{question:s,item:e,mode:t.mode,showScoreAndSeq:!1,seq:a+"-"+n},on:{changeAnalysis:t.changeAnalysis}}):t._e(),t._v(" "),"rich_text"===s.answer_mode?i("essay",{attrs:{question:s,item:e,mode:t.mode,showScoreAndSeq:!1,seq:a+"-"+n},on:{changeAnalysis:t.changeAnalysis}}):t._e(),t._v(" "),"text"===s.answer_mode?i("fill",{attrs:{question:s,item:e,mode:t.mode,showScoreAndSeq:!1,seq:a+"-"+n},on:{changeAnalysis:t.changeAnalysis}}):t._e()],1)],1)],1)})),t._v(" "),i("div",{staticClass:"ibs-import-material-analysis"},[i("material-analysis",{directives:[{name:"show",rawName:"v-show",value:"material"===e.type&&e.analysis,expression:"item.type === 'material' && item.analysis"}],attrs:{analysis:e.analysis,attachments:e.attachments}})],1),t._v(" "),i("a-row",{staticClass:"ibs-mt16"},[i("a-col",{attrs:{span:24}},[i("item-footer",{attrs:{categoryName:e.category_name,difficulty:e.difficulty,score:t.getScore(e)}}),t._v(" "),i("div",{staticClass:"ibs-sub-operation ibs-import-edit"},[i("a-button",{staticClass:"ibs-mr8 ibs-pl0",attrs:{type:"link"},on:{click:function(i){return t.showEditModal(e,a)}}},[i("i",{staticClass:"ib-icon ib-icon-setting"}),t._v(t._s(t.t("Edit")))]),t._v(" "),i("a-button",{staticClass:"ibs-mr8",attrs:{type:"link"},on:{click:function(e){return t.deleteItem(a)}}},[i("i",{staticClass:"ib-icon ib-icon-delete"}),t._v(t._s(t.t("Delete"))+"\n                    ")]),t._v(" "),i("a-button",{staticClass:"ibs-mr8",attrs:{type:"link"},on:{click:function(i){return t.createItem(e,a)}}},[i("i",{staticClass:"ib-icon ib-icon-add"}),t._v(t._s(t.t("itemImport.AfterAddItem"))+"\n                    ")])],1)],1)],1)],2)],1)],1)])})),t._v(" "),i("div",{ref:"ibsImportBtn",staticClass:"ibs-item-import__footer ibs-mb16"},[i("a-button",{staticClass:"ibs-item-import-btn",attrs:{type:"primary",disabled:t.errorList.length>0,loading:t.loading},on:{click:t.finishImport}},[t._v(t._s(t.t("itemImport.FinishImport")))])],1)],2):t._e()],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showFixBtn,expression:"showFixBtn"}],staticClass:"ibs-item-import__footer--fix"},[i("a-button",{staticClass:"ibs-item-import-btn",attrs:{type:"primary",disabled:t.errorList.length>0,loading:t.loading},on:{click:t.finishImport}},[t._v(t._s(t.t("itemImport.FinishImport")))])],1),t._v(" "),i("a-modal",{attrs:{title:t.modelData.title,width:"800px",cancelText:t.t("cancel"),bodyStyle:{textAlign:"left"},destroyOnClose:!0,footer:null,getContainer:t.getContainer},on:{ok:t.handleOk,cancel:t.handleCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},["edit"===t.modelData.mode?i("item-manage",{attrs:{showAttachment:t.showAttachment,showCKEditorData:t.showCKEditorData,deleteAttachmentCallback:t.deleteAttachmentCallback,previewAttachmentCallback:t.previewAttachmentCallback,mode:t.modelData.mode,cdnHost:"service-cdn.qiqiuyun.net",uploadSDKInitData:t.uploadSDKInitData,category:t.modelData.category,subject:t.modelData.subject,type:t.modelData.type,showModelBtn:!0,errorList:t.errorList,aiAnalysisEnable:t.aiAnalysisEnable},on:{deleteAttachment:t.deleteAttachment,previewAttachment:t.previewAttachment,renderFormula:t.renderFormula,getData:t.getEditData,changeEditor:t.changeEditor,getInitRepeatQuestion:t.getInitRepeatQuestion}}):t._e(),t._v(" "),"create"===t.modelData.mode?i("item-manage",{attrs:{showAttachment:t.showAttachment,showCKEditorData:t.showCKEditorData,cdnHost:"service-cdn.qiqiuyun.net",uploadSDKInitData:t.uploadSDKInitData,deleteAttachmentCallback:t.deleteAttachmentCallback,previewAttachmentCallback:t.previewAttachmentCallback,mode:t.modelData.mode,category:t.modelData.category,type:t.modelData.type,showModelBtn:!0,errorList:t.errorList,aiAnalysisEnable:t.aiAnalysisEnable},on:{deleteAttachment:t.deleteAttachment,previewAttachment:t.previewAttachment,renderFormula:t.renderFormula,getData:t.getCreateData,changeEditor:t.changeEditor,getInitRepeatQuestion:t.getInitRepeatQuestion}}):t._e()],1),t._v(" "),i("a-modal",{attrs:{title:t.t("itemImport.Add_new_item"),destroyOnClose:!0,footer:null,getContainer:t.getContainer},model:{value:t.modelTypeVisible,callback:function(e){t.modelTypeVisible=e},expression:"modelTypeVisible"}},[i("a-row",[i("a-col",{staticClass:"model-type-text",attrs:{span:4}},[t._v(t._s(t.t("itemImport.Choose_type")))]),t._v(" "),i("a-col",{attrs:{span:20}},[i("a-row",[i("a-col",{staticClass:"ibs-mb24",attrs:{span:8}},[i("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.showCreateModal("single_choice")}}},[t._v(t._s(t.t("single_choice")))])],1),t._v(" "),i("a-col",{staticClass:"ibs-mb24",attrs:{span:8}},[i("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.showCreateModal("choice")}}},[t._v(t._s(t.t("choice")))])],1),t._v(" "),i("a-col",{staticClass:"ibs-mb24",attrs:{span:8}},[i("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.showCreateModal("uncertain_choice")}}},[t._v(t._s(t.t("uncertain_choice_1")))])],1),t._v(" "),i("a-col",{staticClass:"ibs-mb24",attrs:{span:8}},[i("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.showCreateModal("determine")}}},[t._v(t._s(t.t("determine")))])],1),t._v(" "),i("a-col",{staticClass:"ibs-mb24",attrs:{span:8}},[i("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.showCreateModal("fill")}}},[t._v(t._s(t.t("fill")))])],1),t._v(" "),i("a-col",{staticClass:"ibs-mb24",attrs:{span:8}},[i("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.showCreateModal("essay")}}},[t._v(t._s(t.t("essay")))])],1),t._v(" "),i("a-col",{staticClass:"ibs-mb24",attrs:{span:8}},[i("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.showCreateModal("material")}}},[t._v(t._s(t.t("material")))])],1)],1)],1)],1)],1),t._v(" "),i("div",{staticClass:"hidden",attrs:{id:"math-editor-iframe-container"}})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ai-problem-analysis-tips-right"},[e("img",{attrs:{src:"/static-dist/app/img/question-bank/ai-analysis-tips-close.png",alt:""}})])}],!1,null,null,null).exports;Vue.config.productionTip=!1,Vue.component(pt.name,pt),new Vue({render:function(t){return t(C)}}).$mount("#app")},203:function(t,e,i){"use strict";var a=i(15),s=i.n(a),n=i(50),o=i.n(n),r=i(16),l=i.n(r),c=i(25),u=i.n(c),h=i(31),d=i.n(h),m=i(49),p=i.n(m),f=i(153),y=i(55),v=i(43),g=i(1649),b={name:"base-type",components:{attachmentUpload:f.a,APopconfirm:g.a},mixins:[y.a,v.a],data:function(){return{formLayout:"horizontal",difficultySelect:[{lable:this.t("Simple"),value:"simple"},{lable:this.t("Normal"),value:"normal"},{lable:this.t("Difficult"),value:"difficulty"}],material:{validateStatus:"",errorMsg:""},publicPath:Object({NODE_ENV:"production"}).BASE_URL,customStyle:"background: #ffffff;border: 0",materialEditor:"",analysisEditor:""}},created:function(){},inject:["subject","category","bank_id","showCKEditorData","showAttachment","uploadSDKInitData","cdnHost","self"],computed:{treeData:function(){var t=JSON.parse(u()(this.category));return this.formateCategory(t),t.unshift({value:0,title:this.t("None"),key:0}),t}},props:{form:{type:Object,default:function(){}},showMaterial:{type:Boolean,default:!1},showAnalysis:{type:Boolean,default:!1},showCategory:{type:Boolean,default:!0},showDifficulty:{type:Boolean,default:!0},mode:{type:String,default:"create"},isSubItem:{type:Boolean,default:!1},showModelBtn:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1},errorList:{type:Array,default:function(){return[]}}},mounted:function(){var t=this;this.$nextTick((function(){p()(t.showCKEditorData.jqueryPath,(function(e){e&&console.log(e),p()(t.showCKEditorData.publicPath,(function(e){e&&console.log(e),t.showMaterial&&(t.initBaseMaterial(),t.initBaseAnalysis())}))}))}))},methods:{formateCategory:function(t){var e=this;t.forEach((function(t){t.value=t.id,t.title=t.name,t.key="".concat(t.name).concat(t.id),t.children&&e.formateCategory(t.children)}))},setCategoryId:function(t,e){this.form.setFieldsValue(d()({},"base['category_name']",e[0])),this.form.setFieldsValue(d()({},"base['category_id']",t))},setDifficulty:function(t){this.form.setFieldsValue(d()({},"base['difficulty']",t.target.value))},initBaseMaterial:function(){var t=this;this.materialEditor=window.CKEDITOR.replace("base-question-type_base['material']",{toolbar:"Minimal",fileSingleSizeLimit:this.showCKEditorData.fileSingleSizeLimit,filebrowserImageUploadUrl:this.showCKEditorData.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:this.showCKEditorData.filebrowserImageDownloadUrl,language:this.showCKEditorData.language}),this.materialEditor.setData(this.subject.material),this.materialEditor.on("change",(function(){var e=t.materialEditor.getData();0==t.errorList.length&&t.$emit("changeEditor",e),t.form.setFieldsValue(d()({},"base['material']",e)),t.checkMaterial(e)})),this.materialEditor.on("blur",(function(){var e=t.materialEditor.getData();t.form.setFieldsValue(d()({},"base['material']",e)),t.checkMaterial(e)}))},initBaseAnalysis:function(){var t=this;this.analysisEditor=window.CKEDITOR.replace("base-question-type_base['analysis']",{toolbar:"Minimal",fileSingleSizeLimit:this.showCKEditorData.fileSingleSizeLimit,filebrowserImageUploadUrl:this.showCKEditorData.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:this.showCKEditorData.filebrowserImageDownloadUrl,language:this.showCKEditorData.language}),this.analysisEditor.setData(this.subject.analysis),this.analysisEditor.on("change",(function(){t.form.setFieldsValue(d()({},"base['analysis']",t.analysisEditor.getData())),t.analysis=t.analysisEditor.getData()})),this.analysisEditor.on("blur",(function(){t.form.setFieldsValue(d()({},"base['analysis']",t.analysisEditor.getData())),t.analysis=t.analysisEditor.getData()}))},checkMaterial:function(t){t?(this.material.validateStatus="",this.material.errorMsg=""):(this.material.validateStatus="error",this.material.errorMsg=this.t("itemManage.MaterialRule"))},handleSubmit:function(t){t.preventDefault(),this.dispatch("item-manage","changeAgain",!1),this.showMaterial&&this.checkMaterial(this.form.getFieldValue("base['material']")),this.$emit("getFromInfo")},handleSubmitAgain:function(t){t.preventDefault(),this.dispatch("item-manage","changeAgain",!0),this.showMaterial&&this.checkMaterial(this.form.getFieldValue("base['material']")),this.$emit("getFromInfo")},cancel:function(){this.dispatch("material","closeModal"),this.dispatch("item-import","closeModal")},toGoBack:function(){this.dispatch("item-manage","toGoBack")},getFileInfo:function(t){this.$emit("getMaterialAttachment",t)},deleteFile:function(t){this.$emit("deleteMaterialAttachment",t)},onFileSort:function(t){this.$emit("onFileSort",t)},getAttachmentTypeData:function(t){return"create"===this.mode?[]:this.subject.attachments.filter((function(e){return e.module==t}))},confirm:function(){this.$emit("clickConfirm"),document.getElementById("ib-treeSelect").scrollTo({behavior:"smooth",top:0})},cancelPopconfim:function(t){var e=this;t.preventDefault(),this.dispatch("item-manage","changeAgain",!1),this.showMaterial&&this.checkMaterial(this.form.getFieldValue("base['material']")),0==this.errorList.length&&this.$emit("getInitRepeatQuestion"),this.$nextTick((function(){e.$emit("renderFormula")})),this.$emit("closeConfirm"),this.$emit("getFromInfo")},handleData:function(t){this.cancelPopconfim(t)}}},w=i(22),_=Object(w.a)(b,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-bank-sdk ibs-base",attrs:{id:"ib-treeSelect"}},[i("a-form-item",{attrs:{label:"","label-col":{span:4},"wrapper-col":{span:16},required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["base['bank_id']",{initialValue:t.bank_id}],expression:"[\n        `base['bank_id']`,\n        {\n          initialValue: bank_id\n        }\n      ]"}],attrs:{type:"hidden"}})],1),t._v(" "),i("a-form-item",{directives:[{name:"show",rawName:"v-show",value:t.showCategory,expression:"showCategory"}],attrs:{label:t.t("itemManage.ItemCategory"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["base['category_id']",{initialValue:t.subject.category_id}],expression:"[\n        `base['category_id']`,\n        { initialValue: subject.category_id }\n      ]"}],staticStyle:{width:"200px"},attrs:{showSearch:"",dropdownStyle:{maxHeight:"400px",overflow:"auto"},treeData:t.treeData,getPopupContainer:function(e){return e.parentNode||t.document.body},treeNodeFilterProp:"title",placeholder:"Please select"},on:{change:t.setCategoryId}})],1),t._v(" "),i("a-form-item",{staticStyle:{marginBottom:"0"},attrs:{label:"","label-col":{span:0},"wrapper-col":{span:20}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["base['category_name']",{initialValue:""}],expression:"[`base['category_name']`, { initialValue: '' }]"}],attrs:{type:"hidden"}})],1),t._v(" "),i("a-form-item",{directives:[{name:"show",rawName:"v-show",value:t.showDifficulty,expression:"showDifficulty"}],attrs:{label:t.t("Difficulty"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["base['difficulty']",{initialValue:t.subject.difficulty}],expression:"[\n        `base['difficulty']`,\n        { initialValue: subject.difficulty }\n      ]"}],attrs:{name:"radioGroup"},on:{change:t.setDifficulty}},t._l(t.difficultySelect,(function(e,a){return i("a-radio",{key:a,attrs:{value:e.value}},[t._v(t._s(e.lable))])})),1)],1),t._v(" "),t.showMaterial?i("a-form-item",{attrs:{label:t.t("itemManage.MaterialLabel"),"label-col":{span:4},"wrapper-col":{span:16},required:"","validate-status":t.material.validateStatus,help:t.material.errorMsg}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["base['material']",{initialValue:t.subject.material,rules:[{required:!0}]}],expression:"[\n        `base['material']`,\n        { initialValue: subject.material, rules: [{ required: true }] }\n      ]"}],attrs:{rows:0,"data-image-download-url":t.showCKEditorData.filebrowserImageDownloadUrl}})],1):t._e(),t._v(" "),t.showMaterial&&t.showAttachment?i("a-form-item",{attrs:{label:t.t("itemManage.MaterialAttachment"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("attachment-upload",{attrs:{bodyDom:"item-bank-create",module:"material",mode:t.mode,fileShowData:t.getAttachmentTypeData("material"),cdnHost:t.cdnHost,uploaderData:t.uploadSDKInitData},on:{onFileSort:t.onFileSort,deleteFile:t.deleteFile,getFileInfo:t.getFileInfo}})],1):t._e(),t._v(" "),t._t("questions"),t._v(" "),i("a-collapse",{directives:[{name:"show",rawName:"v-show",value:t.showAnalysis,expression:"showAnalysis"}],attrs:{bordered:!1},scopedSlots:t._u([{key:"expandIcon",fn:function(t){return[i("div",{attrs:{rotate:t.isActive?90:0}})]}}])},[t._v(" "),i("a-collapse-panel",{key:"1",style:t.customStyle,attrs:{header:t.t("itemManage.ToggleShowChoose"),forceRender:!0}},[i("a-form-item",{attrs:{label:t.t("Explain"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["base['analysis']",{initialValue:t.subject.analysis}],expression:"[\n            `base['analysis']`,\n            { initialValue: subject.analysis }\n          ]"}],attrs:{rows:4,"data-image-download-url":t.showCKEditorData.filebrowserImageDownloadUrl}})],1),t._v(" "),t.showAttachment?i("a-form-item",{attrs:{label:t.t("ExplainAttachment"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("attachment-upload",{attrs:{bodyDom:"item-bank-create",mode:t.mode,module:"analysis",cdnHost:t.cdnHost,uploaderData:t.uploadSDKInitData,fileShowData:t.getAttachmentTypeData("analysis")},on:{onFileSort:t.onFileSort,deleteFile:t.deleteFile,getFileInfo:t.getFileInfo}})],1):t._e()],1)],1),t._v(" "),t._t("subQuestions"),t._v(" "),t.isSubItem||t.showModelBtn?i("a-form-item",{staticClass:"ibs-base-footer",attrs:{"wrapper-col":{span:8,offset:16}}},[t.self.isWrong?i("a-popconfirm",{attrs:{placement:"topRight",title:t.t("questionPopconfimTitle"),"ok-text":t.t("ContinueEditing"),okType:"primary","cancel-text":t.t("DirectCreation")},on:{confirm:t.confirm,cancel:function(e){return t.cancelPopconfim(e)}}},[i("a-icon",{attrs:{slot:"icon",type:"exclamation-circle"},slot:"icon"}),t._v(" "),i("a-button",{staticClass:"ibs-base--save",attrs:{type:"primary",disabled:t.isDisable}},[t._v("\n        "+t._s(t.t("Save"))+"\n      ")])],1):i("a-button",{staticClass:"ibs-base--save",attrs:{type:"primary",disabled:t.isDisable},on:{click:t.handleData}},[t._v("\n      "+t._s(t.t("Save"))+"\n    ")]),t._v(" "),i("a-button",{attrs:{type:"link"},on:{click:t.cancel}},[t._v(t._s(t.t("cancel")))])],1):i("a-form-item",{staticClass:"ibs-base-footer",attrs:{"wrapper-col":{span:12,offset:4}}},["create"==t.mode?i("a-button",{attrs:{type:"primary",disabled:t.isDisable},on:{click:t.handleSubmitAgain}},[t._v(t._s(t.t("itemManage.SaveThenAdd")))]):t._e(),t._v(" "),i("a-button",{staticClass:"ibs-base--save",attrs:{type:"primary",disabled:t.isDisable},on:{click:t.handleSubmit}},[t._v("\n      "+t._s(t.t("Save"))+"\n    ")]),t._v(" "),i("a-button",{attrs:{type:"link"},on:{click:t.toGoBack}},[t._v(t._s(t.t("Back")))])],1)],2)}),[],!1,null,null,null).exports,x=i(247),k={stem:"",seq:5,score:"2.0",answer:[],analysis:"",attachments:[]},S={name:"answer-model",components:{baseType:_,attachmentUpload:f.a,AiAnalysis:x.a},mixins:[y.a,v.a],data:function(){return{stem:{validateStatus:"",errorMsg:""},customStyle:"background: #ffffff;border: 0",publicPath:Object({NODE_ENV:"production"}).BASE_URL,stemEditor:"",analysisEditor:"",inheritAttrs:!1,scoreTypeHelp:"",scoreTypeValidateStatus:"success",isWrong:!1}},props:{questions:{type:Object,default:function(){return k}},form:{type:Object,default:function(){}},itemType:{type:String,default:""},mode:{type:String,default:"create"},isDisable:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1},answer:{type:Array,default:function(){return[]}},errorList:{type:Array,default:function(){return[]}}},inject:["showCKEditorData","showAttachment","uploadSDKInitData","cdnHost"],created:function(){},mounted:function(){var t=this;this.$nextTick((function(){p()(t.showCKEditorData.jqueryPath,(function(e){e&&console.log(e),p()(t.showCKEditorData.publicPath,(function(e){e&&console.log(e),"fill"!==t.itemType&&t.initBaseStem(),t.initBaseAnalysis()}))}))}))},methods:{initBaseStem:function(){var t=this;this.stemEditor=window.CKEDITOR.replace("base-question-type_questions['stem']",{toolbar:"Minimal",fileSingleSizeLimit:this.showCKEditorData.fileSingleSizeLimit,filebrowserImageUploadUrl:this.showCKEditorData.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:this.showCKEditorData.filebrowserImageDownloadUrl,language:this.showCKEditorData.language}),this.stemEditor.setData(this.questions.stem),this.stemEditor.on("change",(function(){var e=t.stemEditor.getData();0==t.errorList.length&&t.$emit("changeEditor",e),t.form.setFieldsValue(d()({},"questions['stem']",e)),t.checkStem(e)})),this.stemEditor.on("blur",(function(){var e=t.stemEditor.getData();t.form.setFieldsValue(d()({},"questions['stem']",e)),t.checkStem(e)}))},initBaseAnalysis:function(){var t=this;this.analysisEditor=window.CKEDITOR.replace("base-question-type_questions['analysis']",{toolbar:"Minimal",fileSingleSizeLimit:this.showCKEditorData.fileSingleSizeLimit,filebrowserImageUploadUrl:this.showCKEditorData.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:this.showCKEditorData.filebrowserImageDownloadUrl,language:this.showCKEditorData.language}),this.analysisEditor.setData(this.questions.analysis),this.analysisEditor.on("change",(function(){t.form.setFieldsValue(d()({},"questions['analysis']",t.analysisEditor.getData())),t.outanalysis=t.analysisEditor.getData()})),this.analysisEditor.on("blur",(function(){t.form.setFieldsValue(d()({},"questions['analysis']",t.analysisEditor.getData())),t.outanalysis=t.analysisEditor.getData()}))},checkScore:function(t,e,i){e<0?i(this.t("ScoreRule.one")):e>999?i(this.t("ScoreRule.two")):/^(([1-9]{1}\d{0,2})|([0]{1}))(\.(\d){1})?$/.test(e)?i():i(this.t("ScoreRule.three"))},checkOtherScore:function(t,e,i){var a=this.form.getFieldsValue(["questions['score']","questions['otherScore1']","questions['otherScore2']","questions['scoreType']"]).questions,s=a.score,n=a.otherScore1,o=a.otherScore2,r=a.scoreType;if("question"===r&&n>s){var l="漏选得分不得大于总分";return this.scoreTypeHelp=l,this.scoreTypeValidateStatus="error",void i(l)}var c=o*this.answer.length;if("option"===r&&c>s){var u="每项得分乘以正确选项数不得大于总分";return this.scoreTypeHelp=u,this.scoreTypeValidateStatus="error",void i(u)}this.scoreTypeHelp="",this.scoreTypeValidateStatus="success",i()},checkStem:function(t){t?(this.stem.validateStatus="",this.stem.errorMsg=""):(this.stem.validateStatus="error",this.stem.errorMsg=this.t("itemManage.StemRule"))},getFromInfo:function(){this.checkStem(this.form.getFieldValue("questions['stem']")),this.$emit("getFromInfo")},getFileInfo:function(t){this.questions.attachments.push(t),this.$emit("getUploadFile",t)},onFileSort:function(t){this.$set(this.questions,"attachments",t)},deleteFile:function(t){var e=this.questions.attachments.filter((function(e){return e.id!==t}));this.$set(this.questions,"attachments",e)},getAttachmentTypeData:function(t){return"create"===this.mode?[]:this.questions.attachments.filter((function(e){return e.module==t}))},clickConfirm:function(){this.isWrong=!0},closeConfirm:function(){this.isWrong=!1},getInitRepeatQuestion:function(){this.$emit("getInitRepeatQuestion")},renderFormula:function(){this.$emit("renderFormula")},prepareTeacherAiAnalysis:function(t){var e=this;this.form.validateFields((function(i){i?e.getFromInfo():e.$emit("prepareTeacherAiAnalysis",t)}))},clearAnalysis:function(){this.analysisEditor.setData("")},appendAnalysis:function(t){this.analysisEditor.insertHtml(t)}}},E=Object(w.a)(S,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("base-type",t._b({attrs:{form:t.form,mode:t.mode,isDisable:t.isDisable,errorList:t.errorList},on:{getFromInfo:t.getFromInfo,clickConfirm:t.clickConfirm,closeConfirm:t.closeConfirm,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion},scopedSlots:t._u([{key:"questions",fn:function(){return[t._t("stem",[i("a-form-item",{attrs:{label:t.t("Stem"),"label-col":{span:4},"wrapper-col":{span:16},required:"","validate-status":t.stem.validateStatus,help:t.stem.errorMsg}},[i("div",{class:{"is-wrong":t.isWrong}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['stem']",{initialValue:t.questions.stem,rules:[{required:!0}]}],expression:"[\n              `questions['stem']`,\n              {\n                initialValue: questions.stem,\n                rules: [{ required: true }]\n              }\n            ]"}],attrs:{"data-image-download-url":t.showCKEditorData.filebrowserImageDownloadUrl,rows:0}}),t._v(" "),t.isWrong?i("div",{staticClass:"wrong-text"},[t._v("\n            "+t._s(t.t("wrongText"))+"\n          ")]):t._e()],1)])]),t._v(" "),t.showAttachment?i("a-form-item",{attrs:{label:t.t("itemManage.StemAttachment"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("attachment-upload",{attrs:{bodyDom:"item-bank-create",mode:t.mode,module:"stem",fileShowData:t.getAttachmentTypeData("stem"),cdnHost:t.cdnHost,uploaderData:t.uploadSDKInitData},on:{deleteFile:t.deleteFile,onFileSort:t.onFileSort,getFileInfo:t.getFileInfo}})],1):t._e(),t._v(" "),t._t("response_points"),t._v(" "),i("a-collapse",{attrs:{bordered:!1},scopedSlots:t._u([{key:"expandIcon",fn:function(t){return[i("div",{attrs:{rotate:t.isActive?90:0}})]}}])},[t._v(" "),i("a-collapse-panel",{key:"1",style:t.customStyle,attrs:{header:t.t("itemManage.ToggleShowChoose"),forceRender:!0}},[i("a-form-item",{attrs:{label:t.t("Explain"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['analysis']",{initialValue:t.questions.analysis}],expression:"[\n              `questions['analysis']`,\n              { initialValue: questions.analysis }\n            ]"}],attrs:{rows:4,"data-image-download-url":t.showCKEditorData.filebrowserImageDownloadUrl}}),t._v(" "),t.aiAnalysisEnable&&!1!==t.questions.aiAnalysisEnable?i("ai-analysis",{on:{prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis,clearAnalysis:t.clearAnalysis,appendAnalysis:t.appendAnalysis}}):t._e()],1),t._v(" "),t.showAttachment?i("a-form-item",{attrs:{label:t.t("ExplainAttachment"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("attachment-upload",{attrs:{bodyDom:"item-bank-create",mode:t.mode,module:"analysis",cdnHost:t.cdnHost,uploaderData:t.uploadSDKInitData,fileShowData:t.getAttachmentTypeData("analysis")},on:{deleteFile:t.deleteFile,onFileSort:t.onFileSort,getFileInfo:t.getFileInfo}})],1):t._e(),t._v(" "),"fill"===t.itemType?i("a-form-item",{attrs:{label:t.t("Score"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['otherScore']",{rules:[{validator:t.checkScore}],initialValue:t.questions.otherScore||2}],expression:"[\n              `questions['otherScore']`,\n              {\n                rules: [{ validator: checkScore }],\n                initialValue: questions.otherScore || 2\n              }\n            ]"}],staticStyle:{width:"200px"},attrs:{type:"number"}})],1):i("a-form-item",{attrs:{label:t.t("Score"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['score']",{rules:[{validator:t.checkScore}],initialValue:t.questions.score||2}],expression:"[\n              `questions['score']`,\n              {\n                rules: [{ validator: checkScore }],\n                initialValue: questions.score || 2\n              }\n            ]"}],staticStyle:{width:"200px"},attrs:{type:"number"}})],1),t._v(" "),["choice","uncertain_choice"].includes(t.itemType)?i("a-form-item",{attrs:{"wrapper-col":{span:16,offset:4},help:t.scoreTypeHelp,"validate-status":t.scoreTypeValidateStatus}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['scoreType']",{rules:[{validator:t.checkOtherScore}],initialValue:t.questions.scoreType}],expression:"[\n              `questions['scoreType']`,\n              {\n                rules: [{ validator: checkOtherScore }],\n                initialValue: questions.scoreType\n              }\n            ]"}],attrs:{name:"scoreType"}},[i("a-radio",{attrs:{value:"question"}},[t._v("\n              漏选得分\n              "),i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['otherScore1']",{initialValue:"question"===t.questions.scoreType?t.questions.otherScore:0}],expression:"[\n                  `questions['otherScore1']`,\n                  {\n                    initialValue:\n                      questions.scoreType === 'question'\n                        ? questions.otherScore\n                        : 0\n                  }\n                ]"}],attrs:{min:0}})],1),t._v(" "),i("a-radio",{attrs:{value:"option"}},[t._v("\n              每个正确选项得分\n              "),i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['otherScore2']",{initialValue:"option"===t.questions.scoreType?t.questions.otherScore:0}],expression:"[\n                  `questions['otherScore2']`,\n                  {\n                    initialValue:\n                      questions.scoreType === 'option'\n                        ? questions.otherScore\n                        : 0\n                  }\n                ]"}],attrs:{min:0}})],1)],1)],1):t._e(),t._v(" "),"fill"===t.itemType?i("a-form-item",{attrs:{"wrapper-col":{span:16,offset:4}}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['scoreType']",{initialValue:t.questions.scoreType||"question"}],expression:"[\n              `questions['scoreType']`,\n              {\n                initialValue: questions.scoreType || 'question'\n              }\n            ]"}],attrs:{name:"scoreType"}},[i("a-radio",{attrs:{value:"question"}},[t._v("\n              每题得分\n            ")]),t._v(" "),i("a-radio",{attrs:{value:"option"}},[t._v("\n              每空得分\n            ")])],1)],1):t._e()],1)],1)]},proxy:!0}],null,!0)},"base-type",t.$attrs,!1))}),[],!1,null,null,null).exports,A={stem:"",score:2,answer:[],analysis:"",answer_mode:"true_false",attachments:[]},D={name:"judge",mixins:[y.a,v.a],components:{answerModel:E},data:function(){return{form:this.$form.createForm(this,{name:"base-question-type"}),responseoints:{response_points:[{radio:{val:"T",text:this.t("Right")}},{radio:{val:"F",text:this.t("Wrong")}}]}}},inject:["bank_id","subject"],props:{subQuestions:{type:Object,default:function(){return s()(A,this.responseoints)}},isSubItem:{type:Boolean,default:!1},mode:{type:String,default:"create"},isDisable:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1},errorList:{type:Array,default:function(){return[]}}},computed:{questions:function(){return"edit"===this.mode?this.isSubItem?this.subQuestions:this.subject.questions[0]:s()(A,this.responseoints)},answer:function(){return this.questions.answer.length?this.questions.answer[0]:""},questionsSelect:function(){return this.questions.response_points}},methods:{setAnswer:function(t){this.form.setFieldsValue({answer:t.target.value})},checkJudge:function(t,e,i){e?i():i(this.t("itemManage.judgeRule"))},getFromInfo:function(){var t=this;this.form.validateFieldsAndScroll((function(e,i){e||t.formateData(i)}))},formateData:function(t){var e=JSON.parse(u()(this.questions));if(e.errors&&delete e.errors,this.isSubItem){var i={};(e=s()(e,t.questions)).answer=[t.answer],i.questions=[e],this.$emit("patchData",i)}else{var a=JSON.parse(u()(this.subject));a=s()(a,t.base),(e=s()(e,t.questions)).answer=[t.answer],e.answer_mode="true_false",a.questions=[e],console.log(a),this.$emit("patchData",a)}},changeEditor:function(t){this.$emit("changeEditor",t)},getInitRepeatQuestion:function(){this.$emit("getInitRepeatQuestion")},renderFormula:function(){this.$emit("renderFormula")},prepareTeacherAiAnalysis:function(t){var e=this,i={};this.form.validateFieldsAndScroll((function(a,n){if(!a){var o=JSON.parse(u()(e.questions));o=s()(o,n.questions),i.stem=o.stem,i.answer="T"===n.answer?"正确":"错误",e.isSubItem?(i.type="material-determine",e.$emit("prepareTeacherAiAnalysis",i,t)):(i.type="determine",t(i))}}))}}},C=Object(w.a)(D,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-form",{attrs:{form:t.form}},[i("answer-model",t._b({attrs:{questions:t.questions,form:t.form,mode:t.mode,isSubItem:t.isSubItem,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{getFromInfo:t.getFromInfo,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis},scopedSlots:t._u([{key:"response_points",fn:function(){return[i("a-form-item",{attrs:{label:t.t("Answer"),"label-col":{span:4},"wrapper-col":{span:16},required:""}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["answer",{initialValue:t.answer,rules:[{validator:t.checkJudge}],trigger:"blur"}],expression:"[\n            'answer',\n            {\n              initialValue: answer,\n              rules: [{ validator: checkJudge }],\n              trigger: 'blur'\n            }\n          ]"}],attrs:{name:"radioGroup"},on:{change:t.setAnswer}},t._l(t.questionsSelect,(function(e,a){return i("a-radio",{key:a,attrs:{value:e.radio.val}},[t._v(t._s(e.radio.text)+"\n          ")])})),1)],1)]},proxy:!0}])},"answer-model",t.$attrs,!1))],1)}),[],!1,null,null,null).exports,I={stem:"",score:2,response_points:[{radio:{val:0,text:""}},{radio:{val:1,text:""}},{radio:{val:2,text:""}},{radio:{val:3,text:""}}],answer:[""],analysis:"",answer_mode:"single_choice",attachments:[]},q={name:"single-choice",mixins:[y.a,v.a],components:{answerModel:E},inject:["subject","showCKEditorData"],data:function(){return{publicPath:Object({NODE_ENV:"production"}).BASE_URL,questions:{},form:this.$form.createForm(this,{name:"base-question-type"}),optionsEditor:{},optionsEditorRule:{},answer:"",optionsIndex:{A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19},optionKey:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T"]}},props:{subQuestions:{type:Object,default:function(){return I}},isSubItem:{type:Boolean,default:!1},mode:{type:String,default:"create"},optionsConfiguration:{type:Object,default:function(){return{maxItem:20,minItem:2}}},isDisable:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1},errorList:{type:Array,default:function(){return[]}}},created:function(){this.initData()},mounted:function(){var t=this;this.$nextTick((function(){p()(t.showCKEditorData.jqueryPath,(function(e){e&&console.log(e),p()(t.showCKEditorData.publicPath,(function(e){e&&console.log(e),t.initEdit()}))}))}))},methods:{getQuestions:function(){return"edit"===this.mode?this.isSubItem?this.subQuestions:this.subject.questions[0]:I},setAnswer:function(t){this.answer=t.target.value},getQuestionsSelect:function(){var t=JSON.parse(u()(this.questions.response_points));return"edit"===this.mode&&t.forEach((function(t,e){t.radio.val=e})),t},getAnswer:function(){return"edit"===this.mode?this.optionsIndex[this.questions.answer[0]]:""},initData:function(){this.questions=this.getQuestions(),this.answer=this.getAnswer(),this.form.getFieldDecorator("keys",{initialValue:this.getQuestionsSelect(),preserve:!0}),this.initOptionsEditorRule()},initEdit:function(){var t=this;this.form.getFieldValue("keys").forEach((function(e){t.initOptionsEditorRule(e.radio.val),t.optionsEditor["".concat(e.radio.val)]||(t.optionsEditor["".concat(e.radio.val)]=window.CKEDITOR.replace("base-question-type_options[".concat(e.radio.val,"]"),{toolbar:"Minimal",fileSingleSizeLimit:t.showCKEditorData.fileSingleSizeLimit,filebrowserImageUploadUrl:t.showCKEditorData.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:t.showCKEditorData.filebrowserImageDownloadUrl,language:t.showCKEditorData.language,height:120}),t.optionsEditor["".concat(e.radio.val)].on("change",(function(){var i=t.optionsEditor["".concat(e.radio.val)].getData();t.form.setFieldsValue(d()({},"options[".concat(e.radio.val,"]"),i)),t.checkOptionText(e.radio.val,i)})),t.optionsEditor["".concat(e.radio.val)].on("blur",(function(){var i=t.optionsEditor["".concat(e.radio.val)].getData();t.form.setFieldsValue(d()({},"options[".concat(e.radio.val,"]"),i)),t.checkOptionText(e.radio.val,i)})))}))},initOptionsEditorRule:function(){var t=this;this.form.getFieldValue("keys").forEach((function(e){t.optionsEditorRule["".concat(e.radio.val)]||(t.optionsEditorRule["".concat(e.radio.val)]={validateStatus:"",errorMsg:""})}))},checkOptionText:function(t,e){var i={validateStatus:"",errorMsg:""};e||(i.validateStatus="error",i.errorMsg=this.t("itemManage.chooseRule.one")),this.$set(this.optionsEditorRule,t,i)},checkAllOptionText:function(){var t=this;this.form.getFieldValue("keys").forEach((function(e){var i=t.form.getFieldValue("options[".concat(e.radio.val,"]"));t.checkOptionText(e.radio.val,i)}))},checkAnswer:function(){return!(!this.answer&&0!==this.answer)||(this.$message.error(this.t("itemManage.chooseRule.two")),!1)},add:function(){var t=this,e=this.form.getFieldValue("keys");if(e.length>=this.optionsConfiguration.maxItem)this.$message.error(this.t("itemManage.chooseRule.three"));else{var i=e[e.length-1].radio.val+1,a=e.concat({radio:{val:i,text:""}});this.form.setFieldsValue({keys:a}),this.initOptionsEditorRule(),this.$nextTick((function(){t.initEdit()}))}},remove:function(t,e){var i=this.form.getFieldValue("keys");i.length<=this.optionsConfiguration.minItem?this.$message.error(this.t("itemManage.chooseRule.four")):(this.form.setFieldsValue({keys:i.filter((function(t){return t.radio.val!==e.radio.val}))}),this.answer===e.radio.val&&(this.answer=""),this.optionsEditor[e.radio.val]=null)},getFromInfo:function(){var t=this;this.checkAllOptionText(),this.form.validateFieldsAndScroll((function(e,i){e||t.checkAnswer()&&t.formateData(i)}))},formatetAnswer:function(t){var e=this,i=[];return t.forEach((function(t,a){e.answer===t.radio.val&&i.push(e.optionKey[a])})),i},formateOptions:function(t){var e=this,i=[];return(t=t.filter((function(t){return t}))).forEach((function(t,a){i.push({radio:{val:e.optionKey[a],text:t}})})),i},formateData:function(t){var e=JSON.parse(u()(this.questions));if(e.errors&&delete e.errors,this.isSubItem){var i={};(e=s()(e,t.questions)).response_points=this.formateOptions(t.options),e.answer=this.formatetAnswer(t.keys),i.questions=[e],this.$emit("patchData",i)}else{var a=JSON.parse(u()(this.subject));a=s()(a,t.base),(e=s()(e,t.questions)).response_points=this.formateOptions(t.options),e.answer=this.formatetAnswer(t.keys),e.answer_mode="single_choice",a.questions=[e],this.$emit("patchData",a),console.log(a)}},getChoiceLabelNum:function(t){var e=this.t("itemManage.chooseItem");return"".concat(e).concat(t)},changeEditor:function(t){this.$emit("changeEditor",t)},getInitRepeatQuestion:function(){this.$emit("getInitRepeatQuestion")},renderFormula:function(){this.$emit("renderFormula")},prepareTeacherAiAnalysis:function(t){var e=this;this.form.validateFieldsAndScroll((function(i,a){if(!i){var n={},o=JSON.parse(u()(e.questions));o=s()(o,a.questions),n.stem=o.stem,n.options=[],a.options.forEach((function(t,i){n.options.push("".concat(e.optionKey[i],".").concat(t))})),n.answer=e.formatetAnswer(a.keys).join(),e.isSubItem?(n.type="material-choice",e.$emit("prepareTeacherAiAnalysis",n,t)):(n.type="choice",t(n))}}))}}},T=q,F=Object(w.a)(T,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-form",{attrs:{form:t.form}},[i("answer-model",t._b({attrs:{questions:t.questions,mode:t.mode,form:t.form,isSubItem:t.isSubItem,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{getFromInfo:t.getFromInfo,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis},scopedSlots:t._u([{key:"response_points",fn:function(){return[i("div",{staticClass:"ibs-choice-wrap"},[i("a-radio-group",{attrs:{name:"radioGroup"},on:{change:t.setAnswer},model:{value:t.answer,callback:function(e){t.answer=e},expression:"answer"}},t._l(t.form.getFieldValue("keys"),(function(e,a){return i("a-form-item",{key:e.radio.val,staticClass:"choice-item",attrs:{label:t.getChoiceLabelNum(t.optionKey[a]),required:"","label-col":{span:4},"wrapper-col":{span:16},"validate-status":t.optionsEditorRule[e.radio.val].validateStatus||"",help:t.optionsEditorRule[e.radio.val].errorMsg||""}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["options["+e.radio.val+"]",{initialValue:e.radio.text,rules:[{required:!0}]}],expression:"[\n                `options[${k.radio.val}]`,\n                {\n                  initialValue: k.radio.text,\n                  rules: [{ required: true }]\n                }\n              ]"}],attrs:{"data-image-download-url":t.showCKEditorData.filebrowserImageDownloadUrl,placeholder:"",rows:0}}),t._v(" "),i("a-radio",{attrs:{value:e.radio.val}},[t._v(t._s(t.t("RightAnswer")))]),t._v(" "),i("a-button",{staticClass:"ibs-delete-btn",attrs:{size:"small"},on:{click:function(){return t.remove(a,e)}}},[i("i",{staticClass:"ib-icon ib-icon-delete"})])],1)})),1),t._v(" "),i("a-row",[i("a-col",{staticClass:"ibs-text-right",attrs:{offset:4,span:16}},[i("a-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v(t._s(t.t("itemManage.newChoice")))])],1)],1)],1)]},proxy:!0}])},"answer-model",t.$attrs,!1))],1)}),[],!1,null,null,null).exports,$={stem:"",score:2,response_points:[{rich_text:{}}],answer:[],analysis:"",answer_mode:"rich_text",attachments:[]},M={name:"essay",mixins:[y.a,v.a],components:{answerModel:E},data:function(){return{answerText:{validateStatus:"",errorMsg:""},publicPath:Object({NODE_ENV:"production"}).BASE_URL,form:this.$form.createForm(this,{name:"base-question-type"})}},inject:["bank_id","subject","showCKEditorData"],props:{subQuestions:{type:Object,default:function(){return $}},isSubItem:{type:Boolean,default:!1},mode:{type:String,default:"create"},isDisable:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1},errorList:{type:Array,default:function(){return[]}}},computed:{questions:function(){return"edit"===this.mode?this.isSubItem?this.subQuestions:this.subject.questions[0]:$},answer:function(){return this.questions.answer.length?this.questions.answer[0]:""},questionsSelect:function(){return this.questions.response_points}},mounted:function(){var t=this;this.$nextTick((function(){p()(t.showCKEditorData.jqueryPath,(function(e){e&&console.log(e),p()(t.showCKEditorData.publicPath,(function(e){e&&console.log(e),t.initAnswer()}))}))}))},methods:{initAnswer:function(){var t=this;this.answerEditor=window.CKEDITOR.replace("base-question-type_questions['answer']",{toolbar:"Minimal",fileSingleSizeLimit:this.showCKEditorData.fileSingleSizeLimit,filebrowserImageUploadUrl:this.showCKEditorData.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:this.showCKEditorData.filebrowserImageDownloadUrl,language:this.showCKEditorData.language}),this.answerEditor.setData(this.answer),this.answerEditor.on("change",(function(){var e=t.answerEditor.getData();t.form.setFieldsValue(d()({},"questions['answer']",e)),t.checkAnswer(e)})),this.answerEditor.on("blur",(function(){var e=t.answerEditor.getData();t.form.setFieldsValue(d()({},"questions['answer']",e)),t.checkAnswer(e)}))},checkAnswer:function(t){t?(this.answerText.validateStatus="",this.answerText.errorMsg=""):(this.answerText.validateStatus="error",this.answerText.errorMsg=this.t("itemManage.essayRule"))},getFromInfo:function(){var t=this;this.checkAnswer(this.form.getFieldValue("questions['answer']")),this.form.validateFieldsAndScroll((function(e,i){e||t.formateData(i)}))},formateData:function(t){var e=JSON.parse(u()(this.questions));if(e.errors&&delete e.errors,this.isSubItem){var i={};(e=s()(e,t.questions)).answer=[].concat(e.answer),i.questions=[e],this.$emit("patchData",i)}else{var a=JSON.parse(u()(this.subject));a=s()(a,t.base);(e=s()(e,t.questions)).answer=[].concat(e.answer),e.answer_mode="rich_text",a.questions=[e],this.$emit("patchData",a)}},changeEditor:function(t){this.$emit("changeEditor",t)},getInitRepeatQuestion:function(){this.$emit("getInitRepeatQuestion")},renderFormula:function(){this.$emit("renderFormula")},prepareTeacherAiAnalysis:function(t){var e=this;this.form.validateFieldsAndScroll((function(i,a){if(!i){var n={},o=JSON.parse(u()(e.questions));o=s()(o,a.questions),n.answer=[].concat(o.answer).join(),n.stem=o.stem,e.isSubItem?(n.type="material-essay",e.$emit("prepareTeacherAiAnalysis",n,t)):(n.type="essay",t(n))}}))}}},L=Object(w.a)(M,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-form",{attrs:{form:t.form}},[i("answer-model",t._b({attrs:{questions:t.questions,form:t.form,mode:t.mode,isSubItem:t.isSubItem,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{getFromInfo:t.getFromInfo,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis},scopedSlots:t._u([{key:"response_points",fn:function(){return[i("a-form-item",{attrs:{label:t.t("Answer"),"label-col":{span:4},"wrapper-col":{span:16},required:"","validate-status":t.answerText.validateStatus,help:t.answerText.errorMsg}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['answer']",{initialValue:t.answer,rules:[{required:!0}]}],expression:"[\n            `questions['answer']`,\n            {\n              initialValue: answer,\n              rules: [{ required: true }]\n            }\n          ]"}],attrs:{rows:0,"data-image-download-url":t.showCKEditorData.filebrowserImageDownloadUrl}})],1)]},proxy:!0}])},"answer-model",t.$attrs,!1))],1)}),[],!1,null,null,null).exports,O={stem:"",score:2,response_points:[],answer:[],analysis:"",answer_mode:"text",attachments:[],case_sensitive:!0,scoreType:"question",otherScore:2},j={name:"fill",mixins:[y.a,v.a],components:{answerModel:E},data:function(){return{stemText:{validateStatus:"",errorMsg:""},message:this.t("itemManage.caseSensitiveClues"),checked:!0,type:"fill",publicPath:Object({NODE_ENV:"production"}).BASE_URL,form:this.$form.createForm(this,{name:"base-question-type"}),answers:[]}},inject:["bank_id","subject","showCKEditorData","showAttachment"],props:{subQuestions:{type:Object,default:function(){return O}},isSubItem:{type:Boolean,default:!1},mode:{type:String,default:"create"},isDisable:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1},errorList:{type:Array,default:function(){return[]}}},computed:{questions:function(){return"edit"===this.mode?this.isSubItem?this.subQuestions:this.subject.questions[0]:O},answer:function(){return this.getFillAnswer(this.stem.value)},questionsSelect:function(){return this.questions.response_points}},mounted:function(){var t=this;this.$nextTick((function(){p()(t.showCKEditorData.jqueryPath,(function(e){e&&console.log(e),p()(t.showCKEditorData.publicPath,(function(e){e&&console.log(e),t.initBaseStem(),t.renderFormula()}))})),t.initMessage()}))},methods:{initMessage:function(){this.message=this.$refs.initMessage.value?this.t("itemManage.caseSensitiveClues"):this.t("itemManage.ignoringCase")},initBaseStem:function(){var t=this;this.stemEditor=window.CKEDITOR.replace("base-question-type_questions['stem']",{toolbar:"Question",fileSingleSizeLimit:this.showCKEditorData.fileSingleSizeLimit,filebrowserImageUploadUrl:this.showCKEditorData.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:this.showCKEditorData.filebrowserImageDownloadUrl,language:this.showCKEditorData.language}),"edit"!=this.mode||this.isSubItem||(this.questions.stem=this.getEditFillStem(this.questions.stem),this.answers=this.getFillAnswer(this.questions.stem)),this.stemEditor.setData(this.questions.stem),this.stemEditor.on("change",(function(){var e=t.stemEditor.getData();t.answers=t.getFillAnswer(e),t.renderFormula(),0==t.errorList.length&&t.$emit("changeEditor",e),t.form.setFieldsValue(d()({},"questions['stem']",e)),t.checkFillRule(e),t.form.setFieldsValue(d()({},"questions['stem']",t.stemEditor.getData()))}))},checkItem:function(t){t.target.checked?(this.subQuestions.case_sensitive=!0,this.message=this.t("itemManage.caseSensitiveClues")):(this.subQuestions.case_sensitive=!1,this.message=this.t("itemManage.ignoringCase"))},checkFillRule:function(t){return/(\[\[(.+?)\]\])/i.test(t)?(this.stemText.validateStatus="",this.stemText.errorMsg="",!0):(this.stemText.validateStatus="error",this.stemText.errorMsg=this.t("itemManage.fillRule"),!1)},reverseStr:function(t){for(var e="",i=0;i<t.length;i++){e+=t.charAt(t.length-1-i)}return e},getFillAnswer:function(t){for(var e,i=[],a=/\[\[(?:[^[\]]+|\[[^[\]]+\])+\]\]/g;null!==(e=a.exec(t));){var s=e[0];i.push(s.substring(2,s.length-2))}return i},getEditFillStem:function(t){var e=0,i=this;return t.replace(/\[\[(?:[^[\]]+|\[[^[\]]+\])+\]\]/g,(function(){return"[[".concat(i.questions.answer[e++],"]]")}))},getFromInfo:function(){var t=this;this.checkFillRule(this.form.getFieldValue("questions['stem']"))&&this.form.validateFieldsAndScroll((function(e,i){e||t.formateData(i)}))},formateData:function(t){var e=this,i=JSON.parse(u()(this.questions)),a=t.questions,n=a.stem,o=a.otherScore,r=a.scoreType,l=this.getFillAnswer(n);t.questions.score="question"===r?o:o*(l.length||0),i.errors&&delete i.errors;var c={};this.isSubItem?i=s()(i,t.questions):(c=JSON.parse(u()(this.subject)),c=s()(c,t.base),(i=s()(i,t.questions)).answer_mode="text"),i.answer=this.getFillAnswer(i.stem);var h=[];i.answer.forEach((function(t){e.isAnswerIncludeFormula(t)?h.push({math:[]}):h.push({text:[]})})),i.response_points=h,c.questions=[i],this.$emit("patchData",c)},changeEditor:function(t){this.$emit("changeEditor",t)},getInitRepeatQuestion:function(){this.$emit("getInitRepeatQuestion")},renderFormula:function(){this.$emit("renderFormula")},prepareTeacherAiAnalysis:function(t){var e=this,i={};this.form.validateFieldsAndScroll((function(a,n){if(!a){var o=JSON.parse(u()(e.questions));o=s()(o,n.questions),i.stem=o.stem,i.answers=e.getFillAnswer(o.stem),e.isSubItem?(i.type="material-fill",e.$emit("prepareTeacherAiAnalysis",i,t)):(i.type="fill",t(i))}}))},isAnswerIncludeFormula:function(t){return/\$\$([^$]+)\$\$/.test(t)},displayAsFormula:function(t){return t.replace(/\$\$([^$]+)\$\$/g,'<span data-tex="$1"></span>')}}},N=Object(w.a)(j,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-form",{attrs:{form:t.form}},[i("answer-model",t._b({attrs:{questions:t.questions,form:t.form,mode:t.mode,isSubItem:t.isSubItem,itemType:t.type,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{getFromInfo:t.getFromInfo,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis},scopedSlots:t._u([{key:"stem",fn:function(){return[i("a-form-item",{attrs:{label:t.t("Stem"),"label-col":{span:4},"wrapper-col":{span:16},required:"","validate-status":t.stemText.validateStatus,help:t.stemText.errorMsg}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['stem']",{initialValue:t.questions.stem,rules:[{required:!0}]}],expression:"[\n            `questions['stem']`,\n            {\n              initialValue: questions.stem,\n              rules: [{ required: true }]\n            }\n          ]"}],attrs:{rows:0,"data-image-download-url":t.showCKEditorData.filebrowserImageDownloadUrl}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.stemText.validateStatus,expression:"!stemText.validateStatus"}],staticClass:"ibs-dark-assist"},[t._v("\n          "+t._s(t.t("itemManage.clickEditOrButton"))),i("span",{staticClass:"ibs-danger-color"},[t._v(" [ ] ")]),t._v(t._s(t.t("itemManage.insertByself"))+"\n        ")]),t._v(" "),t._l(t.answers,(function(e,a){return i("div",{key:a},[i("span",{staticClass:"font-medium"},[t._v(t._s("答案["+(a+1)+"]:")+" ")]),t._v(" "),i("span",{staticStyle:{color:"#999"}},[t.isAnswerIncludeFormula(e)?i("span",{domProps:{innerHTML:t._s(t.displayAsFormula(e))}}):i("span",[t._v(t._s(e))])]),i("br")])}))],2),t._v(" "),i("a-form-item",{attrs:{label:t.t("caseSensitiveShow"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["questions['case_sensitive']",{initialValue:0!=t.questions.case_sensitive}],expression:"[\n            `questions['case_sensitive']`,\n            {\n              initialValue: questions.case_sensitive == 0 ? false : true\n            }\n          ]"}],ref:"initMessage",attrs:{"default-checked":0!=t.questions.case_sensitive},on:{click:t.checkItem}}),t._v(" "),i("div",{staticClass:"ibs-dark-assist",attrs:{id:"checkbox"},domProps:{innerHTML:t._s(t.message)}})],1)]},proxy:!0}])},"answer-model",t.$attrs,!1))],1)}),[],!1,null,null,null).exports,R={stem:"",score:2,response_points:[{checkbox:{val:0,text:""}},{checkbox:{val:1,text:""}},{checkbox:{val:2,text:""}},{checkbox:{val:3,text:""}}],answer:[],analysis:"",answer_mode:"choice",attachments:[],scoreType:"question",otherScore:0},Q={name:"choice",mixins:[y.a,v.a],components:{answerModel:E},inject:["subject","showCKEditorData"],data:function(){return{publicPath:Object({NODE_ENV:"production"}).BASE_URL,questions:{},form:this.$form.createForm(this,{name:"base-question-type"}),optionsEditor:{},optionsEditorRule:{},answer:[],optionsIndex:{A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19},optionKey:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T"]}},props:{subQuestions:{type:Object,default:function(){return R}},isSubItem:{type:Boolean,default:!1},optionsConfiguration:{type:Object,default:function(){return{maxItem:20,MinItem:2}}},type:{type:String,default:"choice"},mode:{type:String,default:"create"},isDisable:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1},errorList:{type:Array,default:function(){return[]}}},created:function(){this.initData()},mounted:function(){var t=this;this.$nextTick((function(){p()(t.showCKEditorData.jqueryPath,(function(e){e&&console.log(e),p()(t.showCKEditorData.publicPath,(function(e){e&&console.log(e),t.initEdit()}))}))}))},methods:{getQuestions:function(){return"edit"===this.mode?this.isSubItem?this.subQuestions:this.subject.questions[0]:R},getQuestionsSelect:function(){var t=JSON.parse(u()(this.questions.response_points));return"edit"===this.mode&&t.forEach((function(t,e){t.checkbox.val=e})),t},getAnswer:function(){var t=this;if("edit"===this.mode){var e=JSON.parse(u()(this.questions.answer));return e.forEach((function(i,a){e[a]=t.optionsIndex[i]})),e}return[]},initData:function(){this.questions=this.getQuestions(),this.answer=this.getAnswer(),this.form.getFieldDecorator("keys",{initialValue:this.getQuestionsSelect(),preserve:!0}),this.initOptionsEditorRule()},initEdit:function(){var t=this;this.form.getFieldValue("keys").forEach((function(e){t.initOptionsEditorRule(e.checkbox.val),t.optionsEditor["".concat(e.checkbox.val)]||(t.optionsEditor["".concat(e.checkbox.val)]=window.CKEDITOR.replace("base-question-type_options[".concat(e.checkbox.val,"]"),{toolbar:"Minimal",fileSingleSizeLimit:t.showCKEditorData.fileSingleSizeLimit,filebrowserImageUploadUrl:t.showCKEditorData.filebrowserImageUploadUrl,filebrowserImageDownloadUrl:t.showCKEditorData.filebrowserImageDownloadUrl,language:t.showCKEditorData.language,height:120}),t.optionsEditor["".concat(e.checkbox.val)].on("change",(function(){var i=t.optionsEditor["".concat(e.checkbox.val)].getData();t.form.setFieldsValue(d()({},"options[".concat(e.checkbox.val,"]"),i)),t.checkOptionText(e.checkbox.val,i)})),t.optionsEditor["".concat(e.checkbox.val)].on("blur",(function(){var i=t.optionsEditor["".concat(e.checkbox.val)].getData();t.form.setFieldsValue(d()({},"options[".concat(e.checkbox.val,"]"),i)),t.checkOptionText(e.checkbox.val,i)})))}))},initOptionsEditorRule:function(){var t=this;this.form.getFieldValue("keys").forEach((function(e){t.optionsEditorRule["".concat(e.checkbox.val)]||(t.optionsEditorRule["".concat(e.checkbox.val)]={validateStatus:"",errorMsg:""})}))},checkOptionText:function(t,e){var i={validateStatus:"",errorMsg:""};e||(i.validateStatus="error",i.errorMsg=this.t("itemManage.chooseRule.one")),this.$set(this.optionsEditorRule,t,i)},checkAllOptionText:function(){var t=this;this.form.getFieldValue("keys").forEach((function(e){var i=t.form.getFieldValue("options[".concat(e.checkbox.val,"]"));t.checkOptionText(e.checkbox.val,i)}))},checkAnswer:function(){var t="choice"===this.type?2:1;if(this.answer.length<t){var e=this.t("itemManage.littleChoose"),i=this.t("itemManage.answers");return this.$message.error("".concat(e).concat(t).concat(i)),!1}return!0},add:function(){var t=this,e=this.form.getFieldValue("keys");if(e.length>=this.optionsConfiguration.maxItem)this.$message.error(this.t("itemManage.chooseRule.three"));else{var i=e[e.length-1].checkbox.val+1,a=e.concat({checkbox:{val:i,text:""}});this.form.setFieldsValue({keys:a}),this.initOptionsEditorRule(),this.$nextTick((function(){t.initEdit()}))}},remove:function(t,e){var i=this.form.getFieldValue("keys");i.length<=this.optionsConfiguration.minItem?this.$message.error(this.t("itemManage.chooseRule.four")):(this.form.setFieldsValue({keys:i.filter((function(t){return t.checkbox.val!==e.checkbox.val}))}),this.answer=this.answer.filter((function(t){return t!==e.checkbox.val})),this.optionsEditor[e.checkbox.val]=null)},getFromInfo:function(){var t=this;this.checkAllOptionText(),this.form.validateFieldsAndScroll((function(e,i){e||t.checkAnswer()&&t.formateData(i)}))},formateOptions:function(t){var e=this,i=[];return(t=t.filter((function(t){return t}))).forEach((function(t,a){i.push({checkbox:{val:e.optionKey[a],text:t}})})),i},formatetAnswer:function(t){var e=this,i=[];return t.forEach((function(t,a){e.answer.indexOf(t.checkbox.val)>-1&&i.push(e.optionKey[a])})),i},formateData:function(t){var e=JSON.parse(u()(this.questions)),i=t.questions,a=i.otherScore1,n=i.otherScore2,o="question"===i.scoreType?a:n;if(e.otherScore=o||0,e.errors&&delete e.errors,this.isSubItem){var r={};(e=s()(e,t.questions)).response_points=this.formateOptions(t.options),e.answer=this.formatetAnswer(t.keys),e.answer_mode=this.type,r.questions=[e],this.$emit("patchData",r)}else{var l=JSON.parse(u()(this.subject));l=s()(l,t.base),(e=s()(e,t.questions)).response_points=this.formateOptions(t.options),e.answer=this.formatetAnswer(t.keys),e.answer_mode=this.type,l.questions=[e],this.$emit("patchData",l),console.log(l)}},getChoiceLabelNum:function(t){var e=this.t("itemManage.chooseItem");return"".concat(e).concat(t)},changeEditor:function(t){this.$emit("changeEditor",t)},getInitRepeatQuestion:function(){this.$emit("getInitRepeatQuestion")},renderFormula:function(){this.$emit("renderFormula")},prepareTeacherAiAnalysis:function(t){var e=this;this.form.validateFieldsAndScroll((function(i,a){if(!i){var n={},o=JSON.parse(u()(e.questions));o=s()(o,a.questions),n.stem=o.stem,n.options=[],a.options.forEach((function(t,i){n.options.push("".concat(e.optionKey[i],".").concat(t))})),n.answer=e.formatetAnswer(a.keys).join(),e.isSubItem?(n.type="material-choice",e.$emit("prepareTeacherAiAnalysis",n,t)):(n.type="choice",t(n))}}))}}},V=Q,K=Object(w.a)(V,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-form",{attrs:{form:t.form}},[i("answer-model",t._b({attrs:{questions:t.questions,form:t.form,mode:t.mode,isSubItem:t.isSubItem,answer:t.answer,itemType:t.type,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{getFromInfo:t.getFromInfo,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis},scopedSlots:t._u([{key:"response_points",fn:function(){return[i("div",{staticClass:"ibs-choice-wrap"},[i("a-checkbox-group",{model:{value:t.answer,callback:function(e){t.answer=e},expression:"answer"}},t._l(t.form.getFieldValue("keys"),(function(e,a){return i("a-form-item",{key:e.checkbox.val,staticClass:"choice-item",attrs:{label:t.getChoiceLabelNum(t.optionKey[a]),required:"","label-col":{span:4},"wrapper-col":{span:16},"validate-status":t.optionsEditorRule[e.checkbox.val].validateStatus||"",help:t.optionsEditorRule[e.checkbox.val].errorMsg||""}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["options["+e.checkbox.val+"]",{initialValue:e.checkbox.text,rules:[{required:!0}]}],expression:"[\n                `options[${k.checkbox.val}]`,\n                {\n                  initialValue: k.checkbox.text,\n                  rules: [{ required: true }]\n                }\n              ]"}],attrs:{"data-image-download-url":t.showCKEditorData.filebrowserImageDownloadUrl,placeholder:"",rows:0}}),t._v(" "),i("a-checkbox",{attrs:{value:e.checkbox.val}},[t._v(t._s(t.t("RightAnswer")))]),t._v(" "),i("a-button",{staticClass:"ibs-delete-btn",attrs:{size:"small"},on:{click:function(){return t.remove(a,e)}}},[i("i",{staticClass:"ib-icon ib-icon-delete"})])],1)})),1),t._v(" "),i("a-row",[i("a-col",{staticClass:"ibs-text-right",attrs:{offset:4,span:16}},[i("a-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v(t._s(t.t("itemManage.newChoice")))])],1)],1)],1)]},proxy:!0}])},"answer-model",t.$attrs,!1))],1)}),[],!1,null,null,null).exports,B=i(149),U=i(150),P=i(151),H=i(148),J=i(152),z={stem:"",seq:5,score:"2.0",answer:[],analysis:"",answer_mode:""},G={name:"preview-model",components:{judgeType:B.a,singleChoice:U.a,choice:P.a,essay:H.a,fill:J.a},mixins:[v.a],data:function(){return{subItem:"",groupStyle:{pointerEvents:"none"},showQuestion:{},mode:"preview"}},provide:function(){return{modeOrigin:"preview"}},props:{questions:{type:Object,default:function(){return z}},index:{type:Number,default:function(){return 0}}},watch:{questions:{handler:function(t){this.showQuestion=s()({},t),"text"===this.showQuestion.answer_mode&&this.fillTypeData()}}},mounted:function(){this.showQuestion=s()({},this.questions),"text"===this.showQuestion.answer_mode&&this.fillTypeData()},methods:{filterFillHtml:function(t){if(t.match(/\[\[.+?\]\]/g)){var e=1;return t.replace(/\[\[.+?\]\]/g,(function(){return'<span class="ibs-stem-fill-blank">('.concat(e++,")</span>")}))}},filterFillAnswer:function(t){var e=this;return t.map((function(t){return console.log(t),t.replace(/\|/g,e.t("Or"))}))},fillTypeData:function(){this.showQuestion.stem=this.filterFillHtml(this.showQuestion.stem),this.showQuestion.answer=this.filterFillAnswer(this.showQuestion.answer)},showEditModal:function(t){var e=t.target.getAttribute("data-seq");this.$emit("getSeq",{seq:e-1,operate:"edit"})},deleteSub:function(t){var e=t.target.getAttribute("data-seq");this.$emit("getSeq",{seq:e-1,operate:"delete"})}}},W=Object(w.a)(G,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ibs-preview-section"},[i("div",{staticClass:"ibs-sub-item ibs-pr16"},["true_false"===t.showQuestion.answer_mode?i("judge-type",{attrs:{question:t.showQuestion,mode:t.mode}}):t._e(),t._v(" "),"single_choice"===t.showQuestion.answer_mode?i("single-choice",{attrs:{question:t.showQuestion,mode:t.mode}}):t._e(),t._v(" "),"choice"===t.showQuestion.answer_mode||"uncertain_choice"===t.showQuestion.answer_mode?i("choice",{attrs:{question:t.showQuestion,mode:t.mode}}):t._e(),t._v(" "),"rich_text"===t.showQuestion.answer_mode?i("essay",{attrs:{question:t.showQuestion,mode:t.mode}}):t._e(),t._v(" "),"text"===t.showQuestion.answer_mode?i("fill",{attrs:{question:t.showQuestion,mode:t.mode}}):t._e(),t._v(" "),i("a-row",[i("a-col",{attrs:{span:12,offset:2}},[i("div",{staticClass:"ibs-sub-operation"},[i("a-button",{staticClass:"ibs-mr8 ibs-pl0",attrs:{type:"link","data-seq":t.showQuestion.seq},on:{click:t.showEditModal}},[i("i",{staticClass:"ib-icon ib-icon-setting"}),t._v(t._s(t.t("Edit")))]),t._v(" "),i("a-button",{staticClass:"ibs-mr8",attrs:{type:"link","data-seq":t.showQuestion.seq},on:{click:t.deleteSub}},[i("i",{staticClass:"ib-icon ib-icon-delete"}),t._v(t._s(t.t("Delete"))+"\n          ")])],1)])],1)],1),t._v(" "),i("hr",{staticClass:"ibs-sub-divider"})])}),[],!1,null,null,null).exports,X={name:"material",mixins:[v.a],data:function(){return{form:this.$form.createForm(this,{name:"base-question-type"}),visible:!1,subItem:{},subType:"",subQuestions:{},newQuestions:[],currentSeq:0,subMode:"create",typeArray:{true_false:"judge",uncertain_choice:"uncertain_choice",choice:"choice",single_choice:"single_choice",text:"fill",rich_text:"essay"}}},components:{baseType:_,essayType:L,judgeType:C,fillType:N,singleType:F,choiceType:K,previewModel:W},inject:["bank_id","subject","showCKEditorData"],props:{mode:{type:String,default:"create"},isDisable:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1},errorList:{type:Array,default:function(){return[]}}},computed:{questions:function(){return"edit"===this.mode?this.subject.questions:this.newQuestions}},mounted:function(){this.$on("closeModal",this.cancel),"edit"===this.mode&&(this.newQuestions=this.questions,this.newQuestions.map((function(t,e){t.seq=e+1})))},methods:{getContainer:function(){return document.getElementById("item-bank-sdk-material-created")},getFromInfo:function(){var t=this;this.form.validateFieldsAndScroll((function(e,i){e||t.formateData(i)}))},formateData:function(t){t.base.attachments=this.subject.attachments,t.base.questions=this.questions;var e=t.base;return t.base.questions.length>0?this.$emit("patchData",e):this.$message.error(this.t("itemManage.addSubItemRule")),e},cancel:function(){this.visible=!1},showModal:function(t){var e=t.target;this.subType=e.getAttribute("data-type"),this.visible=!0,this.subMode="create"},handleOk:function(t){console.log(t),this.visible=!1},patchData:function(t){this.$emit("getData",t),this.subItem=t.questions[0],"edit"===this.subMode?this.$set(this.newQuestions,this.currentSeq,t.questions[0]):(this.newQuestions.push(t.questions[0]),this.newQuestions.map((function(t,e){t.seq=e+1}))),this.visible=!1},initStatus:function(t){this.subQuestions=t},showEditModal:function(t){this.visible=!0,this.subType=this.typeArray[this.newQuestions[t].answer_mode],this.subQuestions=this.newQuestions[t],this.subMode="edit"},getSeq:function(t){this.currentSeq=t.seq,"delete"===t.operate?(this.newQuestions.splice(this.currentSeq,1),this.newQuestions.map((function(t,e){t.seq=e+1}))):this.showEditModal(this.currentSeq)},getMaterialAttachment:function(t){this.subject.attachments.push(t)},onFileSort:function(t){var e=this.subject.attachments;e=(e=e.filter((function(e){return e.module!==t[0].module}))).concat(t),this.$set(this.subject,"attachments",e)},deleteMaterialAttachment:function(t){this.subject.attachments=this.subject.attachments.filter((function(e){return e.id!==t}))},previewMaterialAttachment:function(t){this.$emit("previewMaterialAttachment",t)},changeEditor:function(t){this.$emit("changeEditor",t)},getInitRepeatQuestion:function(){this.$emit("getInitRepeatQuestion")},renderFormula:function(){this.$emit("renderFormula")},prepareTeacherAiAnalysis:function(t,e){this.form.validateFieldsAndScroll((function(i,a){i||(t.material=a.base.material,e(t))}))}}},Y=Object(w.a)(X,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-form",{attrs:{form:t.form,id:"item-bank-sdk-material-created"}},[i("base-type",t._b({attrs:{form:t.form,mode:t.mode,isDisable:t.isDisable,errorList:t.errorList},on:{getFromInfo:t.getFromInfo,getMaterialAttachment:t.getMaterialAttachment,onFileSort:t.onFileSort,deleteMaterialAttachment:t.deleteMaterialAttachment,previewMaterialAttachment:t.previewMaterialAttachment,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion},scopedSlots:t._u([{key:"subQuestions",fn:function(){return[i("div",{staticClass:"ibs-mt24"},[i("a-form-item",{attrs:{"wrapper-col":{span:16,offset:4}}},t._l(t.newQuestions,(function(e,a){return i("preview-model",{key:a,attrs:{value:e,questions:e},on:{getSeq:t.getSeq}})})),1),t._v(" "),i("a-form-item",{attrs:{label:t.t("itemManage.addSubItem"),"label-col":{span:4},"wrapper-col":{span:16}}},[i("a-button",{staticClass:"ibs-mr8",attrs:{type:"primary","data-type":"single_choice"},on:{click:t.showModal}},[i("i",{staticClass:"ib-icon ib-icon-add"}),t._v(t._s(t.t("single_choice")))]),t._v(" "),i("a-button",{staticClass:"ibs-mr8",attrs:{type:"primary","data-type":"choice"},on:{click:t.showModal}},[i("i",{staticClass:"ib-icon ib-icon-add"}),t._v(t._s(t.t("choice")))]),t._v(" "),i("a-button",{staticClass:"ibs-mr8",attrs:{type:"primary","data-type":"uncertain_choice"},on:{click:t.showModal}},[i("i",{staticClass:"ib-icon ib-icon-add"}),t._v(t._s(t.t("uncertain_choice")))]),t._v(" "),i("a-button",{staticClass:"ibs-mr8",attrs:{type:"primary","data-type":"judge"},on:{click:t.showModal}},[i("i",{staticClass:"ib-icon ib-icon-add"}),t._v(t._s(t.t("determine")))]),t._v(" "),i("a-button",{staticClass:"ibs-mr8",attrs:{type:"primary","data-type":"fill"},on:{click:t.showModal}},[i("i",{staticClass:"ib-icon ib-icon-add"}),t._v(t._s(t.t("fill")))]),t._v(" "),i("a-button",{staticClass:"ibs-mr8",attrs:{type:"primary","data-type":"essay"},on:{click:t.showModal}},[i("i",{staticClass:"ib-icon ib-icon-add"}),t._v(t._s(t.t("essay")))]),t._v(" "),i("a-modal",{attrs:{title:t.t("itemManage.addItem"),width:"800px",cancelText:t.t("cancel"),destroyOnClose:!0,footer:null,getContainer:t.getContainer},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},["essay"===t.subType?i("essay-type",{attrs:{showCategory:!1,showDifficulty:!1,subQuestions:t.subQuestions,isSubItem:!0,mode:t.subMode,aiAnalysisEnable:t.aiAnalysisEnable},on:{patchData:t.patchData,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis}}):t._e(),t._v(" "),"fill"===t.subType?i("fill-type",{attrs:{showCategory:!1,showDifficulty:!1,isSubItem:!0,subQuestions:t.subQuestions,mode:t.subMode,aiAnalysisEnable:t.aiAnalysisEnable},on:{patchData:t.patchData,initStatus:t.initStatus,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis}}):t._e(),t._v(" "),"judge"===t.subType?i("judge-type",{attrs:{showCategory:!1,showDifficulty:!1,isSubItem:!0,subQuestions:t.subQuestions,mode:t.subMode,aiAnalysisEnable:t.aiAnalysisEnable},on:{patchData:t.patchData,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis}}):t._e(),t._v(" "),"single_choice"===t.subType?i("single-type",{attrs:{showCategory:!1,showDifficulty:!1,isSubItem:!0,subQuestions:t.subQuestions,mode:t.subMode,aiAnalysisEnable:t.aiAnalysisEnable},on:{patchData:t.patchData,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis}}):t._e(),t._v(" "),"choice"===t.subType||"uncertain_choice"===t.subType?i("choice-type",{attrs:{type:t.subType,showCategory:!1,showDifficulty:!1,isSubItem:!0,subQuestions:t.subQuestions,mode:t.subMode,aiAnalysisEnable:t.aiAnalysisEnable},on:{patchData:t.patchData,prepareTeacherAiAnalysis:t.prepareTeacherAiAnalysis}}):t._e()],1)],1)],1)]},proxy:!0}])},"base-type",t.$attrs,!1))],1)}),[],!1,null,null,null).exports,Z={id:1,bank_id:1,category_id:0,difficulty:"normal",material:"",analysis:"",attachments:[],type:"",questions:[]},tt={publicPath:"".concat(Object({NODE_ENV:"production"}).BASE_URL,"/es-ckeditor/ckeditor.js"),fileSingleSizeLimit:10,filebrowserImageUploadUrl:"",filebrowserImageDownloadUrl:"",language:"zh-cn",jqueryPath:"https://cdn.bootcss.com/jquery/3.4.1/jquery.js"},et={name:"item-manage",components:{judgeType:C,singleChoice:F,materialType:Y,choice:K,essayType:L,fillType:N},inheritAttrs:!1,props:{bank_id:{type:String,default:""},mode:{type:String,default:"create"},category:{type:Array,default:function(){return[]}},subject:{type:Object,default:function(){return Z}},type:{type:String,default:"choice"},showCKEditorData:{type:Object,default:function(){return{}}},showModelBtn:{type:Boolean,default:!1},showAttachment:{type:String,default:"0"},cdnHost:{type:String,default:"service-cdn.qiqiuyun.net"},uploadSDKInitData:{type:Object,default:function(){return{}}},deleteAttachmentCallback:{type:Function,default:function(){return new l.a((function(t){t()}))}},previewAttachmentCallback:{type:Function,default:function(){return new l.a((function(t){t()}))}},downloadAttachmentCallback:{type:Function,default:function(){return new l.a((function(t){t()}))}},isDownload:{type:Boolean,default:!1},isDisable:{type:Boolean,default:!1},aiAnalysisEnable:{type:Boolean,default:!1},errorList:{type:Array,default:function(){return[]}}},data:function(){return{isAgain:!1}},computed:{CKEditorData:function(){return console.log(this.showCKEditorData),o()(this.showCKEditorData).length?s()(tt,this.showCKEditorData):tt}},provide:function(){return{bank_id:this.bank_id,category:this.category,subject:this.subject,showCKEditorData:this.CKEditorData,showAttachment:Number(this.showAttachment),cdnHost:this.cdnHost,uploadSDKInitData:this.uploadSDKInitData,deleteAttachmentCallback:this.deleteAttachmentCallback,previewAttachmentCallback:this.previewAttachmentCallback,downloadAttachmentCallback:this.downloadAttachmentCallback,isDownload:this.isDownload,modeOrigin:"create"}},created:function(){this.$on("toGoBack",this.toGoBack),this.$on("changeAgain",this.changeAgain),this.$on("getDeleteFile",this.deleteAttachmentData),this.$on("previewFile",this.previewAttachment),this.$on("downloadFile",this.downloadAttachment)},methods:{changeAgain:function(t){this.isAgain=t},patchData:function(t){var e={data:t,isAgain:this.isAgain};this.$emit("getData",e)},deleteAttachmentData:function(t){var e=t.fileId;this.$emit("deleteAttachment",e)},deleteAttachment:function(t,e){this.$emit("deleteAttachment",t,e)},downloadAttachment:function(t){this.$emit("downloadAttachment",t)},toGoBack:function(){this.$emit("goBack")},previewAttachment:function(t){this.$emit("previewAttachment",t)},changeEditor:function(t){this.$emit("changeEditor",t)},getInitRepeatQuestion:function(){this.$emit("getInitRepeatQuestion")},renderFormula:function(){this.$emit("renderFormula")}}},it=Object(w.a)(et,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-bank-sdk-message ibs-background-color item-bank-create-form",attrs:{id:"item-bank-create"}},["determine"===t.type?i("judge-type",{attrs:{mode:t.mode,showModelBtn:t.showModelBtn,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{patchData:t.patchData,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion}}):t._e(),t._v(" "),"single_choice"===t.type?i("single-choice",{attrs:{mode:t.mode,showModelBtn:t.showModelBtn,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{patchData:t.patchData,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion}}):t._e(),t._v(" "),"fill"===t.type?i("fill-type",{attrs:{mode:t.mode,showModelBtn:t.showModelBtn,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{patchData:t.patchData,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion}}):t._e(),t._v(" "),"essay"===t.type?i("essay-type",{attrs:{mode:t.mode,showModelBtn:t.showModelBtn,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{patchData:t.patchData,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion}}):t._e(),t._v(" "),"material"===t.type?i("material-type",{attrs:{showMaterial:!0,showAnalysis:!0,mode:t.mode,showModelBtn:t.showModelBtn,errorList:t.errorList,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable},on:{previewMaterialAttachment:t.previewAttachment,patchData:t.patchData,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion}}):t._e(),t._v(" "),"choice"===t.type||"uncertain_choice"===t.type?i("choice",{attrs:{type:t.type,mode:t.mode,showModelBtn:t.showModelBtn,isDisable:t.isDisable,aiAnalysisEnable:t.aiAnalysisEnable,errorList:t.errorList},on:{patchData:t.patchData,changeEditor:t.changeEditor,renderFormula:t.renderFormula,getInitRepeatQuestion:t.getInitRepeatQuestion}}):t._e()],1)}),[],!1,null,null,null);e.a=it.exports},646:function(t,e,i){var a=i(141);t.exports=function(t,e){if(!a(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},666:function(t,e,i){t.exports=i(1420)}});