webpackJsonp(["app/js/testpaper-manage/check/index"],{"9a5c59a43068776403d1":function(e,t){"use strict";!function(e){e.fn.WaterMark=function(t){function n(){var t=l();y=e('<div id="waterMark" class="watermark"></div>');var n="rotate("+h.rotate+"deg)";return y.addClass("active"),y.css({opacity:h.opacity,"-webkit-transform":n,"-moz-transform":n,"-ms-transform":n,"-o-transform":n,transform:n,filter:"progid:DXImageTransform.Microsoft.Matrix(M11=0.70710678, M12=0.70710678, M21=-0.70710678, M22=0.70710678, sizingMethod='auto expand')"}),y.css(h.style),t>=8&&t<9&&y.css({height:60,filter:"progid:DXImageTransform.Microsoft.Matrix(M11=0.70710678, M12=0.70710678, M21=-0.70710678, M22=0.70710678, sizingMethod='auto expand')progid:DXImageTransform.Microsoft.Alpha(opacity="+100*parseFloat(h.opacity)+")"}),y.html(h.contents),y}function a(){r()}function r(){o(),y.css({top:g,left:m}),y.show()}function i(){r(),d=setInterval(function(){r(),setTimeout(function(){y.hide()},h.duringTime)},h.interval)}function o(){h.isUseRandomPos?c():u()}function c(){var e=v.height()-y.height()-p,t=v.width()-y.width()-b;g=Math.random()*e+p,m=Math.random()*t}function u(){"left"==h.xPosition&&(m=b),"center"==h.xPosition&&(m=(v.width()-y.width())/2),"right"==h.xPosition&&(m=v.width()-y.width()-b),"top"==h.yPosition&&(g=p),"center"==h.yPosition&&(g=(v.height()-y.height())/2+p),"bottom"==h.yPosition&&(g=v.height()-y.height()-p)}function s(){h.isAlwaysShow?a():i()}function l(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=n.exec(t)&&(e=parseFloat(RegExp.$1))}return e}function f(){v.append(n()),s()}var d,h=e.extend({duringTime:3e5,interval:6e5,isAlwaysShow:!0,xPosition:"center",yPosition:"top",isUseRandomPos:!1,opacity:.8,rotate:45,style:{},contents:""},t),v=e(this),p=40,b=15,g=p,m=b,y=null;f()}}($)},"8492817a6b6ebd299565":function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(){n(this,e)}return a(e,[{key:"getAnswer",value:function(e){var t=[];return $("input[name="+e+"]:checked").each(function(){t.push($(this).val())}),t}}]),e}();t.default=r},"3515d355d43c1a043be1":function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(){n(this,e)}return a(e,[{key:"getAnswer",value:function(e){var t=[];return $("input[name="+e+"]:checked").each(function(){t.push($(this).val())}),t}}]),e}();t.default=r},d43f35b4f73d35eb967a:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(){n(this,e)}return a(e,[{key:"getAnswer",value:function(e){var t=[],n=$("[name="+e+"]").val();return t.push(n),t}},{key:"getAttachment",value:function(e){var t=[],n=$("[name="+e+"]").parent().find('[data-role="fileId"]').val();return""!=n&&t.push(n),t}}]),e}();t.default=r},"936bfc70bea5be864cc4":function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(){n(this,e)}return a(e,[{key:"getAnswer",value:function(e){var t=[];return $("input[name="+e+"]").each(function(){t.push($(this).val())}),t}}]),e}();t.default=r},"2a56fd48b3e3533b8e82":function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(){n(this,e)}return a(e,[{key:"getAnswer",value:function(e){var t=[];return $("input[name="+e+"]:checked").each(function(){t.push($(this).val())}),t}}]),e}();t.default=r},0:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n("2d148eb38b93bb0ef45c"),c=(a(o),n("f898520c5384ef4c819c"));$.validator.addMethod("score",function(e,t){var n=/^\d+(\.\d)?$/.test(e);return!!n&&Number(e)<=Number($(t).data("score"))},$.validator.format("分数只能是<=题目分数、且>=0的整数或者1位小数"));var u=function(){function e(t){r(this,e),this.$container=t,this.checkContent={},this.$form=t.find("form"),this.$dialog=t.find("#testpaper-checked-dialog"),this.validator=null,this._initEvent(),this._init(),this._initValidate(),(0,c.testpaperCardFixed)()}return i(e,[{key:"_initEvent",value:function(){var e=this;this.$container.on("focusin","textarea",function(t){return e._showEssayInputEditor(t)}),this.$container.on("click",'[data-role="check-submit"]',function(t){return e._submitValidate(t)}),this.$container.on("click","*[data-anchor]",function(t){return e._quick2Question(t)}),this.$dialog.on("click",'[data-role="finish-check"]',function(t){return e._submit(t)}),this.$dialog.on("change","select",function(t){return e._teacherSayFill(t)})}},{key:"_init",value:function(){}},{key:"_showEssayInputEditor",value:function(e){var t=$(e.currentTarget);if(t.hasClass("essay-teacher-say-short")){e.preventDefault(),e.stopPropagation(),$(this).blur();var n=t.siblings(".essay-teacher-say-long"),a=n.siblings(".essay-teacher-say-btn");t.hide(),n.show(),a.show();var r=CKEDITOR.replace(n.attr("id"),{toolbar:"Minimal",filebrowserImageUploadUrl:n.data("imageUploadUrl")});r.on("blur",function(e){r.updateElement(),setTimeout(function(){n.val(r.getData()),n.change()},1)}),r.on("instanceReady",function(e){this.focus(),a.one("click",function(){t.val($(r.getData()).text()),r.destroy(),n.hide(),a.hide(),t.show()})}),r.on("key",function(){r.updateElement(),setTimeout(function(){n.val(r.getData()),n.change()},1)}),r.on("insertHtml",function(e){r.updateElement(),setTimeout(function(){n.val(r.getData()),n.change()},1)})}}},{key:"_initValidate",value:function(e){this.validator=this.$form.validate(),$("*[data-score]:visible").length>0&&$("*[data-score]:visible").each(function(e){$(this).rules("add",{required:!0,score:!0,min:0,messages:{required:"请输入分数"}})})}},{key:"_quick2Question",value:function(e){var t=$(e.currentTarget),n=$(t.data("anchor")).offset();$(document).scrollTop(n.top-55)}},{key:"_submitValidate",value:function(e){var t=($(e.currentTarget),0);if(void 0==this.validator||this.validator.form()){var n=this;$("*[data-score]").each(function(){var e={},a=$(this).data("id");e.score=Number($(this).val()),e.teacherSay=$('[name="teacherSay_'+a+'"]').val(),n.checkContent[a]=e,t+=Number($(this).val())});var a=Number(this.$dialog.find('[name="objectiveScore"]').val()),r=Number(t)+a;this.$dialog.find("#totalScore").html(r),this.$dialog.modal("show")}}},{key:"_submit",value:function(e){var t=$(e.currentTarget),n=this.$dialog.find("textarea").val(),a=this.$dialog.find('[name="passedStatus"]:checked').val();t.button("loading"),$.post(t.data("postUrl"),{result:this.checkContent,teacherSay:n,passedStatus:a},function(e){window.location.reload()})}},{key:"_teacherSayFill",value:function(e){var t=$(e.currentTarget),n=t.find("option:selected");""==n.val()?this.$dialog.find("textarea").val(""):this.$dialog.find("textarea").val(n.text())}}]),e}();new u($(".container"))},f898520c5384ef4c819c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initWatermark=t.onlyShowError=t.testpaperCardLocation=t.testpaperCardFixed=t.initScrollbar=void 0,n("9a5c59a43068776403d1");var a=n("9181c6995ae8c5c94b7a"),r=t.initScrollbar=function(){var e=$(".js-panel-card");e.perfectScrollbar(),e.perfectScrollbar("update")};t.testpaperCardFixed=function(){if(!(0,a.isMobileDevice)()){var e=$(".js-testpaper-card");if(!(e.length<=0)){var t=e.offset().top;$(window).scroll(function(n){var a=$(window).scrollTop();a>=t?e.addClass("affix"):e.removeClass("affix")})}}},t.testpaperCardLocation=function(){$(".js-btn-index").click(function(e){var t=$(e.currentTarget);$(".js-testpaper-heading").length<=0&&t.addClass("doing").siblings(".doing").removeClass("doing")})},t.onlyShowError=function(){$("#showWrong").change(function(e){var t=$(e.currentTarget);$(".js-answer-notwrong").each(function(e,n){var a=$($(n).data("anchor")),r=a.closest(".js-testpaper-question-block");t.prop("checked")?(a.hide(),r.find(".js-testpaper-question:visible").length<=0&&r.hide()):(a.show(),r.show())}),r()})},t.initWatermark=function(){var e=$(".js-testpaper-watermark");e.length>0&&$.get(e.data("watermark-url"),function(t){e.each(function(){$(this).WaterMark({yPosition:"center",style:{"font-size":10},opacity:.6,contents:t})})})}},"2d148eb38b93bb0ef45c":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n("8492817a6b6ebd299565"),c=a(o),u=n("3515d355d43c1a043be1"),s=a(u),l=n("d43f35b4f73d35eb967a"),f=a(l),d=n("936bfc70bea5be864cc4"),h=a(d),v=n("2a56fd48b3e3533b8e82"),p=a(v),b=function(){function e(t){r(this,e),this.type=t}return i(e,null,[{key:"getTypeBuilder",value:function(e){var t=null;switch(e){case"choice":t=new c.default;break;case"determine":t=new s.default;break;case"essay":t=new f.default;break;case"fill":t=new h.default;break;case"single_choice":t=new p.default;break;case"uncertain_choice":t=new p.default;break;default:t=null}return t}}]),e}();t.default=b}});