{"version":3,"sources":["webpack:///external \"jQuery\"","webpack:///./app/Resources/static-src/app/js/subject/type/fill-question.js","webpack:///./app/Resources/static-src/app/js/subject/type/essay-question.js","webpack:///./node_modules/babel-runtime/core-js/get-iterator.js","webpack:///./app/Resources/static-src/app/js/subject/edit.js","webpack:///./app/Resources/static-src/app/js/subject/type/determine-question.js","webpack:///./app/Resources/static-src/app/js/subject/operate.js","webpack:///./node_modules/babel-runtime/node_modules/core-js/library/fn/object/get-own-property-descriptor.js","webpack:///./node_modules/babel-runtime/node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js","webpack:///./app/Resources/static-src/app/js/subject/type/uncertain-choice-question.js","webpack:///./app/Resources/static-src/app/js/subject/index.js","webpack:///./node_modules/babel-runtime/helpers/get.js","webpack:///./app/Resources/static-src/app/js/subject/type/material-question.js","webpack:///./node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js","webpack:///./app/Resources/static-src/app/js/subject/type/single-choice-question.js","webpack:///./app/Resources/static-src/app/js/subject/type/choice-question.js","webpack:///./node_modules/babel-runtime/node_modules/core-js/library/fn/get-iterator.js","webpack:///./node_modules/babel-runtime/node_modules/core-js/library/modules/core.get-iterator.js","webpack:///./app/Resources/static-src/app/js/subject/type/base-question.js"],"names":["jQuery","validator","addMethod","value","element","optional","test","Translator","trans","Fill","$form","object","titleEditorToolBarName","initTitleEditor","$titleField","$","titleFieldId","init","rules","fillCheck","question","matches","match","i","length","answer","substring","push","BaseQuestion","Essay","answerFieldId","$answerField","required","messages","on","answerClick","event","self","$target","currentTarget","$textarea","next","hide","editor","CKEDITOR","replace","attr","toolbar","fileSingleSizeLimit","app","filebrowserImageUploadUrl","data","height","val","getData","replacePicture","text","focus","one","destroy","show","questionEditor","showEditor","type","SingleChoice","UncertainChoice","Choice","Determine","Material","Datermine","QuestionOperate","questions","eventManager","tokenList","$statList","$itemList","questionCounts","totalScore","flag","initQuestions","initQuestionCountsAndTotalScore","cachedData","_toJson","token","_getToken","index","$item","each","key","subQuestion","forEach","parseFloat","toFixed","indexOf","selectQuestion","difficulty","updateQuestionItem","find","html","scoreObj","isTestpaper","getQuestion","trigger","courseId","lessonId","preToken","isUpdating","position","splice","deleteToken","itemKey","itemValue","isTrigger","oldValue","correctMaterialQuestion","material","hasSubError","sub","isEmptyObject","cd","message","str","json","parseJSON","fn","bind","map","apply","Math","random","toString","_random","errorMessage","noAnswer","param","sbList","$element","$subjectData","$batchBtn","$batchWrap","$sbCheckbox","$finishBtn","$allBtn","$anchor","$diffiultyModal","$scoreModal","$belongModal","scoreValidator","questionOperate","testpaperTitle","redirect","timer","courseSetId","initQuestionOperate","confirmFresh","sbListFixed","footerButtonFixed","initEvent","initScoreValidator","setDifficulty","initTestpaperTitle","itemClick","statErrorQuestions","ieImg","initSelect","hasClass","removeClass","updateTotalScoreText","updateQuestionCountText","questionTypeConvert","tooltip","select","el","url","select2","post","result","option","$class","task","id","title","append","window","batchToItem","itemToBatch","batchBtnClick","finishBtnClick","quickToQuestion","showModal","showScoreModal","batchSetScore","batchSetBelong","itemEdit","deleteSubjectItem","editTestpaperTitle","finishImport","itemConvert","addModalShow","width","listTop","offset","top","scroll","scrollTop","addClass","addEventListener","scrollBottom","$fixedFooterElement","visibleBottom","parseInt","scrollY","document","documentElement","clientHeight","footerBottom","scrollHeight","windowHeight","body","visibleHeight","offsetHeight","target","checked","countNumber","itemLength","setTimeout","$checkBox","itemCheckedLength","isEditing","toggleClass","isShow","modal","stats","statChosedQuestion","keys","statsItem","tr","count","name","$missScoreField","hasOwnProperty","resetForm","parent","parents","substr","validate","onkeyup","score","max","min","es_score","missScore","noMoreThan","form","modifyScore","modifyBelong","click","modifyDifficulty","seq","isSub","getSubQuestion","getQuestionOrder","replaceWith","getEditor","toType","fromType","_serializeArrayConvertToJson","serializeArray","attachment","method","clearTimeout","$modal","isSubCreate","itemAdd","subItemAdd","then","res","orderQuestionList","after","getNewListItem","nextItem","last","materialQuestion","typeName","getTokenList","confirm","content","okText","cancelText","deleteSubQuestion","remove","changeBottomFixed","order","$listItem","deleteQuestion","nextUntil","trim","charCodeAt","totalCount","getQuestionCount","typeCount","getTotalScore","$subjectItem","listSeq","itemSeq","nextAll","not","hasError","errorTip","seqs","isMaterialHasSub","button","ajax","getQuestions","dataType","contentType","success","resp","location","href","isAddSub","closest","$editItem","parentNum","parentSeq","$list","getTypeName","Browser","ie10","ie11","serializeObj","item","changeRadio","$itemWrap","checkedRadio","oldFieldId","fieldId","optionCount","initOptionCount","initData","initValidator","editOption","deleteOption","addOption","prototype","elements","rulesCache","currentForm","settings","ignore","filter","debug","console","error","stem","options","right","multi","errorPlacement","elementName","prev","appendTo","insertAfter","$input","$textArea","instances","$oldTarget","prevAll","first","startupFocus","orderText","radioValue","$order","oldOrderText","addRealOperate","done","before","finishEdit","answers","inArray","getAttachments","updataCachedSubQuestion","operate","updataCachedQuestion","analysisEditor","$analysisModal","_init","attachmentActions","AttachmentActions","_initEvent","_initValidate","_initAnalysisEditor","_initSelect","submitForm","showAnalysisModal","saveAnalysis","courseSelect","lessonSelect","clear","analysis","setData","addQuestion","correctQuestion","addSubQuestion","updateSubQuestionItem","correctSubQuestion","filterQuestion","attachments","number","toolbarName","_titleEditorToolBarName"],"mappings":"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","file":"app/js/subject/index.js","sourcesContent":["module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = app/js/main app/js/v2/demo/index app/js/activity-manage/doc/index app/js/activity-manage/download/index app/js/activity-manage/flash/index app/js/activity-manage/homework/index app/js/activity-manage/ppt/index app/js/activity-manage/video/index app/js/article/detail/index app/js/attachment/index app/js/auth/captcha-modal/index app/js/auth/password-reset/index app/js/auth/register/index app/js/batch-upload/index app/js/card/card-receive/index app/js/card/index/index app/js/cashier/index app/js/cashier/modal/index app/js/classroom-manage/set-picture/index app/js/classroom-manage/student-expiryday/index app/js/classroom-manage/student-import/index app/js/classroom-manage/students-create/index app/js/classroom-manage/students-manage/index app/js/classroom/buy-modal/index app/js/classroom/index app/js/classroom/thread-form/index app/js/classroom/thread-show/index app/js/coin/invite-code/index app/js/course-chapter-manage/index app/js/course-manage-file/index/index app/js/course-manage/batch-create/index app/js/course-manage/lesson-manage/default/index app/js/course-manage/lesson-manage/normal/index app/js/course-manage/live-replay/upload/index app/js/course-manage/overview/index app/js/course-manage/student-import/index app/js/course/buy-modal/index app/js/course/thread-show/index app/js/courseset/show/index app/js/exporter/index app/js/group/index app/js/group/logo/index app/js/group/thread-add/index app/js/live-course/explore/index app/js/material-lib/index/index app/js/material-lib/share-history/index app/js/media-manage/index app/js/activity-manage/audio/index app/js/mobile-bind/index app/js/my/order-refund-apply/index app/js/my/order-refund/index app/js/my/order/index app/js/oauth2/create/index app/js/open-course-manage/add-material/index app/js/open-course-manage/lesson-modal/index app/js/open-course/index app/js/open-course/member-sms/index app/js/order/coupon-item/index app/js/order/create-sms/index app/js/order/create/index app/js/pay/select/index app/js/pay/show-mobile-modal/index app/js/player/index app/js/question-manage/form/index app/js/review/list/index app/js/search/index app/js/settings/avatar-crop-modal/index app/js/settings/bind-mobile/index app/js/settings/email/index app/js/settings/find_pay_password_by_sms/index app/js/settings/find-pay-password/index app/js/settings/password/index app/js/settings/pay-password-modal/index app/js/settings/pay-password/index app/js/settings/profile/index app/js/settings/reset-pay-password/index app/js/settings/security-questions/index app/js/settings/security/index app/js/settings/setup-password/index app/js/settings/setup/index app/js/settings/update-pay-password/index app/js/settings/user-profile/index app/js/subject/index app/js/task-manage/create/index app/js/task/plugin/note/index app/js/task/plugin/question/index app/js/testpaper-manage/create/index app/js/testpaper-manage/index app/js/testpaper-manage/questions/index app/js/testpaper/do-test/exercise/index app/js/testpaper/do-test/normal/index app/js/testpaper/result/index app/js/thread/user-info-modal/index app/js/user/fill-info/index app/js/message/show/index","import BaseQuestion from './base-question';\n\njQuery.validator.addMethod('fillCheck', function (value, element) {\n  return this.optional(element) || /(\\[\\[(.+?)\\]\\])/i.test(value);\n}, Translator.trans('course.question.create.fill_hint'));\n\nclass Fill extends BaseQuestion {\n  constructor($form, object) {\n    super($form, object);\n    this.titleEditorToolBarName = 'Question';\n    this.initTitleEditor(this.validator);\n    \n    this.$titleField = $('#'+this.titleFieldId);\n    this.init();\n  }\n\n  init() {\n    this.$titleField.rules('add',{\n      fillCheck:true\n    });\n  }\n\n  filterQuestion(question) {\n    let matches = question['stem'].match(/\\[\\[(.+?)\\]\\]/g);\n    if (matches != null) {\n      question['answers'] = [];\n      for (var i = 0; i < matches.length; i++) {\n        let answer = matches[i].substring(2);\n        answer = answer.substring(0, answer.length - 2);\n        question['answers'].push(answer);\n      }\n    }\n\n    return question;\n  }\n}\n\nexport default Fill;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/type/fill-question.js","import BaseQuestion from './base-question';\n\nclass Essay extends BaseQuestion {\n  constructor($form, object) {\n    super($form, object);\n\n    this.initTitleEditor(this.validator);\n\n    this.answerFieldId = 'question-answer-field';\n    this.$answerField = $('#' + this.answerFieldId);\n\n    this.init();\n  }\n\n  init() {\n    this.$answerField.rules('add', {\n      required: true,\n      messages: {\n        required: Translator.trans('subject.essay_require_answer')\n      }\n    });\n    this.$form.on('click', '[data-role=\"edit\"]', event => this.answerClick(event));\n  }\n\n  answerClick(event) {\n    let self = this;\n    let $target = $(event.currentTarget);\n    let $textarea = $target.next();\n    $target.hide();\n    let editor = CKEDITOR.replace($textarea.attr('id'), {\n      toolbar: 'Minimal',\n      fileSingleSizeLimit: app.fileSingleSizeLimit,\n      filebrowserImageUploadUrl: $textarea.data('imageUploadUrl'),\n      height: $textarea.height()\n    });\n\n    editor.on('change', () => {\n      $textarea.val(editor.getData());\n      $target.val($(self.replacePicture(editor.getData())).text());\n    });\n    editor.on('blur', () => {\n      $textarea.val(editor.getData());\n      $target.val($(self.replacePicture(editor.getData())).text());\n    });\n    editor.on('instanceReady', function() {\n      this.focus();\n\n      $('[data-role=\"edit\"]').one('click', function() {\n        $target.val($(self.replacePicture(editor.getData())).text());\n        $textarea.val(editor.getData());\n        editor.destroy();\n        $textarea.hide();\n        $target.show();\n      });\n    });\n  }\n}\n\nexport default Essay;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/type/essay-question.js","module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/get-iterator.js\n// module id = 2ae529d75fd1f719d626\n// module chunks = app/js/course-manage/overview/index app/js/subject/index","import BaseQuestion from './type/base-question';\nimport Choice from './type/choice-question';\nimport SingleChoice from './type/single-choice-question';\nimport UncertainChoice from './type/uncertain-choice-question';\nimport Determine from './type/determine-question';\nimport Fill from './type/fill-question';\nimport Essay from './type/essay-question';\nimport Material from './type/material-question';\n\nlet questionEditor;\nclass showEditor {\n  static getEditor(type, $form, object) {\n    switch (type) {\n      case 'single_choice':\n        questionEditor = new SingleChoice($form, object);\n        break;\n      case 'uncertain_choice':\n        questionEditor = new UncertainChoice($form, object);\n        break;\n      case 'choice':\n        questionEditor = new Choice($form, object);\n        break;\n      case 'determine':\n        questionEditor = new Determine($form, object);\n        break;\n      case 'essay':\n        questionEditor = new Essay($form, object);\n        break;\n      case 'fill':\n        questionEditor = new Fill($form, object);\n        break;\n      case 'material':\n        questionEditor = new Material($form, object);\n        break;\n      default:\n        questionEditor = new BaseQuestion($form, object);\n        questionEditor.initTitleEditor();\n        //questionEditor.initAnalysisEditor();\n    }\n  }\n}\n\nexport default showEditor;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/edit.js","import BaseQuestion from './base-question';\n\nclass Datermine extends BaseQuestion {\n  constructor($form, object) {\n    super($form, object);\n\n    this.initTitleEditor(this.validator);\n\n    this.$answerField = $('[name=\"answer\"]');\n\n    this.init();\n  }\n\n  init() {\n    this.$answerField.rules('add', {\n      required: true,\n      messages: {\n        required: Translator.trans('course.question.create.right_answer_required_error_hint')\n      }\n    });\n  }\n\n  filterQuestion(question) {\n    let answer = $('input[name=\\'answer\\']:checked').val();\n    question['answer'] = (answer == 'true') ? true : false;\n\n    return question;\n  }\n}\n\nexport default Datermine;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/type/determine-question.js","/*\n\n{\n    \"stem\" : \"\", //required\n    \"type\" : \"\", //required\n    \"options\" : [], //required: choicesingle_choiceuncertain_choicedetermine\n    \"answer\" : \"\", //required:  essay \n    \"answers\" : [], //required: choicesingle_choicencertain_choicedetermine\n    \"score\" : 2.0,\n    \"missScore\" : 1.0,\n    \"analysis\" : \"\",\n    \"attachments\" : {},\n    \"subQuestions\" : [],\n    \"difficulty\" : \"simple|normal|difficulty\",\n    \"errors\":{\n        \"answer\":{\n            \"element\":\"answer\",\n            \"index\":-1,\n            \"code\":100003,\n            \"message\":\"\"\n        }\n    }\n}\n*/\nexport default class QuestionOperate {\n  constructor() {\n    this.questions = {};\n    this.eventManager = {};\n    this.tokenList = [];\n    this.$statList = $('.js-subject-data');\n    this.$itemList = $('.js-item-list');\n    this.questionCounts = {};\n    this.totalScore = 0;\n    this.flag = true;\n    this.init();\n  }\n\n  init() {\n    this.initQuestions();\n    this.initQuestionCountsAndTotalScore();\n    this.flag = false;\n  }\n\n  //data-anchorID0\n  initQuestions() {\n    let cachedData = this._toJson($('.js-cached-data').text());\n    for (var i = 0; i < cachedData.length; i++) {\n      let token = this._getToken();\n      let question = cachedData[i];\n      question['courseId'] = 0;\n      question['lessonId'] = 0;\n      this.questions[token] = question;\n      this.tokenList.push(token);\n      let index = i;\n      $(`[data-anchor=\"#${index}\"]`).attr('data-anchor', '#' + token);\n      let $item = $('#' + index).attr('id', token);\n      if (question['type'] == 'material') {\n        $.each(question['subQuestions'], function (key, subQuestion) {\n          $item = $item.next(`[data-key=\"${key}\"]`).attr('data-material-token', token);\n        })\n      }\n    }\n  }\n\n  initQuestionCountsAndTotalScore() {\n    this.questionCounts = {\n      'total': 0,\n      'single_choice': 0,\n      'choice': 0,\n      'uncertain_choice': 0,\n      'determine': 0,\n      'fill': 0,\n      'essay': 0,\n      'material': 0,\n    };\n\n    let self = this;\n    Object.keys(this.questions).forEach(function(token) {\n      let question = self.questions[token];\n      self.questionCounts['total']++;\n      self.questionCounts[question['type']]++;\n      if (question['type'] != 'material') {\n        self.totalScore = (parseFloat(self.totalScore) + parseFloat(question['score'])).toFixed(1);\n      } else {\n        $.each(question['subQuestions'], function(token, subQuestion) {\n          self.totalScore = (parseFloat(self.totalScore) + parseFloat(subQuestion['score'])).toFixed(1);\n        });\n      }\n    });\n  }\n\n  getQuestionCount(type) {\n    return this.questionCounts[type];\n  }\n\n  getTotalScore() {\n    return this.totalScore;\n  }\n\n  getQuestionOrder(token) {\n    return this.tokenList.indexOf(token) + 1;\n  }\n\n  getTokenList() {\n    return this.tokenList;\n  }\n\n  modifyDifficulty(selectQuestion, difficulty, text) {\n    let self = this;\n    $.each(selectQuestion, function(index, token){\n      if (typeof self.questions[token] != 'undefined') {\n        self.updateQuestionItem(token, 'difficulty', difficulty);\n        self.$itemList.find('#' + token).find('.js-difficulty').html(text);\n      }\n    });\n  }\n\n  modifyScore(selectQuestion, scoreObj, isTestpaper) {\n    let self = this;\n    $.each(selectQuestion, function(index, token) {\n      self.$itemList.find(`#${token}`).find('.js-score').html(`${scoreObj['score']}${Translator.trans('subject.question_score_unit')}`);\n      let question = self.getQuestion(token);\n      self.updateQuestionItem(token, 'score', scoreObj['score'], false);\n      if (isTestpaper) {\n        if (question['type'] == 'choice' || question['type'] == 'uncertain_choice') {\n          self.updateQuestionItem(token, 'missScore', scoreObj['missScore']);\n        }\n      }\n    });\n    self.trigger('updateQuestionScore');\n  }\n\n  modifyBelong(selectQuestion, courseId, lessonId) {\n    let self = this;\n    $.each(selectQuestion, function(index, token){\n      if (typeof self.questions[token] != 'undefined') {\n        self.updateQuestionItem(token, 'courseId', courseId);\n        self.updateQuestionItem(token, 'lessonId', lessonId);\n      }\n    });\n  }\n\n  addQuestion(preToken, question) {\n    if (!this.isUpdating()) {\n      return;\n    }\n    this.flag = true;\n    if (question['type'] == 'material') {\n      question['subQuestions'] = [];\n      question['score'] = 0;\n    }\n    let token = this._getToken();\n    this.questions[token] = question;\n    let position = this.tokenList.indexOf(preToken) + 1;\n    this.tokenList.splice(position, 0, token);\n    this.questionCounts['total']++;\n    this.questionCounts[question['type']]++;\n    this.totalScore = (parseFloat(this.totalScore) + parseFloat(question['score'])).toFixed(1);\n    let index = position + 1;\n    this.trigger('addQuestion', [index, token, question['type']]);\n    this.flag = false;\n\n    return token;\n  }\n\n  deleteQuestion(deleteToken) {\n    if (!this.isUpdating()) {\n      return;\n    }\n    let self = this;\n    this.flag = true;\n    const question = this.questions[deleteToken];\n    delete this.questions[deleteToken];\n    let position = this.tokenList.indexOf(deleteToken);\n    this.tokenList.splice(position, 1);\n    this.questionCounts['total']--;\n    this.questionCounts[question['type']]--;\n    if (question['type'] != 'material') {\n      this.totalScore = (parseFloat(this.totalScore) - parseFloat(question['score'])).toFixed(1);\n    } else {\n      $.each(question['subQuestions'], function(token, subQuestion) {\n        self.totalScore = (parseFloat(self.totalScore) - parseFloat(subQuestion['score'])).toFixed(1);\n      })\n    }\n    this.trigger('deleteQuestion', [question['type']]);\n    this.flag = false;\n  }\n\n  updateQuestionItem(token, itemKey, itemValue, isTrigger = true) {\n    if (!this.isUpdating()) {\n      return;\n    }\n    this.flag = true;\n    let oldValue = this.questions[token][itemKey];\n    this.questions[token][itemKey] = itemValue;\n    if (itemKey == 'score') {\n      this.totalScore = (this.totalScore - parseFloat(oldValue) + parseFloat(itemValue)).toFixed(1);\n      this.trigger('updateQuestionScore', [isTrigger]);\n    }\n    if (itemKey == 'type' && oldValue != itemValue) {\n      this.questionCounts[oldValue]--;\n      this.questionCounts[itemValue]++;\n      this.trigger('updateQuestionType', [itemKey, itemValue, oldValue, token])\n    }\n    this.flag = false;\n  }\n\n  getQuestion(token) {\n    if (!this.isUpdating()) {\n      return;\n    }\n    return this.questions[token];\n  }\n\n  getQuestions() {\n    return this.questions;\n  }\n\n  getSubQuestion(token, key) {\n    if (!this.isUpdating()) {\n      return;\n    }\n    return this.questions[token]['subQuestions'][key];\n  }\n\n  addSubQuestion(token, question) {\n    if (!this.isUpdating()) {\n      return;\n    }\n    this.flag = true;\n    this.questions[token]['subQuestions'].push(question);\n    this.totalScore = (parseFloat(this.totalScore) + parseFloat(question['score'])).toFixed(1);\n    this.trigger('updateQuestionScore');\n    this.flag = false;\n\n    return token;\n  }\n\n  updateSubQuestionItem(token, key, itemKey, itemValue, isTrigger = true) {\n    if (!this.isUpdating()) {\n      return;\n    }\n    this.flag = true;\n    let oldValue = this.questions[token]['subQuestions'][key][itemKey];\n    this.questions[token]['subQuestions'][key][itemKey] = itemValue;\n    if (itemKey == 'score') {\n      this.totalScore = (this.totalScore - parseFloat(oldValue) + parseFloat(itemValue)).toFixed(1);\n      this.trigger('updateQuestionScore', [isTrigger]);\n    }\n    this.flag = false;\n  }\n\n  deleteSubQuestion(deleteToken, key) {\n    if (!this.isUpdating()) {\n      return;\n    }\n    this.flag = true;\n    const question = this.questions[deleteToken]['subQuestions'][key];\n    this.questions[deleteToken]['subQuestions'].splice(key, 1);\n    this.totalScore = (parseFloat(this.totalScore) - parseFloat(question['score'])).toFixed(1);\n    this.correctMaterialQuestion(deleteToken);\n    this.trigger('updateQuestionScore');\n    this.flag = false;\n  }\n\n  correctQuestion(token) {\n    let question = this.questions[token];\n    if (typeof question['errors'] == 'undefined') {\n      return;\n    }\n\n    if (question['type'] == 'material' && typeof question['errors']['hasSubError'] != 'undefined') {\n      question['errors'] = {\"hasSubError\" : true};\n    } else {\n      delete question['errors'];\n    }\n\n    this.questions[token] = question;\n    if (typeof question['errors'] == 'undefined') {\n      this.trigger('correctQuestion', [token]);\n    }\n  }\n\n  correctSubQuestion(token, key) {\n    let material = this.questions[token];\n    let subQuestion = material['subQuestions'][key];\n\n    if (typeof subQuestion['errors'] == 'undefined') {\n      return;\n    }\n\n    delete subQuestion['errors'];\n    material['subQuestions'][key] = subQuestion;\n    this.questions[token] = material;\n    this.correctMaterialQuestion(token);\n  }\n\n  correctMaterialQuestion(token) {\n    let material = this.questions[token];\n    let hasSubError = false;\n    $.each(material['subQuestions'], function(index, sub) {\n      if (typeof sub['errors'] != 'undefined') {\n        hasSubError = true;\n      }\n    });\n\n    if (!hasSubError && typeof material['errors'] != 'undefined') {\n      delete material['errors']['hasSubError'];\n    }\n\n    if ($.isEmptyObject(material['errors'])) {\n      delete material['errors'];\n      this.trigger('correctQuestion', [token]);\n    }\n    this.questions[token] = material;\n  }\n\n  isUpdating() {\n    if (this.flag == true) {\n      cd.message({ type: 'danger', message: Translator.trans('course.question.is_updating_hint') });\n      return false;\n    }\n\n    return true;\n  }\n\n  _toJson(str) {\n    let json = {};\n    if (str) {\n      json = $.parseJSON(str.replace(/[\\r\\n\\t]/g, ''));\n    }\n    return json;\n  }\n\n  on(event, fn) {\n    if (!this.eventManager[event]) {\n      this.eventManager[event] = [fn.bind(this)];\n    } else {\n      this.eventManager[event].push(fn.bind(this));\n    }\n  }\n\n  trigger(event, data) {\n    if (this.eventManager[event]) {\n      this.eventManager[event].map(function(fn) {\n        fn.apply(null, data);\n      });\n    }\n  }\n\n  _random() {\n    return (((1+Math.random())*0x10000)|0).toString(16).substring(1);\n  }\n\n  _getToken() {\n    return (this._random()+this._random()+\"-\"+this._random()+\"-\"+this._random()+\"-\"+this._random()+\"-\"+this._random()+this._random()+this._random());\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/operate.js","require('../../modules/es6.object.get-own-property-descriptor');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function getOwnPropertyDescriptor(it, key) {\n  return $Object.getOwnPropertyDescriptor(it, key);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/node_modules/core-js/library/fn/object/get-own-property-descriptor.js\n// module id = 71b27e2f2ad91538e032\n// module chunks = app/js/subject/index","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./_to-iobject');\nvar $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js\n// module id = 77a51ea3e42f24abf46c\n// module chunks = app/js/subject/index","import Choice from './choice-question';\n\nclass UncertainChoice extends Choice {\n  constructor($form, object) {\n    super($form, object);\n    this.errorMessage = {\n      noAnswer: Translator.trans('subject.choice_require_answer'),\n    };\n  }\n\n  initValidator() {\n    super.initValidator();\n    $.validator.addMethod('multi', function(value, element, param) {\n      return true;\n    });\n  }\n}\n\nexport default UncertainChoice;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/type/uncertain-choice-question.js","import QuestionOperate from './operate';\nimport showEditor from './edit';\nimport { Browser } from 'common/utils';\nimport { debounce } from 'app/common/widget/debounce';\n\nexport default class sbList {\n  constructor() {\n    this.$element = $('.js-subject-list');\n    this.$itemList = $('.js-item-list');\n    this.$subjectData = $('.js-subject-data');\n    this.$batchBtn = $('.js-batch-btn');\n    this.$batchWrap = $('.js-subject-wrap');\n    this.$sbCheckbox = $('.js-show-checkbox');\n    this.$finishBtn = $('.js-finish-btn');\n    this.$allBtn = $('.js-batch-select');\n    this.$anchor = $('.js-subject-anchor');\n    this.flag = true;\n    this.$diffiultyModal = $('.js-difficulty-modal');\n    this.$scoreModal = $('.js-score-modal');\n    this.$belongModal = $('.js-belong-modal');\n    this.scoreValidator = null;\n    this.selectQuestion = [];\n    this.questionOperate = null;\n    this.testpaperTitle = '';\n    this.redirect = false;\n    this.questionOperate = null;\n    this.timer = false;\n    this.courseSetId = $('#courseSetId').val();\n    this.init();\n  }\n\n  init() {\n    this.initQuestionOperate();\n    this.confirmFresh();\n    this.sbListFixed();\n    this.footerButtonFixed();\n    this.initEvent();\n    this.initScoreValidator();\n    this.setDifficulty();\n    this.initTestpaperTitle();\n    this.itemClick();\n    this.statErrorQuestions();\n    this.ieImg();\n    this.initSelect();\n  }\n\n  initQuestionOperate() {\n    let self = this;\n    self.questionOperate = new QuestionOperate();\n    self.questionOperate.on('correctQuestion', function(token) {\n      if ($(`[data-anchor=\"#${token}\"]`).hasClass('subject-list-item__num--error')) {\n        $(`[data-anchor=\"#${token}\"]`).removeClass('subject-list-item__num--error');\n        self.statErrorQuestions();\n      }\n    });\n    self.questionOperate.on('addQuestion', function(index, token, type) {\n      $(`[data-anchor=\"#${index}\"]`).attr('data-anchor', '#' + token);\n      self.updateTotalScoreText();\n      self.updateQuestionCountText(type);\n    });\n    self.questionOperate.on('deleteQuestion', function(type) {\n      self.updateTotalScoreText();\n      self.updateQuestionCountText(type);\n    });\n    self.questionOperate.on('updateQuestionScore', function(isTrigger = true) {\n      self.updateTotalScoreText(isTrigger);\n    });\n    self.questionOperate.on('updateQuestionType', function(key, value, oldValue, token) {\n      self.updateQuestionCountText(value);\n      self.updateQuestionCountText(oldValue);\n      self.questionTypeConvert(value, token);\n    });\n  }\n\n  initSelect() {\n    $('[data-toggle=\"tooltip\"]').tooltip();\n    cd.select({\n      el: '#courseBelong',\n      type: 'single'\n    }).on('change', (value, text) => {\n      let url = $('#courseBelong').data('url');\n      let select2 = $('#lessonBelong');\n      $('.js-lesson-options').html('');\n      $('#lessonBelong').find('input[name=\"lessonId\"]').val(0);\n      $('#lessonBelong').find('.select-value').text(Translator.trans('site.choose_hint'));\n      if (value == 0) {\n        select2.hide();\n        return;\n      }\n\n      $.post(url,{courseId:value},function(result){\n        if (result != '') {\n          let option = '<li class=\"checked\" data-value=\"0\">'+Translator.trans('site.choose_hint')+'</li>';\n          let $class = '';\n          $.each(result,function(index,task){\n            if(index == 0){\n              $class = 'tip-count-1';\n            }else{\n              $class = '';\n            }\n            option += `<li data-value=\"${task.id}\" class=\"${$class}\" title=\"${task.title}\" data-toggle=\"tooltip\" data-placement=\"top\">${task.title}</li>`;\n          });\n          $('.js-lesson-options').append(option);\n          $('[data-toggle=\"tooltip\"]').tooltip();\n          select2.show();\n        } else {\n          select2.hide();\n        }\n      });\n\n    });\n\n    cd.select({\n      el: '#lessonBelong',\n      type: 'single'\n    });\n  }\n\n  confirmFresh() {\n    let self = this;\n    $(window).on('beforeunload',function(){\n      if (!self.redirect) {\n        return Translator.trans('admin.block.not_saved_data_hint');\n      }\n    });\n  }\n\n  initEvent() {\n    this.$element.on('click', '.js-batch-select', event => this.batchToItem(event));\n    this.$element.on('click', '.js-show-checkbox', event => this.itemToBatch(event));\n    this.$element.on('click', '.js-batch-btn', event =>this.batchBtnClick(event));\n    this.$element.on('click', '.js-finish-btn', event => this.finishBtnClick(event));\n    this.$element.on('click', '*[data-anchor]', event => this.quickToQuestion(event, this.flag));\n    this.$element.on('click', '.js-difficult-setting', event => this.showModal(event, this.$diffiultyModal));\n    this.$element.on('click', '.js-belong-setting', event => this.showModal(event, this.$belongModal));\n    this.$element.on('click', '.js-score-setting', event => this.showScoreModal(event));\n    this.$scoreModal.on('click', '.js-batch-score-confirm', event => this.batchSetScore(event));\n    this.$belongModal.on('click', '.js-batch-set-belong', event => this.batchSetBelong(event));\n    this.$itemList.on('click', '.js-item-edit', event => this.itemEdit(event));\n    this.$itemList.on('click', '.js-item-delete', event => this.deleteSubjectItem(event));\n    this.$itemList.on('change', '.js-testpaper-title', event => this.editTestpaperTitle(event));\n    this.$itemList.on('click', '.js-import-btn', event => this.finishImport(event));\n  }\n\n  initTestpaperTitle() {\n    if (this.isTestpaper()) {\n      this.testpaperTitle = $('.js-testpaper-title').val();\n    }\n    this.$itemList.on('click', '.subject-change-btn', event => this.itemConvert(event));\n    this.$itemList.on('click', '.js-item-add', event => this.addModalShow(event, false));\n    this.$itemList.on('click', '.js-item-add-sub', event => this.addModalShow(event, true));\n    this.$subjectData.bind('change', '*[data-type]', (event, type) => this.updateQuestionCountText(type));\n    this.$subjectData.bind('change', '.js-total-score', event => this.updateTotalScoreText());\n  }\n\n  sbListFixed() {\n    let width = $('.js-subject-data').width();\n    if (!this.$element.length) {\n      return;\n    }\n    const self = this;\n    let listTop = this.$element.offset().top;\n    $(window).scroll(function(event) {\n      self.$element.width(width);\n      if ($(window).scrollTop() >= listTop) {\n        self.$element.addClass('sb-fixed');\n      } else {\n        self.$element.removeClass('sb-fixed');\n      }\n    });\n  }\n\n  footerButtonFixed() {\n    const self = this;\n    window.addEventListener('scroll', debounce(self.scrollBottom, 100, true));\n  }\n\n  scrollBottom() {\n    const $fixedFooterElement = $('.js-subject-item-btn');\n    $(window).scroll(function(event) {\n      const visibleBottom = parseInt(window.scrollY + document.documentElement.clientHeight);\n      let footerBottom = 0;\n      // \n      if ($('.es-footer-link').length) {\n        footerBottom = parseInt($('.es-footer-link').offset().top);\n      } else {\n        if ($('.es-footer').length) {\n          footerBottom = parseInt($('.es-footer').offset().top);\n        }\n      }\n      // 560\n      if (!footerBottom) {\n        const scrollHeight = parseInt($(document).scrollTop());\n        const windowHeight = parseInt($(document.body).height());\n        const visibleHeight = parseInt($(window).height());\n        const offsetHeight = windowHeight - 560;\n        if ((scrollHeight + visibleHeight) < offsetHeight) {\n          $fixedFooterElement.addClass('subject-bottom-fixed');\n        } else {\n          $fixedFooterElement.removeClass('subject-bottom-fixed');\n        }\n      } else {\n        if (footerBottom > visibleBottom) {\n          $fixedFooterElement.addClass('subject-bottom-fixed');\n        } else {\n          $fixedFooterElement.removeClass('subject-bottom-fixed');\n        }\n      }\n    });\n  }\n\n  batchToItem(event) {\n    if (event.currentTarget !== event.target) {\n      return;\n    }\n    const $target = $(event.currentTarget);\n    let checked = $target.hasClass('checked');\n    if (checked) {\n      this.$element.find('.js-show-checkbox').removeClass('checked');\n    } else {\n      this.$element.find('.js-show-checkbox').addClass('checked');\n    }\n  }\n\n  itemToBatch(event) {\n    if (event.currentTarget !== event.target) {\n      return;\n    }\n    this.countNumber();\n  }\n\n  countNumber() {\n    let itemLength = this.$element.find('.js-show-checkbox').length;\n    const self = this;\n    setTimeout(function(){\n      let $checkBox = $('.js-subject-list-body').find('.checked');\n      let itemCheckedLength = $checkBox.length;\n      if (itemLength == itemCheckedLength) {\n        self.$allBtn.addClass('checked');\n      } else {\n        self.$allBtn.removeClass('checked');\n      }\n    }, 100);\n  }\n\n  batchBtnClick(event) {\n    if (this.isEditing()) {\n      return;\n    }\n    const $target = $(event.target);\n    $target.toggleClass('hidden');\n    this.toggleClass(true);\n    this.flag = false;\n  }\n\n  finishBtnClick(event) {\n    this.$element.find('.js-show-checkbox').removeClass('checked');\n    this.$allBtn.removeClass('checked');\n    this.$batchBtn.toggleClass('hidden');\n    this.toggleClass(false);\n    this.flag = true;\n  }\n\n  toggleClass(isShow) {\n    if (isShow) {\n      this.$element.find('.js-subject-wrap').removeClass('hidden');\n      this.$element.find('.js-show-checkbox').removeClass('hidden');\n    } else {\n      this.$element.find('.js-subject-wrap').addClass('hidden');\n      this.$element.find('.js-show-checkbox').addClass('hidden');\n    }\n  }\n\n  quickToQuestion(event, flag) {\n    const $target = $(event.currentTarget);\n    if (!flag) {\n      $target.find('.js-show-checkbox').toggleClass('checked');\n      this.countNumber();\n    } else {\n      const position = $($target.attr('data-anchor')).offset();\n      $(document).scrollTop(position.top);\n    }\n  }\n\n  showModal(event, modal) {\n    if (this.isEditing()) {\n      return ;\n    }\n    let stats = this.statChosedQuestion();\n    let keys = Object.keys(stats);\n    if (keys.length === 0) {\n      cd.message({ type: 'danger', message: Translator.trans('subject.select_question_hint') });\n      return;\n    }\n    let html = '';\n    $.each(stats, function(index, statsItem){\n      let tr = statsItem.count + Translator.trans('subject.question_unit') + statsItem.name + Translator.trans('subject.comma');\n      html += tr;\n    });\n    html = html.substring(0, html.length - 1) + Translator.trans('subject.period');\n\n    modal.find('.js-select').html(html);\n\n    modal.modal('show');\n  }\n\n  showScoreModal(event) {\n    if (this.isEditing()) {\n      return ;\n    }\n    let stats = this.statChosedQuestion();\n    let $missScoreField = $('.js-miss-score-field');\n\n    if (!this.isTestpaper()) {\n      $missScoreField.addClass('hidden');\n    } else if (stats.hasOwnProperty('choice') || stats.hasOwnProperty('uncertain_choice')) {\n      $missScoreField.removeClass('hidden');\n    } else {\n      $missScoreField.addClass('hidden');\n    }\n\n    if (this.scoreValidator != null) {\n      this.scoreValidator.resetForm();\n    }\n\n    this.$scoreModal.find('input').each(function() {\n      $(this).val('');\n    });\n\n    this.showModal(event, this.$scoreModal);\n  }\n\n  statChosedQuestion() {\n    let stats = {};\n    let self = this;\n\n    self.$element.find('.js-show-checkbox.checked').each(function(){\n      let type = $(this).data('type'),\n        name = $(this).parent().next('.js-type-name').text(),\n        token = $(this).parents('.js-subject-anchor').data('anchor');\n\n      if (typeof stats[type] == 'undefined') {\n        stats[type] = {name:name, count:1};\n      } else {\n        stats[type]['count']++;\n      }\n      self.selectQuestion.push(token.substr(1));\n    });\n\n    return stats;\n  }\n\n  initScoreValidator() {\n    this.scoreValidator = $('#batch-set-score-form').validate({\n      onkeyup: false,\n      rules: {\n        score: {\n          required: true,\n          max: 999,\n          min: 0,\n          es_score: true\n        },\n        missScore: {\n          required: false,\n          max: 999,\n          min: 0,\n          noMoreThan: '#score',\n          es_score: true\n        }\n      },\n      messages: {\n        missScore: {\n          noMoreThan: Translator.trans('subject.miss_score_no_more_than_score'),\n        }\n      }\n    });\n\n    $.validator.addMethod( 'noMoreThan', function(value, element, param) {\n      if (value == '') {\n        return true;\n      } else {\n        return parseFloat(value) <= parseFloat($(param).val());\n      }\n    }, 'Please enter a lesser value.' );\n  }\n\n  isTestpaper() {\n    return ($('input[name=\"isTestpaper\"]').val() == 1);\n  }\n\n  batchSetScore() {\n    if (this.scoreValidator.form()) {\n      let score = this.$scoreModal.find('input[name=\"score\"]').val();\n      let missScore = this.$scoreModal.find('input[name=\"missScore\"]').val();\n      let scoreObj = {\n        score: score,\n        missScore: missScore,\n      };\n      this.questionOperate.modifyScore(this.selectQuestion, scoreObj, this.isTestpaper());\n      this.selectQuestion = [];\n\n      cd.message({ type: 'success', message: Translator.trans('subject.score_update_success') });\n      this.$scoreModal.modal('hide');\n    }\n  }\n\n  batchSetBelong() {\n    let courseId = this.$belongModal.find('input[name=\"courseId\"]').val();\n    let lessonId = this.$belongModal.find('input[name=\"lessonId\"]').val();\n    this.questionOperate.modifyBelong(this.selectQuestion, courseId, lessonId);\n    this.selectQuestion = [];\n\n    cd.message({ type: 'success', message: Translator.trans('subject.belong_update_success') });\n    this.$belongModal.modal('hide');\n  }\n\n  setDifficulty() {\n    let self = this;\n    $('.js-difficulty-btn').click(function(){\n      let difficulty = $('input[name=\\'difficultyRadios\\']:checked').val();\n      let text = $('input[name=\\'difficultyRadios\\']:checked').next().text();\n      self.questionOperate.modifyDifficulty(self.selectQuestion, difficulty, text);\n      self.selectQuestion = [];\n      cd.message({ type: 'success', message: Translator.trans('subject.difficulty_update_success') });\n      self.$diffiultyModal.modal('hide');\n    });\n  }\n\n  itemEdit(event) {\n    if (this.isEditing()) {\n      return;\n    }\n\n    let self = this;\n    let seq = 0;\n    let token = '';\n    let question = {};\n    let isSub = 0;\n    let $target = $(event.currentTarget);\n    let $item = $target.parents('.subject-item');\n    let url = $target.parents('.subject-item__operation').data('url');\n    if (typeof $item.attr('data-material-token') != 'undefined') {\n      seq = $item.data('key');\n      token = $item.attr('data-material-token');\n      question = this.questionOperate.getSubQuestion(token, seq);\n      isSub = 1;\n      seq++;\n    } else {\n      seq = this.questionOperate.getQuestionOrder($item.attr('id'));\n      question = this.questionOperate.getQuestion($item.attr('id'));\n      token = $item.attr('id');\n    }\n\n    let data = {\n      'seq' : seq,\n      'token' : token,\n      'question' : question,\n      'isSub' : isSub,\n      'method' : 'edit',\n      'isTestpaper': this.isTestpaper() ? 1 : 0,\n      'courseSetId': this.courseSetId,\n    };\n    $.post(url, data, html=> {\n      $item.replaceWith(html);\n      showEditor.getEditor(question['type'], $('.js-edit-form'), self.questionOperate);\n    });\n  }\n\n  itemConvert(event) {\n    let $target = $(event.currentTarget);\n    let $item = $target.parents('.subject-item');\n    let toType = $target.data('type');\n    let fromType = $target.parents('.subject-change-list').data('fromType');\n    let $form = $target.parents('.js-edit-form');\n    let url = $target.parents('.subject-change-list').data('convertUrl');\n    let question = sbList._serializeArrayConvertToJson($form.serializeArray());\n    if ($('.js-attachment-list').length > 0) {\n      let attachment = {};\n      if ($('.js-attachment-list-stem').find('.js-attachment-name').length > 0) {\n        attachment['stem'] = {\n          'type' : 'attachment',\n          'targetType' : 'question.stem',\n          'fileIds' : $('.js-attachment-ids-stem').val(),\n          'fileName' : $('.js-attachment-list-stem').find('.js-attachment-name').text()\n        };\n      }\n\n      if ($('.js-attachment-list-analysis').find('.js-attachment-name').length > 0) {\n        attachment['analysis'] = {\n          'type' : 'attachment',\n          'targetType' : 'question.analysis',\n          'fileIds' : $('.js-attachment-ids-analysis').val(),\n          'fileName' : $('.js-attachment-list-analysis').find('.js-attachment-name').text()\n        };\n      }\n      question['attachment'] = attachment;\n    }\n\n    let seq = $('.js-edit-form-seq').text();\n    let isSub = $('.js-sub-judge').val();\n    let method = $('.js-hidden-method').val();\n    let data = {\n      'seq' : seq,\n      'token' : question.token,\n      'question' : question,\n      'fromType' : fromType,\n      'toType' : toType,\n      'isSub' : isSub,\n      'method' : method,\n      'isTestpaper': this.isTestpaper() ? 1 : 0,\n      'courseSetId': this.courseSetId,\n    };\n    data.fromType = fromType;\n    data.toType = toType;\n    let self  = this;\n    $.post(url, data, html => {\n      $item.replaceWith(html);\n      showEditor.getEditor(toType, $('.js-edit-form'), self.questionOperate);\n    });\n  }\n\n  itemClick() {\n    let self = this;\n    $('.js-create-btn').on('click', (event) => {\n      const $target = $(event.target);\n      if (self.timer) clearTimeout(self.timer);\n      self.timer = setTimeout(() => {\n        $target.attr('disabled', true);\n        const $modal = $('#cd-modal');\n        const isSubCreate = $modal.attr('data-sub');\n        const url = $target.data('url');\n        let token = $modal.attr('data-index');\n        let type = $target.data('type');\n        if (isSubCreate == 'false') {\n          self.itemAdd(token, type, url, $target);\n        } else {\n          self.subItemAdd(token, type, url);\n        }\n      }, 500);\n    });\n  }\n\n  itemAdd(token, type, url, $target) {\n    let self = this;\n    let seq = self.questionOperate.getQuestionOrder(token) + 1;\n    let isTestpaper = this.isTestpaper() ? 1 : 0;\n    let data = {\n      'seq' : seq,\n      'token' : token,\n      'method' : 'add',\n      'isTestpaper' : isTestpaper,\n      'courseSetId': this.courseSetId,\n    };\n    $.post(url, data).then((res) => {\n      $('#cd-modal').modal('hide');\n      $('.js-create-btn').attr('disabled', false);\n      let index = seq + 1;\n      self.orderQuestionList(index, $(`[data-anchor=\"#${token}\"]`).parent(), $(`#${token}`));\n      $(`[data-anchor=\"#${token}\"]`).parent().after(self.getNewListItem(seq, type, $target.text()));\n      self.statErrorQuestions();\n      let nextItem = $(`#${token}`).next('.subject-item');\n      if (nextItem.hasClass('subject-sub-item')) {\n        $(`[data-material-token=\"${token}\"]`).last().after(res);\n      } else {\n        $(`#${token}`).after(res);\n      }\n      showEditor.getEditor(type, $('.js-edit-form'), self.questionOperate);\n    });\n  }\n\n  subItemAdd(token, type, url) {\n    let self = this;\n    let materialQuestion = this.questionOperate.getQuestion(token);\n    let seq = materialQuestion['subQuestions'].length + 1;\n    let isTestpaper = this.isTestpaper() ? 1 : 0;\n    let data = {\n      'seq' : seq,\n      'token' : token,\n      'method' : 'add',\n      'isSub' : 1,\n      'isTestpaper' : isTestpaper,\n      'courseSetId': this.courseSetId,\n    };\n    $.post(url, data).then((res) => {\n      $('#cd-modal').modal('hide');\n      $('.js-create-btn').attr('disabled', false);\n      var nextItem = $(`#${token}`).next('.subject-item');\n      if (nextItem.hasClass('subject-sub-item')) {\n        $(`[data-material-token=\"${token}\"]`).last().after(res);\n      } else {\n        $(`#${token}`).after(res);\n      }\n      showEditor.getEditor(type, $('.js-edit-form'), self.questionOperate);\n    });\n  }\n\n  getNewListItem(seq, type, typeName) {\n    if (type !== 'material'){\n      return `<div class=\"col-sm-3 subject-list-item js-subject-list-item\">\n          <div class=\"subject-list-item__num  js-subject-anchor\" data-anchor=\"#${seq}\">\n            <span class=\"js-list-index\">${seq}</span>\n            <label class=\"sb-checkbox cd-checkbox js-show-checkbox hidden\" data-type=\"${type}\"><input type=\"checkbox\" data-toggle=\"cd-checkbox\"></label>\n          </div>\n          <span class=\"js-type-name\">${typeName}</span>\n        </div>`;\n    } else{\n      return `<div class=\"col-sm-3 subject-list-item js-subject-list-item\">\n          <div class=\"subject-list-item__num  js-subject-anchor\" data-anchor=\"#${seq}\">\n            <span class=\"js-list-index\">${seq}</span>\n          </div>\n          <span class=\"js-type-name\">${typeName}</span>\n        </div>`;\n    }\n\n  }\n\n  deleteSubjectItem(event) {\n    if (this.isEditing()) {\n      return;\n    }\n    let tokenList = this.questionOperate.getTokenList();\n    if (tokenList.length < 2) {\n      cd.message({\n        type : 'danger',\n        message : Translator.trans('subject.question_delete_tip'),\n      });\n      return;\n    }\n    cd.confirm({\n      title: Translator.trans('subject.delete.title'),\n      content: Translator.trans('subject.delete.content'),\n      okText: Translator.trans('site.confirm'),\n      cancelText: Translator.trans('site.cancel'),\n    }).on('ok', () => {\n      const $item = $(event.currentTarget).parent().parent();\n      let token = $item.attr('id');\n\n      if ($item.hasClass('subject-sub-item')) {\n        token = $item.attr('data-material-token');\n        let key = $item.attr('data-key');\n        this.questionOperate.deleteSubQuestion(token, key);\n        $item.remove();\n        this.changeBottomFixed();\n        let order = 0;\n        $(`[data-material-token=\"${token}\"]`).each(function() {\n          $(this).attr('id', `sub${order}`);\n          $(this).attr('data-key', order++);\n          $(this).find('.subject-sub-item__number').text(`(${order})`);\n        });\n\n        return;\n      }\n\n      let question = this.questionOperate.getQuestion(token);\n      let order = this.questionOperate.getQuestionOrder(token);\n      const $listItem = $(`[data-anchor=#${token}]`).parent();\n      this.orderQuestionList(order, $listItem, $item);\n      this.questionOperate.deleteQuestion(token);\n      const self = this;\n      if (question.type == 'material') {\n        $item.nextUntil('.js-subject-main-item').each(function() {\n          $(this).remove();\n          self.changeBottomFixed();\n        });\n      }\n      $listItem.remove();\n      $item.remove();\n      self.changeBottomFixed();\n\n      this.statErrorQuestions();\n    });\n  }\n\n  changeBottomFixed() {\n    const visibleBottom = parseInt(window.scrollY + document.documentElement.clientHeight);\n    let footerBottom = 0;\n    // \n    if ($('.es-footer-link').length) {\n      footerBottom = parseInt($('.es-footer-link').offset().top);\n    } else {\n      if ($('.es-footer').length) {\n        footerBottom = parseInt($('.es-footer').offset().top);\n      }\n    }\n    // \n    if (!footerBottom) {\n      const scrollHeight = parseInt($(document).scrollTop());\n      const windowHeight = parseInt($(document.body).height());\n      const visibleHeight = parseInt($(window).height());\n      const offsetHeight = windowHeight - 560;\n      if ((scrollHeight + visibleHeight) >= offsetHeight) {\n        $('.js-subject-item-btn').removeClass('subject-bottom-fixed');\n      }\n    } else {\n      if (footerBottom < visibleBottom) {\n        $('.js-subject-item-btn').removeClass('subject-bottom-fixed');\n      }\n    }\n  }\n\n  editTestpaperTitle(event) {\n    let val = $(event.target).val();\n\n    if ($.trim(val) == '') {\n      cd.message({\n        type: 'danger',\n        message: Translator.trans('subject.testpaper_title_empty_hint'),\n      });\n      $(event.target).val(this.testpaperTitle);\n      return;\n    }\n\n    let length = val.length;\n    for (let i = 0; i < val.length; i++) {\n      if (val.charCodeAt(i) > 127) {\n        length++;\n      }\n    }\n\n    if (length > 50) {\n      cd.message({\n        type: 'danger',\n        message: Translator.trans('subject.testpaper_title_too_long_hint'),\n      });\n      $(event.target).val(this.testpaperTitle);\n      return;\n    }\n\n    this.testpaperTitle = val;\n  }\n\n  updateQuestionCountText(type) {\n    let totalCount = this.questionOperate.getQuestionCount('total');\n    let typeCount = this.questionOperate.getQuestionCount(type);\n    $('.js-total-num').text(Translator.trans('subject.question_count', {count: totalCount}));\n    $(`[data-type=${type}]`).find('.subject-data__num').text(Translator.trans('subject.question_count', {count: typeCount}));\n  }\n\n  updateTotalScoreText(isTrigger = true) {\n    if (this.isTestpaper() && isTrigger) {\n      let totalScore = parseFloat(this.questionOperate.getTotalScore()).toFixed(1);\n      $('.js-total-score').text(Translator.trans('subject.total_score', {totalScore: totalScore}));\n    }\n  }\n\n  orderQuestionList(seq, $listItem, $subjectItem) {\n    let listSeq = seq;\n    let itemSeq = seq;\n    $listItem.nextAll('.subject-list-item').each(function() {\n      $(this).find('.js-list-index').text(listSeq);\n      listSeq++;\n    });\n\n    $subjectItem.nextAll('.subject-item').not('.subject-sub-item').each(function() {\n      $(this).find('.subject-item__number').text(itemSeq);\n      itemSeq++;\n    });\n  }\n\n  finishImport(event) {\n    if (this.isEditing()) {\n      return;\n    }\n    let hasError = false;\n    let self = this;\n    let errorTip = '';\n    this.$element.find('.subject-list-item__num--error').each(function () {\n      errorTip = errorTip + $(this).find('.js-list-index').text() + '';\n      hasError = true;\n    });\n    errorTip = Translator.trans('subject.question_error_tip', {seqs: errorTip.substring(0, errorTip.length - 1)});\n    if (hasError) {\n      cd.message({\n        type : 'danger',\n        message : errorTip\n      });\n      return ;\n    }\n\n    if (!this.isMaterialHasSub()) {\n      return;\n    }\n\n    let title = '';\n    if (this.isTestpaper()) {\n      title = this.testpaperTitle;\n    }\n    const $target = $(event.currentTarget);\n    $target.button('loading');\n    $.ajax({\n      type: \"POST\",\n      url: $target.data('url'),\n      data: JSON.stringify({title: title, questions: this.questionOperate.getQuestions()}),\n      dataType: \"json\",\n      contentType: \"application/json;charset=utf-8\",\n      success: function(resp) {\n        if (resp === true) {\n          $target.button('reset');\n          cd.message({\n            type : 'success',\n            message : Translator.trans('subject.save_success'),\n          });\n          self.redirect = true;\n          window.location.href = $target.data('redirectUrl');\n        }\n      }\n    });\n  }\n\n  isMaterialHasSub() {\n    let self = this;\n    let tokenList = self.questionOperate.getTokenList();\n    for (var i = 0;i < tokenList.length;i++) {\n      let token = tokenList[i];\n      let question = self.questionOperate.getQuestion(token);\n      if (question['type'] == 'material' && question['subQuestions'].length == 0) {\n        let seq = self.questionOperate.getQuestionOrder(token);\n        cd.message({\n          type : 'danger',\n          message : Translator.trans('subject.material_nosub_tip', {seq: seq})\n        });\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  statErrorQuestions() {\n    let errorTip = '';\n    let isShow = false;\n    this.$element.find('.subject-list-item__num--error').each(function () {\n      errorTip = errorTip + $(this).find('.js-list-index').text() + '';\n      isShow = true;\n    });\n    errorTip = Translator.trans('subject.question_error_tip', {seqs: errorTip.substring(0, errorTip.length - 1)});\n    if (isShow) {\n      $('.js-error-tip').html(errorTip);\n    } else {\n      $('.js-error-tip').html('');\n    }\n  }\n\n  static _serializeArrayConvertToJson(data){\n    let serializeObj={};\n    for (let item of data) {\n      if (serializeObj[item.name]) {\n        if (!serializeObj[item.name].push) {\n          serializeObj[item.name] = [serializeObj[item.name]];\n        }\n        serializeObj[item.name].push(item.value);\n      } else {\n        serializeObj[item.name] = item.value;\n      }\n    }\n    return serializeObj;\n  }\n\n  addModalShow(event, isAddSub) {\n    if (this.isEditing()) {\n      return;\n    }\n\n    let $target = $(event.currentTarget);\n    let $modal = $('#cd-modal');\n    let token = $target.closest('.js-subject-item').attr('id');\n    if (isAddSub) {\n      $modal.find('[data-type=\"material\"]').addClass('hidden');\n      $modal.attr('data-sub', 'true');\n    } else {\n      $modal.find('[data-type=\"material\"]').removeClass('hidden');\n      $modal.attr('data-sub', 'false');\n    }\n    $modal.attr('data-index', token);\n    $modal.modal('show');\n  }\n  \n  isEditing() {\n    const $editItem = $('.js-subject-edit-item');\n    const isSub = $editItem.hasClass('js-sub-edit-item');\n    let parentNum = '';\n    if ($editItem.length !== 0) {\n      const seq = $editItem.find('.js-edit-form-seq').text();\n      if (isSub) {\n        const id = $editItem.find('.js-hidden-token').val();\n        const parentSeq = $(`#${id}`).find('.js-subject-item-number').text();\n        parentNum = $.trim(parentSeq);\n      }\n      const message = isSub ? Translator.trans('subject.sub_is_editing_warning', {parentNum:parentNum, seq:seq}) :Translator.trans('subject.is_editing_warning', {seq: seq});\n      cd.message({\n        type: 'warning',\n        message: message,\n      });\n      return true;\n    }\n\n    return false;\n  }\n\n  questionTypeConvert(type, token) {\n    let $list = $('.js-subject-list').find(`[data-anchor=#${token}]`);\n    $list.find('.js-show-checkbox').attr('data-type', type);\n    $list.next('.js-type-name').text(this.getTypeName(type));\n  }\n\n  getTypeName(type) {\n    switch (type) {\n    case 'single_choice':\n      return Translator.trans('course.question.type.single_choice');\n    case 'uncertain_choice':\n      return Translator.trans('course.question.type.uncertain_choice');\n    case 'choice':\n      return Translator.trans('course.question.type.choice');\n    case 'determine':\n      return Translator.trans('course.question.type.determine');\n    case 'essay':\n      return Translator.trans('course.question.type.essay');\n    case 'fill':\n      return Translator.trans('course.question.type.fill');\n    case 'material':\n      return Translator.trans('course.question.type.material');\n    default:\n      return Translator.trans('course.question.type.unknown');\n    }\n  }\n\n  ieImg() {\n    if (Browser.ie10 || Browser.ie11) {\n      this.$itemList.addClass('ie-item-list');\n    }\n  }\n}\n\nnew sbList();\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/index.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _getPrototypeOf = require(\"../core-js/object/get-prototype-of\");\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _getOwnPropertyDescriptor = require(\"../core-js/object/get-own-property-descriptor\");\n\nvar _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = (0, _getOwnPropertyDescriptor2.default)(object, property);\n\n  if (desc === undefined) {\n    var parent = (0, _getPrototypeOf2.default)(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/get.js\n// module id = c56870cab48202a6146a\n// module chunks = app/js/subject/index","import BaseQuestion from './base-question';\n\nclass Material extends BaseQuestion {\n  constructor($form, object) {\n    super($form, object);\n    \n    this.initTitleEditor(this.validator);\n  }\n}\n\nexport default Material;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/type/material-question.js","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js\n// module id = db627c66114adc9bda79\n// module chunks = app/js/subject/index","import Choice from './choice-question';\n\nclass SingleChoice extends Choice {\n  constructor($form, object) {\n    super($form, object);\n    this.errorMessage = {\n      noAnswer: Translator.trans('subject.choice_require_answer'),\n    };\n  }\n\n  initEvent() {\n    super.initEvent();\n    this.$form.on('change', 'input:radio[name=\"right\"]', event => this.changeRadio(event));\n  }\n\n  initData() {\n    super.initData();\n    const $itemWrap = this.$form.find('.js-choose-item');\n    $('.cd-radio.checked').find('[name=\"right\"]').attr('checked', true);\n    this.checkedRadio = $itemWrap.find('.cd-radio.checked');\n  }\n\n  initValidator() {\n    super.initValidator();\n    $.validator.addMethod('multi', function(value, element, param) {\n      return true;\n    });\n  }\n\n  changeRadio(event) {\n    if (this.checkedRadio) {\n      this.checkedRadio.removeClass('checked');\n    }\n    this.checkedRadio = $(event.currentTarget).parent();\n  }\n}\n\nexport default SingleChoice;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/type/single-choice-question.js","import BaseQuestion from './base-question';\n\nclass Choice extends BaseQuestion {\n  constructor($form, object) {\n    super($form, object);\n    this.validator = null;\n    this.oldFieldId = 'question-stem-field';\n    this.fieldId = '';\n    this.optionCount = 0;\n    this.timer = false;\n    this.errorMessage = {\n      noAnswer: Translator.trans('subject.choice_answer_least_two'),\n    };\n    this.init();\n  }\n\n  init() {\n    this.initTitleEditor(this.validator);\n    this.initOptionCount();\n    this.initData();\n    this.initEvent();\n    this.initValidator();\n  }\n\n  initOptionCount() {\n    this.optionCount = $('.edit-subject-item').length;\n  }\n\n  initEvent() {\n    this.$form.on('focus', '.js-item-option-edit', event => this.editOption(event));\n    this.$form.on('click', '.js-item-option-delete', event => this.deleteOption(event));\n    this.$form.on('click', '.js-item-option-add', event => this.addOption(event));\n    this.$form.on('click', '[data-role=\"edit\"]', event => this.editOption(event));\n  }\n\n  initData() {\n    $('.cd-checkbox.checked').find('[name=\"right\"]').attr('checked', true);\n  }\n\n  initValidator() {\n    if ($.validator) {\n      $.validator.prototype.elements = function() {\n        let validator = this,\n            rulesCache = {};\n        return $(this.currentForm)\n            .find('input, textarea')\n            .not(':submit, :reset, :image, [disabled]')\n            .not(this.settings.ignore)\n            .filter(function () {\n              if (!this.name && validator.settings.debug && window.console) {\n                console.error(\"%o has no name assigned\", this);\n              }\n              rulesCache[this.name] = true;\n              return true;\n            });\n      };\n      $.validator.addMethod('noMoreThan', function(value, element, param) {\n        if (value == '') {\n          return true;\n        } else {\n          return parseFloat(value) <= parseFloat($(param).val());\n        }\n      }, 'Please enter a lesser value.' );\n      $.validator.addMethod('multi', function(value, element, param) {\n        return $('input:checkbox[name=\"right\"]:checked').length > 1;\n      });\n    }\n\n    let self = this;\n    this.$form.validate().destroy();\n    this.validator = this.$form.validate({\n      onkeyup: false,\n      rules: {\n        score: {\n          required: true,\n          max: 999,\n          min: 0,\n          es_score: true\n        },\n        missScore: {\n          required: false,\n          max: 999,\n          min: 0,\n          noMoreThan: '[name=\"score\"]',\n          es_score: true\n        },\n        stem: {\n          required: true,\n        },\n        options: {\n          required: true,\n        },\n        right: {\n          required: true,\n          multi: true,\n        }\n      },\n      messages: {\n        missScore: {\n          noMoreThan: Translator.trans('subject.miss_score_no_more_than_score')\n        },\n        stem: {\n          required: Translator.trans('subject.validate.stem_required')\n        },\n        options: {\n          required: Translator.trans('subject.validate.option_required')\n        }\n      },\n      errorPlacement: function(error, element) {\n        let elementName = element.attr('name');\n        if (elementName == 'right') {\n          $('.edit-subject-item__order').addClass('edit-subject-item__order--error');\n          cd.message({\n            type: 'danger',\n            message: self.errorMessage['noAnswer'],\n          });\n        } else if (elementName == 'stem') {\n          $('#cke_question-stem-field').after(error);\n        } else if (elementName == 'options' && element.prev().hasClass('hidden')) {\n          error.appendTo(element.parent());\n        } else {\n          error.insertAfter(element);\n        }\n      }\n    });\n  }\n\n  editOption(event) {\n    let self = this;\n    const $input = $(event.currentTarget);\n    const $textArea = $input.next();\n    this.fieldId = $textArea.attr('id');\n    $input.addClass('hidden');\n\n    let $target = $('#' + this.fieldId);\n    let editor = null;\n\n    if (CKEDITOR.instances[this.oldFieldId]) {\n      editor = CKEDITOR.instances[this.oldFieldId];\n      let $oldTarget = $('#' + this.oldFieldId);\n      $oldTarget.addClass('hidden');\n      $oldTarget.prevAll('input').first().removeClass('hidden').show().val($(self.replacePicture(editor.getData())).text());\n      CKEDITOR.instances[this.oldFieldId].destroy();\n    }\n    this.oldFieldId = this.fieldId;\n\n    if (CKEDITOR.instances[this.fieldId]) {\n      CKEDITOR.instances[this.fieldId].destroy();\n    }\n    editor = CKEDITOR.replace(this.fieldId, {\n      toolbar: 'Minimal',\n      fileSingleSizeLimit: app.fileSingleSizeLimit,\n      filebrowserImageUploadUrl: $target.data('imageUploadUrl'),\n      height: $target.height(),\n      startupFocus: true,\n    });\n    editor.focus();\n\n    editor.on('change', () => {\n      $target.val(editor.getData());\n      $target.prev('input').val($(self.replacePicture(editor.getData())).text());\n    });\n    editor.on('blur', () => {\n      $target.val(editor.getData());\n      $target.prev('input').val($(self.replacePicture(editor.getData())).text());\n    });\n  }\n\n  deleteOption(event) {\n    if (this.optionCount <= 2) {\n      cd.message({\n        type: 'danger',\n        message: Translator.trans('subject.choice_option_least_two'),\n      });\n      return;\n    }\n\n    const $editItem = $(event.currentTarget).parents('.edit-subject-item');\n    let orderText = $editItem.find('.edit-subject-item__order').text();\n    let radioValue = $editItem.find('input[name=\"right\"]').val();\n    $editItem.nextAll('.edit-subject-item').each(function() {\n      let $order = $(this).find('.edit-subject-item__order');\n      let oldOrderText = $order.text();\n      $order.text(orderText);\n      orderText = oldOrderText;\n      $(this).find('input[name=\"right\"]').val(radioValue);\n      radioValue++;\n    });\n\n    $editItem.remove();\n    this.optionCount--;\n  }\n\n  addOption(event) {\n    const self = this;\n    if (self.timer) clearTimeout(self.timer);\n    self.timer = setTimeout(() => {\n      self.addRealOperate(event);\n    }, 500);\n  }\n\n  addRealOperate(event) {\n    let $target = $(event.currentTarget);\n    if (this.optionCount >= 10) {\n      cd.message({\n        type: 'danger',\n        message: Translator.trans('subject.choice_option_most_ten'),\n      });\n      $target.attr('disabled', false);\n      return;\n    }\n\n    const type = $('[name=\"type\"]').val();\n\n    $.ajax({\n      url: `/subject/option/${type}`,\n      type: 'get',\n      data: {order: this.optionCount}\n    }).done(resp => {\n      $(event.currentTarget).parent().before(resp);\n      this.optionCount++;\n    });\n  }\n\n  submitForm(event) {\n    if (this.optionCount < 2) {\n      cd.message({\n        type: 'danger',\n        message: Translator.trans('subject.choice_option_least_two'),\n      });\n      return;\n    }\n    this.validator.resetForm();\n    if (this.validator.form()) {\n      $(event.currentTarget).button('loading');\n      this.finishEdit(this.$form.serializeArray());\n    }\n  }\n\n  finishEdit(data) {\n    let token = $('.js-hidden-token').val();\n    let self = this;\n    let question = {\n      options: [],\n      answers: [],\n    };\n    $.each(data, function(index, item) {\n      let name = item['name'],\n          value = item['value'];\n      if ($.inArray(name, ['stem', 'difficulty', 'score', 'missScore', 'type', 'analysis', 'courseId', 'lessonId']) !== -1) {\n        question[name] = value;\n      } else if (name == 'options') {\n        question['options'].push(value);\n      } else if (name == 'right') {\n        question['answers'].push(value);\n      }\n    });\n    question['attachment'] = this.getAttachments();\n    let method = $('.js-hidden-method').val();\n    let isSub = $('.js-sub-judge').val();\n    let key = $('.js-edit-form-seq').text() - 1;\n    let seq = 0;\n    if (isSub == '1') {\n      token = self.updataCachedSubQuestion(token, key, question, method);\n      question = self.operate.getSubQuestion(token, key);\n      seq = key + 1;\n    } else {\n      token = self.updataCachedQuestion(token, question, method);\n      question = self.operate.getQuestion(token);\n      seq = self.operate.getQuestionOrder(token);\n    }\n    this.analysisEditor.destroy();\n    $.post(self.$form.data('url'), {'seq': seq, 'question': question, 'token': token, 'isSub': isSub}, html => {\n      self.$form.parent('.subject-item').replaceWith(html);\n    });\n  }\n}\n\nexport default Choice;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/type/choice-question.js","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/node_modules/core-js/library/fn/get-iterator.js\n// module id = e7ceb28b20870340ea1d\n// module chunks = app/js/course-manage/overview/index app/js/subject/index","var anObject = require('./_an-object');\nvar get = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function (it) {\n  var iterFn = get(it);\n  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/node_modules/core-js/library/modules/core.get-iterator.js\n// module id = f320218143ef18cc600c\n// module chunks = app/js/course-manage/overview/index app/js/subject/index","import AttachmentActions from '../../attachment/widget/attachment-actions';\n\nclass BaseQuestion {\n  constructor($form, object) {\n    this.$form = $form;\n    this.operate = object;\n    this.titleFieldId = 'question-stem-field';\n    this.$analysisModal = $('.js-analysis-modal');\n    this.validator = null;\n    this.titleEditorToolBarName = 'Minimal';\n    this.analysisEditor = null;\n    this._init();\n    this.attachmentActions = new AttachmentActions($form);\n  }\n\n  _init() {\n    this._initEvent();\n    this._initValidate();\n    this._initAnalysisEditor();\n    this._initSelect();\n  }\n\n  _initEvent() {\n    this.$form.on('click', '.js-finish-edit', event => this.submitForm(event));\n    this.$form.on('click', '.js-analysis-edit', event => this.showAnalysisModal(event));\n    this.$analysisModal.on('click', '.js-analysis-btn', event => this.saveAnalysis(event));\n    $('[data-toggle=\"tooltip\"]').tooltip();\n  }\n\n  _initSelect() {\n    let courseSelect = cd.select({\n      el: '#courseEditBelong',\n      type: 'single',\n      parent: '.js-setting-item'\n    });\n\n    let lessonSelect = cd.select({\n      el: '#lessonEditBelong',\n      type: 'single',\n      parent: '.js-setting-item'\n    });\n\n    courseSelect.on('change', (value, text) => {\n      let url = $('#courseEditBelong').data('url');\n      let select2 = $('.js-lessonSelect');\n      $('.js-lesson-edit-options').html('');\n      $('.js-lessonSelect').find('input[name=\"lessonId\"]').val(0);\n      $('.js-lessonSelect').find('.select-value').text(Translator.trans('site.choose_hint'));\n      if (value == 0) {\n        select2.hide();\n        return;\n      }\n\n      $.post(url,{courseId:value},function(result){\n        if (result != '') {\n          let option = '<li class=\"checked\" data-value=\"0\">'+Translator.trans('site.choose_hint')+'</li>';\n          let $class = '';\n          $.each(result,function(index,task){\n            if(index == 0){\n              $class = 'tip-count-1';\n            }else{\n              $class = '';\n            }\n            option += `<li data-value=\"${task.id}\" class=\"${$class}\" title=\"${task.title}\" data-toggle=\"tooltip\" data-placement=\"top\" >${task.title}</li>`;\n          });\n          $('.js-lesson-edit-options').append(option);\n          $('[data-toggle=\"tooltip\"]').tooltip();\n          select2.show();\n        } else {\n          select2.hide();\n        }\n      });\n    });\n\n    $('#courseEditBelong').on('click', (value, text) => {\n      lessonSelect.clear();\n    });\n\n    $('#lessonEditBelong').on('click', (value, text) => {\n      courseSelect.clear();\n    });\n  }\n\n  submitForm(event) {\n    let self = this;\n    if (self.validator.form()) {\n      $(event.currentTarget).button('loading');\n      let question = self.getQuestion();\n      self.finishEdit(question);\n      self.changeBottomFixed();\n    }\n  }\n\n  changeBottomFixed() {\n    const visibleBottom = parseInt(window.scrollY + document.documentElement.clientHeight);\n    let footerBottom = 0;\n    // \n    if ($('.es-footer-link').length) {\n      footerBottom = parseInt($('.es-footer-link').offset().top);\n    } else {\n      if ($('.es-footer').length) {\n        footerBottom = parseInt($('.es-footer').offset().top);\n      }\n    }\n    // \n    if (!footerBottom) {\n      const scrollHeight = parseInt($(document).scrollTop());\n      const windowHeight = parseInt($(document.body).height());\n      const visibleHeight = parseInt($(window).height());\n      const offsetHeight = windowHeight - 560;\n      if ((scrollHeight + visibleHeight) >= offsetHeight) {\n        $('.js-subject-item-btn').removeClass('subject-bottom-fixed');\n      }\n    } else {\n      if (footerBottom < visibleBottom) {\n        $('.js-subject-item-btn').removeClass('subject-bottom-fixed');\n      }\n    }\n  }\n\n  _initAnalysisEditor() {\n    let analysis = this.$form.find('[data-edit=\"analysis\"]').val();\n    let $textarea = $('.js-analysis-field');\n    if (CKEDITOR.instances[$textarea.attr('id')]) {\n      CKEDITOR.instances[$textarea.attr('id')].destroy();\n    }\n\n    $textarea.val(analysis);\n    this.analysisEditor = CKEDITOR.replace($textarea.attr('id'), {\n      toolbar: this.titleEditorToolBarName,\n      fileSingleSizeLimit: app.fileSingleSizeLimit,\n      filebrowserImageUploadUrl: $textarea.data('imageUploadUrl'),\n      height: $textarea.height()\n    });\n\n    this.analysisEditor.on('change', () => {\n      $textarea.val(this.analysisEditor.getData());\n    });\n    this.analysisEditor.on('blur', () => {\n      $textarea.val(this.analysisEditor.getData());\n    });\n  }\n\n  showAnalysisModal(event) {\n    let $target = $(event.currentTarget);\n    let analysis = $target.prev('[data-edit=\"analysis\"]').val();\n    this.analysisEditor.setData(analysis);\n\n    this.$analysisModal.modal('show');\n  }\n\n  saveAnalysis(event) {\n    let data = this.analysisEditor.getData();\n    $('[data-edit=\"analysis\"]').val(data);\n    $('.js-analysis-content').html($(this.replacePicture(data)).text());\n    this.$analysisModal.modal('hide');\n  }\n\n  finishEdit(question) {\n    let self = this;\n    let token = $('.js-hidden-token').val();\n    let method = $('.js-hidden-method').val();\n    let isSub = $('.js-sub-judge').val();\n    let key = $('.js-edit-form-seq').text() - 1;\n    let seq = 0;\n    if (isSub == '1') {\n      token = self.updataCachedSubQuestion(token, key, question, method);\n      question = self.operate.getSubQuestion(token, key);\n      seq = key + 1;\n    } else {\n      token = self.updataCachedQuestion(token, question, method);\n      question = self.operate.getQuestion(token);\n      seq = self.operate.getQuestionOrder(token);\n    }\n\n    this.analysisEditor.destroy();\n    $.post(self.$form.data('url'), {'seq': seq, 'question': question, 'token': token, 'isSub': isSub}, html=> {\n      self.$form.parent('.subject-item').replaceWith(html);\n    });\n  }\n\n  updataCachedQuestion(token, question, method) {\n    let self = this;\n    if (method == 'add') {\n      token = self.operate.addQuestion(token, question);\n    } else {\n      $.each(question, function(name, value){\n        self.operate.updateQuestionItem(token, name, value);\n      });\n      self.operate.correctQuestion(token);\n    }\n\n    return token;\n  }\n\n  updataCachedSubQuestion(token, key, question, method) {\n    let self = this;\n    if (method == 'add') {\n      token = self.operate.addSubQuestion(token, question);\n    } else {\n      $.each(question, function(name, value){\n        self.operate.updateSubQuestionItem(token, key, name, value);\n      });\n      self.operate.correctSubQuestion(token, key);\n    }\n\n    return token;\n  }\n\n  getQuestion() {\n    let question = {};\n\n    $('*[data-edit]').each(function(){\n      let name = $(this).data('edit');\n      let value = $(this).val();\n      question[name] = value;\n    });\n    question['difficulty'] = $('input[name=\\'difficulty\\']:checked').val();\n    question['attachment'] = this.getAttachments();\n    question = this.filterQuestion(question);\n\n    return question;\n  }\n\n  filterQuestion(question) {\n    return question;\n  }\n\n  getAttachments() {\n    let attachments = {};\n    if ($('.js-attachment-list-stem').find('.js-attachment-name').length > 0) {\n      attachments['stem'] = {\n        \"type\" : \"attachment\",\n        \"targetType\" : \"question.stem\",\n        \"fileIds\" : $('.js-attachment-ids-stem').val(),\n        \"fileName\" : $('.js-attachment-list-stem').find('.js-attachment-name').text()\n      };\n    }\n\n    if ($('.js-attachment-list-analysis').find('.js-attachment-name').length > 0) {\n      attachments['analysis'] = {\n        \"type\" : \"attachment\",\n        \"targetType\" : \"question.analysis\",\n        \"fileIds\" : $('.js-attachment-ids-analysis').val(),\n        \"fileName\" : $('.js-attachment-list-analysis').find('.js-attachment-name').text()\n      };\n    }\n    \n    return attachments;\n  }\n\n  _initValidate() {\n    let validator = this.$form.validate({\n      onkeyup: false,\n      rules: {\n        difficulty: {\n          required: true,\n        },\n        stem: {\n          required: true,\n        },\n        score: {\n          required: true,\n          number: true,\n          max: 999,\n          min: 0,\n          es_score: true\n        }\n      },\n      messages: {\n        difficulty: Translator.trans('course.question.create.difficulty_required_error_hint'),\n        stem: {required: Translator.trans('subject.stem_required')}\n      }\n    });\n    this.validator = validator;\n  }\n\n  initTitleEditor(validator) {\n    let self = this;\n    let $target = $('#' + self.titleFieldId);\n    let $input = $target.prev();\n    let editor = CKEDITOR.replace(self.titleFieldId, {\n      toolbar: self.titleEditorToolBarName,\n      fileSingleSizeLimit: app.fileSingleSizeLimit,\n      filebrowserImageUploadUrl: $target.data('imageUploadUrl'),\n      height: $target.height()\n    });\n\n    editor.on('change', () => {\n      $target.val(editor.getData());\n      // validator.form();\n      $input.val($(self.replacePicture(editor.getData())).text());\n    });\n    editor.on('blur', () => {\n      $target.val(editor.getData());\n      // validator.form();\n      $input.val($(self.replacePicture(editor.getData())).text());\n    });\n    editor.on('instanceReady', function() {\n      this.focus();\n\n      $('[data-role=\"edit\"]').one('click', function() {\n        $input.val($(self.replacePicture(editor.getData())).text());\n        $target.val(editor.getData());\n        editor.destroy();\n        $target.hide();\n        $input.show();\n      });\n    });\n  }\n\n  replacePicture(str) {\n    return str.replace(/<img [^>]*src=['\"]([^'\"]+)[^>]*>/gi, `[${Translator.trans('subject.symbol.picture')}]`);\n  }\n\n  set titleEditorToolBarName(toolbarName) {\n    this._titleEditorToolBarName = toolbarName;\n  }\n\n  get titleEditorToolBarName() {\n    return this._titleEditorToolBarName;\n  }\n}\n\nexport default BaseQuestion;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/subject/type/base-question.js"],"sourceRoot":""}