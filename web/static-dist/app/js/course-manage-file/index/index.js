webpackJsonp(["app/js/course-manage-file/index/index"],{0:function(e,t){e.exports=jQuery},"6e356d846d461116e504":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var i=a("7532f0ef07bc5b209c06"),r=n(i),l=a("e51bac35e7290fbcdec6"),s=n(l),c=a("d919d1055afe1010ecbe"),o=n(c),d=$("#file-manage-panel");new r.default(d),(0,o.default)("#modal-tags","remote");var u=$("#tag-form"),f=(u.validate({rules:{tags:{required:!0}},messages:{tags:{required:Translator.trans("course_set.manage.tag_required_hint")}}}),function(e){var t=document.createElement("iframe");t.style.display="none",t.style.height=0,t.src=e,document.body.appendChild(t),setTimeout(function(){t.remove()},3e5)}),h=function(){var e=[];$("#file-manage-panel").find("[data-role=batch-item]:checked").each(function(){var t=$(this).closest(".js-tr-item").find(".js-download-btn").data("url");e.push(t)});for(var t=0;t<e.length;t++){var a=e[t];f(a)}},b=function(){$("#cd-modal").on("show.bs.modal",function(e){var t=$(e.relatedTarget),a=t.data("title"),n=t.data("reason"),i=t.data("solution"),r=t.data("status");$(".js-error-tip").html('<div class="mbl clearfix"><span class="pull-left error-label">'+Translator.trans("material.common_table.file_name")+'：</span><span class="pull-left error-content">'+a+'</span></div><div class="mbl clearfix"><span class="pull-left error-label">'+Translator.trans("material.common_table.transcoding")+'：</span><span class="pull-left error-content">'+r+'</span></div><div class="mbl clearfix"><span class="pull-left error-label">'+Translator.trans("material.common_table.error_reason")+'：</span><span class="cd-text-danger error-content pull-left">'+n+'</span></div><div class="clearfix"><span class="pull-left error-label">'+Translator.trans("material.common_table.solution_way")+'：</span><span class="cd-text-info error-content pull-left">'+i+"</span></div>")})};d.on("click",".js-cd-modal",function(){b()}),d.on("click",".js-batch-download",function(){h()}),d.on("click",".convert-file-btn",function(){$.post($(this).data("url"),function(e){"error"==e.status?alert(e.message):window.location.reload()},"json").fail(function(){alert(Translator.trans("alert.file_convert_error.message"))})}),$(".tip").tooltip(),$("#modal").modal({backdrop:"static",keyboard:!1,show:!1}),$("button",".panel-heading").on("click",function(){var e=$(this).data("url");$("#modal").html(""),$("#modal").modal("show"),$.get(e,function(e){$("#modal").html(e)})});var v=function(e){var t=($(e.currentTarget),[]);d.find("[data-role=batch-item]:checked").each(function(){t.push(this.value)}),$("#select-tag-items").val(t),$("#tag-modal").modal("show")};d.on("click",".js-batch-tag-btn",function(e){v(e)}),$("[rel='tooltip']").tooltip(),function(){var e=new Array;$("tbody [type=checkbox]").each(function(){isNaN($(this).val())||e.push($(this).val())}),0!=e.length&&$.post($("#file-manage-panel").data("fileStatusUrl"),{ids:e.join(",")},function(e){if(e&&0!=e.length)for(var t=0;t<e.length;t++){var a=e[t];$.inArray(a.type,["video","ppt","document"])>-1&&"cloud"==a.storage&&("waiting"==a.convertStatus||"doing"==a.convertStatus?$("#upload-file-tr-"+a.id).find("a:first ~ br:first").after("<span class='color-warning mr5 text-sm'>"+Translator.trans("page.file_converting.message")+"</span><br/>"):"error"==a.convertStatus?$("#upload-file-tr-"+a.id).find("a:first ~ br:first").after("<span class='color-danger mr5 text-sm'>"+Translator.trans("page.file_convert_failed.message")+"</span><br/>"):"none"==a.convertStatus?$("#upload-file-tr-"+a.id).find("a:first ~ br:last").after("<span class='label label-default mr5 tip'>"+Translator.trans("page.file_not_convert.message")+"</span>"):"success"==a.convertStatus&&$("#upload-file-tr-"+a.id).find("a:first ~ br:last").after("<span class='label label-success mr5 tip'>"+Translator.trans("page.file_converted.message")+"</span>")),"video"==a.type&&a.metas2&&(a.metas2.shd?$("#upload-file-tr-"+a.id).find("a:first ~ br:first").after('<span class="label label-info mr5 tip">'+Translator.trans("page.video_shd.message")+"</span>"):a.metas2.hd?$("#upload-file-tr-"+a.id).find("a:first ~ br:first").after('<span class="label label-info mr5 tip">'+Translator.trans("page.video_hd.message")+"</span>"):a.metas2.sd&&$("#upload-file-tr-"+a.id).find("a:first ~ br:first").after('<span class="label label-info mr5 tip">'+Translator.trans("page.video_sd.message")+"</span>"))}})}(),$("[data-role=batch-delete]").click(function(){var e=!1,t=[];$("[data-role=batch-item]").each(function(){$(this).is(":checked")&&(e=!0,t.push(this.value))}),e&&($("#modal").html(""),$("#modal").load($(this).data("url"),{ids:t}),$("#modal").modal("show"))}),$(".js-delete-btn").click(function(e){var t=$(e.target),a=t.data("id"),n=t.data("url"),i=[];i.push(a),$("#modal").html(""),$("#modal").load(n,{ids:i}),$("#modal").modal("show")});var m=!0;$(".js-detail-btn").on("click",function(){if(m){m=!1;var e=$("#file-manage-panel");$.ajax({type:"GET",url:$(this).data("url")}).done(function(t){$(e).hide(),$(e).prev().hide(),$(e).parent().append(t),$(".nav.nav-tabs").length>0&&!navigator.userAgent.match(/(iPhone|iPod|Android|ios|iPad)/i)&&$(".nav.nav-tabs").lavaLamp(),(0,o.default)("#tags","remote"),new s.default({element:$("#material-detail"),callback:function(){$(e).show(),$(e).prev().show(),window.location.reload()}})}).fail(function(){cd.message({type:"danger",message:Translator.trans("material_lib.have_no_permission_hint")})}).always(function(){m=!0})}})},"7532f0ef07bc5b209c06":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("7ab4a89ebadbfdecc2bf"),r=n(i),l=a("4602c3f5fe7ad9e3e91d"),s=n(l),c=function(){function e(t){(0,r.default)(this,e),this.$element=t,this.initEvent()}return(0,s.default)(e,[{key:"initEvent",value:function(){var e=this;this.$element.on("click",'[data-role="batch-select"]',function(t){return e._batch2Item(t)}),this.$element.on("click",'[data-role="batch-item"]',function(t){return e._item2Batch(t)})}},{key:"_batch2Item",value:function(e){var t=$(e.currentTarget).prop("checked");this.$element.find('[data-role="batch-select"]').prop("checked",t),this.$element.find('[data-role="batch-item"]:visible').prop("checked",t),t?$(".js-batch-tag-btn, .js-batch-delete-btn, .js-batch-share-btn, .js-batch-download").attr("disabled",!1):0==this.$element.find('[data-role="batch-item"]:checked').length&&$(".js-batch-tag-btn, .js-batch-delete-btn, .js-batch-share-btn, .js-batch-download").attr("disabled",!0)}},{key:"_item2Batch",value:function(e){var t=this.$element.find('[data-role="batch-item"]:visible').length,a=this.$element.find('[data-role="batch-item"]:checked').length;0!==a?$(".js-batch-tag-btn, .js-batch-delete-btn, .js-batch-share-btn, .js-batch-download").attr("disabled",!1):$(".js-batch-tag-btn, .js-batch-delete-btn, .js-batch-share-btn, .js-batch-download").attr("disabled",!0),t==a?this.$element.find('[data-role="batch-select"]').prop("checked",!0):this.$element.find('[data-role="batch-select"]').prop("checked",!1)}}]),e}();t.default=c},"8e57c009b06dc22fb38f":function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("7ab4a89ebadbfdecc2bf"),r=n(i),l=a("4602c3f5fe7ad9e3e91d"),s=n(l),c=a("b334fd7e4c5a19234db2"),o=n(c),d=a("06597b47670159844043"),u=n(d),f=function(){function e(t){(0,r.default)(this,e),this.callback=t.callback,this.element=t.element,this.init()}return(0,s.default)(e,[{key:"init",value:function(){this.initEvent(),this._initPlayer()}},{key:"initEvent",value:function(){var e=this;$(".js-img-set").on("click",function(t){e.onClickChangePic(t)}),$(".js-reset-btn").on("click",function(t){e.onClickReset(t)}),$(".js-set-default").on("click",function(t){e.onClickDefault(t)}),$(".js-set-select").on("click",function(t){e.onClickSelect(t)}),$(".js-screenshot-btn").on("click",function(t){e.onClickScreenshot(t)}),$("#cover-form").on("submit",function(t){e.onSubmitCoverForm(t)})}},{key:"onClickChangePic",value:function(e){var t=$(e.currentTarget),a=t.closest("#cover-tab");a.find(".js-cover-img").attr("src",t.attr("src")),a.find("#thumbNo").val(t.data("no"))}},{key:"onClickReset",value:function(){$("#thumbNo").val(""),$(".js-cover-img").attr("src",$("#orignalThumb").val())}},{key:"onClickDefault",value:function(e){this._changePane($(e.currentTarget))}},{key:"onClickSelect",value:function(e){this._changePane($(e.currentTarget))}},{key:"onClickScreenshot",value:function(){var e=$(event.currentTarget),t=this;e.button("loading");var a=t.second;$.ajax({type:"get",url:e.data("url"),data:{second:a}}).done(function(n){"success"==n.status?t._successGeneratePic(e,n):"waiting"==n.status?t.intervalId=setInterval(function(){$.get(e.data("url"),{second:a},function(a){"success"==a.status&&(t._successGeneratePic(e,a),clearInterval(t.intervalId))})},3e3):(e.button("reset"),(0,o.default)("danger",Translator.trans("meterial_lib.generate_screenshots_error_hint")))}).fail(function(){e.button("reset"),(0,o.default)("danger",Translator.trans("meterial_lib.generate_screenshots_error_hint"))})}},{key:"onSubmitCoverForm",value:function(e){var t=$(e.currentTarget);t.find("#save-btn").button("loading"),t.find("#thumbNo").val()?$.ajax({type:"POST",url:t.attr("action"),data:t.serialize()}).done(function(){(0,o.default)("success",Translator.trans("site.save_success_hint"))}).fail(function(){(0,o.default)("danger",Translator.trans("site.save_error_hint"))}).always(function(){t.find("#save-btn").button("reset")}):((0,o.default)("success",Translator.trans("site.save_success_hint")),t.find("#save-btn").button("reset")),e.preventDefault()}},{key:"destroy",value:function(){clearInterval(this.intervalId)}},{key:"_initPlayer",value:function(){var e=this;if($("#viewerIframe").length>0){$("#viewerIframe");new u.default({name:"parent",project:"PlayerProject",children:[document.getElementById("viewerIframe")],type:"parent"}).on("video.timeupdate",function(t){e.second=Math.floor(t.currentTime)})}}},{key:"_successGeneratePic",value:function(e,t){e.button("reset"),(0,o.default)("success",Translator.trans("meterial_lib.generate_screenshots_success_hint"));var a=e.closest("#cover-tab");a.find(".js-cover-img").attr("src",t.url),a.find("#thumbNo").val(t.no)}},{key:"_changePane",value:function(e){e.closest(".nav").find("li.active").removeClass("active"),e.addClass("active");var t=$(".tab-content-img");t.find(".tab-pane-img.active").removeClass("active"),t.find(e.data("target")).addClass("active")}}]),e}();t.default=f},a0438f6657de6354719c:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("7ab4a89ebadbfdecc2bf"),r=n(i),l=a("4602c3f5fe7ad9e3e91d"),s=n(l),c=a("b334fd7e4c5a19234db2"),o=n(c),d=a("d919d1055afe1010ecbe"),u=n(d),f=function(){function e(t){(0,r.default)(this,e),this.element=t.element,this.callback=t.callback,this.init()}return(0,s.default)(e,[{key:"init",value:function(){this.initEvent(),this._initTag()}},{key:"initEvent",value:function(){var e=this;$("#info-form").on("submit",function(t){e.onSubmitInfoForm(t)})}},{key:"_initTag",value:function(){(0,u.default)("#infoTags","remote",{width:"off"})}},{key:"onSubmitInfoForm",value:function(e){var t=$(e.currentTarget);t.find("#info-save-btn").button("loading"),$.ajax({type:"POST",url:t.attr("action"),data:$("#info-form").serialize()}).done(function(){(0,o.default)("success",Translator.trans("site.save_success_hint"))}).fail(function(){(0,o.default)("danger",Translator.trans("site.save_error_hint"))}).always(function(){t.find("#info-save-btn").button("reset")}),e.preventDefault()}}]),e}();t.default=f},d919d1055afe1010ecbe:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("adc6e7d88332518aa1ec"),i=function(e){return e&&e.__esModule?e:{default:e}}(n),r=function(e,t,a){var n={};"remote"===t&&(n={ajax:{url:$(e).data("url"),dataType:"json",quietMillis:100,data:function(e,t){return{q:e,page_limit:10}},results:function(e){var t=[];return $.each(e,function(e,a){t.push({id:a.name,name:a.name})}),{results:t}}},initSelection:function(e,t){var a=[];$(e.val().split(",")).each(function(){a.push({id:this,name:this})}),t(a)},formatSelection:function(e){return e.name},formatResult:function(e){return e.name},width:400,multiple:!0,placeholder:Translator.trans("validate.tag_required_hint"),createSearchChoice:function(){return null},maximumSelectionSize:20}),$(e).select2((0,i.default)(n,a))};t.default=r},e51bac35e7290fbcdec6:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("7ab4a89ebadbfdecc2bf"),r=n(i),l=a("4602c3f5fe7ad9e3e91d"),s=n(l),c=a("a0438f6657de6354719c"),o=n(c),d=a("8e57c009b06dc22fb38f"),u=n(d),f=function(){function e(t){(0,r.default)(this,e),this.callback=t.callback,this.element=t.element,this.init()}return(0,s.default)(e,[{key:"init",value:function(){this.initEvent(),$("#cover-tab").length>0&&(this.cover=new u.default({element:$("#cover-tab")})),this.info=new o.default({element:$("#info-tab")})}},{key:"initEvent",value:function(){var e=this;$(".js-back").on("click",function(t){e.onClickBack(t)}),$(".js-cover").on("click",function(t){e.onClickCover(t)}),$(".js-info").on("click",function(t){e.onClickInfo(t)})}},{key:"onClickInfo",value:function(e){var t=$(e.currentTarget);this._changePane(t)}},{key:"onClickCover",value:function(e){var t=$(e.currentTarget);this._changePane(t)}},{key:"onClickBack",value:function(){this.back()}},{key:"back",value:function(){this.callback(),this.element.remove(),$(".panel-heading").html(Translator.trans("material_lib.content_title"))}},{key:"_changePane",value:function(e){e.closest(".nav").find("li.active").removeClass("active"),e.addClass("active");var t=e.closest(".content").find(".tab-content");t.find(".tab-pane.active").removeClass("active"),t.find(e.data("target")).addClass("active")}}]),e}();t.default=f}},["6e356d846d461116e504"]);