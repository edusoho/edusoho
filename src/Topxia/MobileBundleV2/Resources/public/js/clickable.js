var Clickable=function(c,b){function a(){a._enableClicking.apply(this,arguments)}a.touchable=function(){return a._os.touchable};a.sticky=function(){a._enableStickyClick.apply(this,arguments)};if(b&&b.fn){b.fn.clickable=function(d){this.each(function(){a._enableClicking(this,d)});return this};b.fn.stickyClick=function(d){this.each(function(){a._enableStickyClick(this,d)});return this}}if(c&&c.fn){c.extend(c.fn,{clickable:function(d){this.forEach(function(e){a._enableClicking(e,d)});return this},stickyClick:function(d){this.forEach(function(e){a._enableStickyClick(e,d)});return this}})}return a}(window.Zepto,window.jQuery);Clickable._os=function(f,d){var c,a,b;if(b=/\bCPU.*OS (\d+(_\d+)?)/i.exec(f)){c="ios";a=b[1].replace("_",".")}else{if(b=/\bAndroid (\d+(\.\d+)?)/.exec(f)){c="android";a=b[1]}}var e={name:c,version:a&&d(a),touchable:!!c};e[c]=true;return e}(navigator.userAgent,parseFloat);Clickable._trimString=function(a){var b=/^\s+|\s+$/g;return function(c){return a(c).replace(b,"")}}(String);Clickable._isDOMNode=function(a,b){return function(d){if(!d){return false}try{return(d instanceof a)||(d instanceof b)}catch(c){}if(typeof d!=="object"){return false}if(typeof d.nodeType!=="number"){return false}if(typeof d.nodeName!=="string"){return false}return true}}(Node,HTMLElement);Clickable._isInDOM=function(){return function(a){while(a=a.parentNode){if(a===document){return true}}return false}}();Clickable._bindEvents=function(){return function(c,b){for(var a in b){if(c.addEventListener){c.addEventListener(a,b[a],false)}else{if(c.attachEvent){c.attachEvent("on"+a,b[a])}}}}}();Clickable._unbindEvents=function(){return function(c,b){for(var a in b){if(c.removeEventListener){c.removeEventListener(a,b[a])}}}}();Clickable._addClass=function(){return function(b,a){b.className+=" "+a}}();Clickable._removeClass=function(a){return function(c,b){c.className=a(c.className.replace(new RegExp("\\b"+b+"\\b"),""))}}(Clickable._trimString);Clickable._enableClicking=function(h,o,a,f,c,k,n){var i="active",m="data-clickable-class",g=40;var p=false,l=!!h.ios;function b(K,N){if(!o(K)){throw TypeError("element "+K+" must be a DOM element")}if(K._clickable){return}K._clickable=true;switch(typeof N){case"undefined":N=i;break;case"string":break;default:throw TypeError("active class "+N+" must be a string")}var E=false,q=false,G,F,I,J,s;K.setAttribute(m,N);K.style["-webkit-tap-highlight-color"]="rgba(255,255,255,0)";v();return;function L(P,Q){E=true;I=+new Date();G=P;F=Q;J=j(K);if(J){s=J.scrollTop;J.addEventListener("scroll",A,true)}}function H(){if(J){J.removeEventListener("scroll",A)}J=null;s=null;G=null;F=null;E=false}function A(){B()}function O(){return E}function t(){k(K,N)}function r(){n(K,N)}function v(){f(K,{click:x});if(!h.touchable){f(K,{mousedown:C,mousemove:D,mouseout:D,mouseup:z});return}if(h.ios){f(K,{DOMNodeInsertedIntoDocument:M,DOMNodeRemovedFromDocument:y});if(a(K)){M()}}else{M()}}function M(){f(K,{touchstart:w,touchmove:B,touchcancel:B,touchend:u})}function y(){c(K,{touchstart:w,touchmove:B,touchcancel:B,touchend:u})}function x(P){P=P||window.event;if(!K.disabled&&q){q=false;setTimeout(function(){p=false},0)}else{if(P.stopImmediatePropagation){P.stopImmediatePropagation()}P.preventDefault();P.stopPropagation();P.cancelBubble=true;P.returnValue=false;return false}}function C(P){q=false;if(K.disabled||!e(P.target,K)){P.preventDefault();H();return}L(P.clientX,P.clientY);t()}function D(P){P.preventDefault();H();q=false;r()}function z(P){if(K.disabled){P.preventDefault();H();q=false;return}if(!O()){P.preventDefault();q=false}else{q=true}H();r()}function w(P){q=false;if(p||K.disabled||(P.touches.length!==1)||!e(P.target,K)){H();return}p=true;var Q=P.changedTouches[0];L(Q.clientX,Q.clientY);if(J){if(J._isScrolling||(s<0)||(J.scrollHeight<s)){H();return}}var Q=I;setTimeout(function(){if(O()&&(Q===I)){t()}},g)}function B(P){q=false;H();if(P){p=false}if(K.disabled){return}r()}function u(U){var Q=O(),R=J,S=s,P=G,V=F;B();if(!Q||K.disabled){p=false;return}if(R){if(R._isScrolling||(R.scrollTop!==S)){return}}if(!U.stopImmediatePropagation){q=true;return}var T=+new Date()-I;if(T>g){q=true;d(K,P,V)}else{t();setTimeout(function(){r();q=true;d(K,P,V)},1)}}}function e(r,q){do{if(r===q){return true}else{if(r._clickable){return false}}}while(r=r.parentNode);return false}function d(s,q,t){var r=document.createEvent("MouseEvents");r.initMouseEvent("click",true,true,window,1,q||0,t||0,q||0,t||0,false,false,false,false,0,null);s.dispatchEvent(r)}function j(q){if(!h.ios||(h.version<5)){return}while(q=q.parentNode){if(q._scrollable){if(q._iScroll){return}return q}}}return b}(Clickable._os,Clickable._isDOMNode,Clickable._isInDOM,Clickable._bindEvents,Clickable._unbindEvents,Clickable._addClass,Clickable._removeClass);Clickable._enableStickyClick=function(a,c,f){var d="data-clickable-class";function e(i,h,g){if(!c(i)){throw TypeError("button must be a DOM element, got "+i)}switch(typeof h){case"string":break;case"function":g=h;h=undefined;break;default:throw TypeError("button active class must be a string if defined, got "+h)}if(typeof g!=="function"){throw TypeError("sticky click handler must be a function, got "+g)}f(i,h);i.addEventListener("click",b(i,g),false)}function b(h,g){return function(){var j=false,i=h.getAttribute(d),m;h.disabled=true;h.className+=" "+i;try{m=g.call(h,l)}catch(k){if(window.console&&window.console.error){if((typeof k==="object")&&k.stack){window.console.error(k.stack)}else{window.console.error(k+"")}}l()}if(m===false){l()}function l(){if(j){return}j=true;if(h.disabled){h.disabled=false;h.className=a(h.className.replace(new RegExp("\\b"+i+"\\b","g"),""))}}}}return e}(Clickable._trimString,Clickable._isDOMNode,Clickable._enableClicking);
